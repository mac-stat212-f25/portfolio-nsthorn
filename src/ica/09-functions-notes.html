<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>9 Functions – COMP/STAT212 Portfolio</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../src/ica/10-base-r-notes.html" rel="next">
<link href="../../src/ica/08-missing-data-notes.html" rel="prev">
<script src="../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-2fef5ea3f8957b3e4ecc936fc74692ca.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-b6165e882820e9cbe81d0573c00a9ad9.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-336fc07c9e36db0483797e7526239151.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/bootstrap/bootstrap-b6165e882820e9cbe81d0573c00a9ad9.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en"
  });
});
</script><style>html{ scroll-behavior: smooth; }</style>
<link rel="stylesheet" href="../../style/custom.css">
</head>
<body class="nav-sidebar docked quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../src/ica/cleaning.html">In-Class Activities</a></li><li class="breadcrumb-item"><a href="../../src/ica/09-functions-notes.html"><span class="chapter-title">9 Functions</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../assets/sidebar-logo.png" alt="Random negative space illustration" class="sidebar-logo py-0 d-lg-inline d-none"></a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Nico Thorn</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Prof Viz</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/pv/pv-01.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Professional Viz Sample</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">TidyTuesday</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/tt/hw01-tt.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Homework 01</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/tt/2025-07-08.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">TidyTuesday Sample 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/tt/2025-07-15.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">TidyTuesday Sample 2</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">In-Class Activities</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ica/cleaning.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Cleaning SFO Weather Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ica/03-adv-ggplot-notes.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">3 Advanced Data Viz</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ica/04-adv-maps-1-notes.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">4 Advanced Spatial Viz P1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ica/06-wrangling-1-notes.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">6 Adv Data wrangling P1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ica/07-wrangling-2-notes.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">7 Adv Data wrangling P2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ica/08-missing-data-notes.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">8 Missing Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ica/09-functions-notes.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">9 Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ica/10-base-r-notes.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">10 Base R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ica/11-iteration-1-notes.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">11 Loops+Iter P1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ica/12-iteration-2-notes.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">12 Loops+Iter P2</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/appx/appx-sample1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix Sample 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/appx/appx-sample2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix Sample 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../mm/mm.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Mind Maps</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#learning-goals" id="toc-learning-goals" class="nav-link active" data-scroll-target="#learning-goals">🧩 Learning Goals</a></li>
  <li>
<a href="#functions-and-control-structures" id="toc-functions-and-control-structures" class="nav-link" data-scroll-target="#functions-and-control-structures">Functions and Control Structures</a>
  <ul class="collapse">
<li><a href="#why-functions" id="toc-why-functions" class="nav-link" data-scroll-target="#why-functions">Why functions?</a></li>
  <li><a href="#core-parts-of-a-function" id="toc-core-parts-of-a-function" class="nav-link" data-scroll-target="#core-parts-of-a-function">Core parts of a function</a></li>
  </ul>
</li>
  <li><a href="#scope" id="toc-scope" class="nav-link" data-scroll-target="#scope">Scope</a></li>
  <li><a href="#writing-functions" id="toc-writing-functions" class="nav-link" data-scroll-target="#writing-functions">Writing Functions</a></li>
  <li><a href="#calling-a-function" id="toc-calling-a-function" class="nav-link" data-scroll-target="#calling-a-function">Calling a Function</a></li>
  <li><a href="#the-if-else-if-else-control-structure" id="toc-the-if-else-if-else-control-structure" class="nav-link" data-scroll-target="#the-if-else-if-else-control-structure">The <code>if-else if-else</code> Control Structure</a></li>
  <li><a href="#writing-functions-with-tidyverse-verbs" id="toc-writing-functions-with-tidyverse-verbs" class="nav-link" data-scroll-target="#writing-functions-with-tidyverse-verbs">Writing Functions with <code>tidyverse</code> Verbs</a></li>
  <li><a href="#done" id="toc-done" class="nav-link" data-scroll-target="#done">Done!</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../src/ica/cleaning.html">In-Class Activities</a></li><li class="breadcrumb-item"><a href="../../src/ica/09-functions-notes.html"><span class="chapter-title">9 Functions</span></a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-title">9 Functions</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header><section id="learning-goals" class="level2"><h2 class="anchored" data-anchor-id="learning-goals">🧩 Learning Goals</h2>
<p>By the end of this lesson, you should be able to:</p>
<ul>
<li>Recognize when it would be useful to write a function</li>
<li>Identify the core components of a function definition and explain their role (the <code>function()</code> directive, arguments, argument defaults, function body, return value)</li>
<li>Identify the scoping of a function in accessing objects in R</li>
<li>Describe the difference between argument matching by position and by name</li>
<li>Write <code>if</code>-<code>else</code>, <code>if</code>-<code>else if</code>-<code>else</code> statements to conditionally execute code</li>
<li>Write your own function to carry out a repeated task</li>
<li>Provide feedback on functions written by others</li>
</ul></section><section id="functions-and-control-structures" class="level2"><h2 class="anchored" data-anchor-id="functions-and-control-structures">Functions and Control Structures</h2>
<section id="why-functions" class="level3"><h3 class="anchored" data-anchor-id="why-functions">Why functions?</h3>
<p>Getting really good at writing useful and reusable functions is one of the best ways to increase your expertise in data science. It requires a lot of practice.</p>
<p>If you’ve copied and pasted code <strong>3 or more times</strong>, it’s time to write a function. Try to avoid repeating yourself.</p>
<div class="incremental">
<ol class="incremental" type="1">
<li>
<strong>Reducing errors:</strong> Copy + paste + modify is prone to errors (e.g., forgetting to change a variable name)</li>
<li>
<strong>Efficiency:</strong> If you need to update code, you only need to do it one place. This allows reuse of code within and across projects.</li>
<li>
<strong>Readability:</strong> Encapsulating code within a function with a descriptive name makes code more readable.</li>
</ol>
</div>
</section><section id="core-parts-of-a-function" class="level3"><h3 class="anchored" data-anchor-id="core-parts-of-a-function">Core parts of a function</h3>
<p>When you define a function, what does it look like?</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Defining a function</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>function_name <span class="ot">&lt;-</span> <span class="cf">function</span>(input_name_1, <span class="at">input_name_2 =</span> default_value_2){</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a>  <span class="co"># function body - code that does something</span></span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a>  <span class="fu">return</span>(output)</span>
<span id="cb1-7"><a href="#cb1-7"></a>}</span>
<span id="cb1-8"><a href="#cb1-8"></a></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co"># Calling a function (all valid ways)</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="fu">function_name</span>(<span class="at">input_name_1 =</span> <span class="dv">2</span>, <span class="at">input_name_2 =</span> <span class="dv">4</span>)</span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="fu">function_name</span>(<span class="dv">2</span>, <span class="dv">4</span>)</span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="fu">function_name</span>(<span class="at">input_name_2 =</span> <span class="dv">4</span>, <span class="at">input_name_1 =</span> <span class="dv">2</span>)</span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="fu">function_name</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The core parts of defining a function include:</p>
<ul>
<li>
<strong><code>function()</code> directive</strong>
<ul>
<li>This is what allows tells R to create a function.</li>
</ul>
</li>
<li>
<strong>Arguments/Inputs</strong>: the <code>input_name_1</code> and <code>input_name_2</code> – these are names of the function inputs
<ul>
<li>
<code>default_value_2</code> is a default value that is used if no input values are provided when the function is called</li>
</ul>
</li>
<li>
<strong>Function body</strong>
<ul>
<li>The code inside the curly braces <code><a href="https://rdrr.io/r/base/Paren.html">{ }</a></code> is where all the work happens. This code uses the function arguments to perform computations.</li>
</ul>
</li>
<li>
<strong>Return value</strong>
<ul>
<li>We can explicitly return an object by putting it inside <code><a href="https://rdrr.io/r/base/function.html">return()</a></code>.</li>
</ul>
</li>
</ul>
<p>Here are three examples that can help us learn a few properties of functions:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>average <span class="ot">&lt;-</span> <span class="cf">function</span>(x, remove_nas) {</span>
<span id="cb2-2"><a href="#cb2-2"></a>    <span class="fu">return</span>(<span class="fu">sum</span>(x, <span class="at">na.rm =</span> remove_nas)<span class="sc">/</span><span class="fu">length</span>(x))</span>
<span id="cb2-3"><a href="#cb2-3"></a>}</span>
<span id="cb2-4"><a href="#cb2-4"></a>average2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">remove_nas =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb2-5"><a href="#cb2-5"></a>    <span class="fu">return</span>(<span class="fu">sum</span>(x, <span class="at">na.rm =</span> remove_nas)<span class="sc">/</span><span class="fu">length</span>(x))</span>
<span id="cb2-6"><a href="#cb2-6"></a>}</span>
<span id="cb2-7"><a href="#cb2-7"></a></span>
<span id="cb2-8"><a href="#cb2-8"></a>average3 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, remove_nas) {</span>
<span id="cb2-9"><a href="#cb2-9"></a>    <span class="fu">sum</span>(x, <span class="at">na.rm =</span> remove_nas)<span class="sc">/</span><span class="fu">length</span>(x)</span>
<span id="cb2-10"><a href="#cb2-10"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Note:</p>
<ul>
<li>In <code>average2</code>, the <code>remove_nas</code> argument has a <strong>default</strong> value of <code>TRUE</code>.</li>
</ul>
<p>When a function has default values for arguments, they don’t have to be provided when you call the function if you want to use the default value. See below:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Does throw an error</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="fu">average</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="cn">NA</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-error">
<pre><code>Error in average(c(1, 2, 3, NA)): argument "remove_nas" is missing, with no default</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">average</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="cn">NA</span>), <span class="at">remove_nas =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 1.5</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Doesn't throw an error</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="fu">average2</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="cn">NA</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 1.5</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">average2</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="cn">NA</span>), <span class="at">remove_nas =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
<ul>
<li>If we don’t provide a <code><a href="https://rdrr.io/r/base/function.html">return()</a></code>, the last value that gets evaluated in the <strong>function body</strong> and isn’t stored as an object is what the function returns. (This is generally the last line without an assignment operator <code>&lt;-</code>.)
<ul>
<li>
<code>average3()</code> is one example, but this can easily lead to errors.</li>
<li>We should explicitly return an object by putting it inside <code><a href="https://rdrr.io/r/base/function.html">return()</a></code>.</li>
</ul>
</li>
</ul></section></section><section id="scope" class="level2"><h2 class="anchored" data-anchor-id="scope">Scope</h2>
<p>In programming, <strong>scope</strong> refers to the area of a program where a named object is recognized and can be used.</p>
<ul>
<li>R uses <strong>lexical scoping</strong>, which means that the scope of a variable is determined by where it is created in the code.</li>
</ul>
<p>Lexical scoping in R:</p>
<ul>
<li>When code refers to an object (e.g.&nbsp;data set, function, vector, etc.), R looks for the object in the current, <strong>local environment</strong>.</li>
<li>If it doesn’t find it, it continues to search by looking in the parent environment, and so on. The top-level environment is the <strong>global environment</strong>, the location where all interactive (i.e.&nbsp;outside of a function) computation and storage takes place.
<ul>
<li>If you save an object in R, outside a function local environment, it is stored in the global environment.</li>
</ul>
</li>
<li>If R can’t find it in the global environment, it will look for it in loaded packages.</li>
</ul>
<p>When writing and using functions, the local environment is within the function itself.</p>
<ul>
<li>If you define an object in the function, it won’t be accessible outside that function (unless you pass it as the output). See below:</li>
</ul>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>average_new <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">remove_nas =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb11-2"><a href="#cb11-2"></a>    <span class="fu">sum</span>(x, <span class="at">na.rm =</span> remove_nas)<span class="sc">/</span><span class="fu">length</span>(x)</span>
<span id="cb11-3"><a href="#cb11-3"></a>  fun_new_thing_within_function <span class="ot">&lt;-</span> <span class="st">"Fun times!"</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>}</span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="fu">average_new</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb11-6"><a href="#cb11-6"></a>fun_new_thing_within_function</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-error">
<pre><code>Error: object 'fun_new_thing_within_function' not found</code></pre>
</div>
</div>
<p>Scoping is important to consider if you try to refer to objects that aren’t passed as arguments.</p>
<ul>
<li>This can be dangerous because if you re-use names of variables, it is easy to accidentally refer to a variable that is not the one you intended. See below:</li>
</ul>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb13-2"><a href="#cb13-2"></a></span>
<span id="cb13-3"><a href="#cb13-3"></a>average_new2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">remove_nas =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb13-4"><a href="#cb13-4"></a>    <span class="fu">sum</span>(x, <span class="at">na.rm =</span> remove_nas)<span class="sc">/</span><span class="fu">length</span>(x) <span class="sc">+</span> v</span>
<span id="cb13-5"><a href="#cb13-5"></a>}</span>
<span id="cb13-6"><a href="#cb13-6"></a></span>
<span id="cb13-7"><a href="#cb13-7"></a></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="fu">average_new2</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 3 4 5</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>)</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="fu">average_new2</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 6 7 8</code></pre>
</div>
</div>
<p>Anything created/saved/updated within a function that you want accessible outside that function needs to be passed to <code><a href="https://rdrr.io/r/base/function.html">return()</a></code>. See below:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb17-2"><a href="#cb17-2"></a></span>
<span id="cb17-3"><a href="#cb17-3"></a>average_new3 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">remove_nas =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb17-4"><a href="#cb17-4"></a>  v <span class="ot">&lt;-</span> v <span class="sc">+</span> <span class="dv">10</span> <span class="co"># this is not changing v outside the function... </span></span>
<span id="cb17-5"><a href="#cb17-5"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(x, <span class="at">na.rm =</span> remove_nas)<span class="sc">/</span><span class="fu">length</span>(x) )</span>
<span id="cb17-6"><a href="#cb17-6"></a>}</span>
<span id="cb17-7"><a href="#cb17-7"></a></span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="fu">average_new3</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>v</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3</code></pre>
</div>
</div>
<p>For more about lexical scoping in R, see <a href="https://bookdown.org/rdpeng/rprogdatascience/scoping-rules-of-r.html">R Programming for Data Science</a></p>
</section><section id="writing-functions" class="level2"><h2 class="anchored" data-anchor-id="writing-functions">Writing Functions</h2>
<p>Tips for writing functions:</p>
<ul>
<li>Write the code for the body of the function (the task that you are wanting to repeat)</li>
<li>Identify the parts of the function that could/would change (these are the inputs)
<ul>
<li>Update the body of the function to be in terms of the inputs</li>
<li>Avoid manually typing anything that is specific to one input; use code to get that (such as unique values of a variable)</li>
</ul>
</li>
<li>Identify the output you want to return</li>
</ul>
<p><strong>Pair programming exercises:</strong> There are 2 exercises for each section below.</p>
<ul>
<li>Read through the introduction of the concept and then work on the exercises together.<br>
</li>
<li>You’ll swap driver and navigator roles between exercises.</li>
<li>Remember: The driver writes the code. The navigator oversees and provides guidance.</li>
<li>For the first exercise, the person whose birthday is coming up sooner will be the driver first. Swap role for the second exercise and continue in this manner for all exercises.</li>
</ul>
<ol type="1">
<li>
<strong>Rescaling function</strong> Write a function that rescales a numeric vector to be between 0 and 1. Here are some test cases with the expected output. Test out your function on the following inputs:</li>
</ol>
<ul>
<li>
<code>x = 2:4</code>. Expected output: <code>0.0 0.5 1.0</code>
</li>
<li>
<code>x = c(-1, 0, 5)</code>. Expected output: <code>0.0000000 0.1666667 1.0000000</code>
</li>
<li>
<code>x = -3:-1</code>. Expected output: <code>0.0 0.5 1.0</code>
</li>
</ul>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>rescale <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb21-2"><a href="#cb21-2"></a>  r <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-3"><a href="#cb21-3"></a>  (x<span class="sc">-</span>r[<span class="dv">1</span>])<span class="sc">/</span>(r[<span class="dv">2</span>]<span class="sc">-</span>r[<span class="dv">1</span>])</span>
<span id="cb21-4"><a href="#cb21-4"></a>}</span>
<span id="cb21-5"><a href="#cb21-5"></a></span>
<span id="cb21-6"><a href="#cb21-6"></a><span class="fu">rescale</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0 0.5 1.0</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="fu">rescale</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0000000 0.1666667 1.0000000</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="fu">rescale</span>(<span class="sc">-</span><span class="dv">3</span><span class="sc">:-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0 0.5 1.0</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>
<strong>Phone digits</strong> Write a function that formats a 10-digit phone number nicely as <code>(###) ###-####</code>. Your function should work on the following test cases: <code>c("651-330-8661", "6516966000", "800 867 5309")</code>. It may help to refer to the <code>stringr</code> cheatsheet.</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>phone_digits <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb27-2"><a href="#cb27-2"></a>  only_num <span class="ot">&lt;-</span> <span class="fu">str_remove_all</span>(x,<span class="st">"[^</span><span class="sc">\\</span><span class="st">d]"</span>)</span>
<span id="cb27-3"><a href="#cb27-3"></a>  <span class="fu">str_c</span>(<span class="st">"("</span>, <span class="fu">str_sub</span>(only_num,<span class="dv">1</span>,<span class="dv">3</span>), <span class="st">") "</span>, <span class="fu">str_sub</span>(only_num,<span class="dv">4</span>,<span class="dv">6</span>), <span class="st">"-"</span>,<span class="fu">str_sub</span>(only_num,<span class="dv">7</span>,<span class="sc">-</span><span class="dv">1</span>) )</span>
<span id="cb27-4"><a href="#cb27-4"></a>  </span>
<span id="cb27-5"><a href="#cb27-5"></a>}</span>
<span id="cb27-6"><a href="#cb27-6"></a></span>
<span id="cb27-7"><a href="#cb27-7"></a><span class="fu">phone_digits</span>(<span class="fu">c</span>(<span class="st">"651-330-8661"</span>, <span class="st">"6516966000"</span>, <span class="st">"800 867 5309"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "(651) 330-8661" "(651) 696-6000" "(800) 867-5309"</code></pre>
</div>
</div>
</section><section id="calling-a-function" class="level2"><h2 class="anchored" data-anchor-id="calling-a-function">Calling a Function</h2>
<p>When you supply arguments to a function, they can be matched <strong>by position</strong> and/or <strong>by name</strong>.</p>
<p>When you call a function without <code>argument = value</code> inside the parentheses, you are using <strong>positional matching</strong>.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> price)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The above works because the first argument of <code>ggplot</code> is <code>data</code> and the second is <code>mapping</code>. (Pull up the documentation on <code>ggplot</code> with <code>?ggplot</code> in the Console.) So the following doesn’t work:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> price), diamonds) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-error">
<pre><code>Error in `ggplot()`:
! `mapping` must be created with `aes()`.
✖ You've supplied a tibble.</code></pre>
</div>
</div>
<p>But if we named the arguments (<strong>name matching</strong>), we would be fine:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> price), <span class="at">data =</span> diamonds) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Somewhat confusingly, we can name some arguments and not others. Below, <code>mapping</code> is named, but <code>data</code> isn’t. This works because when an argument is matched by name, it is “removed” from the argument list, and the remaining unnamed arguments are matched in the order that they are listed in the function definition. <strong>Just because this is possible doesn’t mean it’s a good idea–don’t do this!</strong></p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> price), diamonds) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Argument matching">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Argument matching
</div>
</div>
<div class="callout-body-container callout-body">
<p>In general, it is safest to match arguments by name and position for your peace of mind. For functions that you are very familiar with (and know the argument order), it’s ok to just use positional matching.</p>
</div>
</div>
<ol start="3" type="1">
<li>
<strong>Error Messages</strong> Diagnose the error message in the example below:</li>
</ol>
<pre><code>ggplot() |&gt;
    geom_sf(census_data, aes(fill = population))
    
Error in `layer_sf()`:
! `mapping` must be created by `aes()`</code></pre>
</section><section id="the-if-else-if-else-control-structure" class="level2"><h2 class="anchored" data-anchor-id="the-if-else-if-else-control-structure">The <code>if-else if-else</code> Control Structure</h2>
<p>Often in functions, you will want to execute code chunks conditionally. In a programming language, <strong>control structures</strong> are parts of the language that allow you to control what code is executed. By far the most common is the `<code>if-else if-else</code> structure.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="cf">if</span> (logical_condition) {</span>
<span id="cb35-2"><a href="#cb35-2"></a>    <span class="co"># some code</span></span>
<span id="cb35-3"><a href="#cb35-3"></a>} <span class="cf">else</span> <span class="cf">if</span> (other_logical_condition) {</span>
<span id="cb35-4"><a href="#cb35-4"></a>    <span class="co"># some code</span></span>
<span id="cb35-5"><a href="#cb35-5"></a>} <span class="cf">else</span> {</span>
<span id="cb35-6"><a href="#cb35-6"></a>    <span class="co"># some code</span></span>
<span id="cb35-7"><a href="#cb35-7"></a>}</span>
<span id="cb35-8"><a href="#cb35-8"></a></span>
<span id="cb35-9"><a href="#cb35-9"></a>middle <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb35-10"><a href="#cb35-10"></a>    mean_x <span class="ot">&lt;-</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-11"><a href="#cb35-11"></a>    median_x <span class="ot">&lt;-</span> <span class="fu">median</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-12"><a href="#cb35-12"></a>    seems_skewed <span class="ot">&lt;-</span> (mean_x <span class="sc">&gt;</span> <span class="fl">1.5</span><span class="sc">*</span>median_x) <span class="sc">|</span> (mean_x <span class="sc">&lt;</span> (<span class="dv">1</span><span class="sc">/</span><span class="fl">1.5</span>)<span class="sc">*</span>median_x)</span>
<span id="cb35-13"><a href="#cb35-13"></a>    <span class="cf">if</span> (seems_skewed) {</span>
<span id="cb35-14"><a href="#cb35-14"></a>        median_x</span>
<span id="cb35-15"><a href="#cb35-15"></a>    } <span class="cf">else</span> {</span>
<span id="cb35-16"><a href="#cb35-16"></a>        mean_x</span>
<span id="cb35-17"><a href="#cb35-17"></a>    }</span>
<span id="cb35-18"><a href="#cb35-18"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="To vectorize or not to vectorize">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
To vectorize or not to vectorize
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <code>if () else {}</code> code is not <strong>vectorized</strong>; the logical condition in <code>if()</code> cannot be a logical vector of length longer than 1. If you want a vectorized version of conditional execution of code use <code>if_else()</code> or <code>case_when()</code>; these can be used in <code>mutate()</code>.</p>
</div>
</div>
<ol start="4" type="1">
<li>
<strong>Convert Temp</strong> Write a function for converting temperatures that takes as input a numeric value and a unit (either “C” for Celsius or “F” for Fahrenheit). The function should convert the temperature from one unit to the other based on the following formulas:</li>
</ol>
<ul>
<li>To convert Celsius to Fahrenheit: <code>(Celsius * 9/5) + 32</code>
</li>
<li>To convert Fahrenheit to Celsius: <code>(Fahrenheit - 32) * 5/9</code>
</li>
</ul>
<ol start="5" type="1">
<li>
<strong>Domain Name</strong> Write a function that extracts the domain name of a supplied email address. The function should return the domain name (e.g., “gmail.com”). If the input is not a valid email address, return “Invalid Email”. (A valid email ends in “dot something”.)</li>
</ol></section><section id="writing-functions-with-tidyverse-verbs" class="level2"><h2 class="anchored" data-anchor-id="writing-functions-with-tidyverse-verbs">Writing Functions with <code>tidyverse</code> Verbs</h2>
<p>Perhaps we are using <code>group_by()</code> and <code>summarize()</code> a lot to compute group means. We might write this function:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>group_means <span class="ot">&lt;-</span> <span class="cf">function</span>(df, group_var, mean_var) {</span>
<span id="cb36-2"><a href="#cb36-2"></a>    df <span class="sc">|&gt;</span></span>
<span id="cb36-3"><a href="#cb36-3"></a>        <span class="fu">group_by</span>(group_var) <span class="sc">|&gt;</span></span>
<span id="cb36-4"><a href="#cb36-4"></a>        <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(mean_var))</span>
<span id="cb36-5"><a href="#cb36-5"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Let’s use it on the <code>diamonds</code> dataset to compute the mean size (<code>carat</code>) by diamond <code>cut</code>:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="fu">group_means</span>(diamonds, <span class="at">group_var =</span> cut, <span class="at">mean_var =</span> carat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-error">
<pre><code>Error in `group_by()`:
! Must group by variables found in `.data`.
✖ Column `group_var` is not found.</code></pre>
</div>
</div>
<p>What if the problem is that the variable names need to be in quotes?</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="fu">group_means</span>(diamonds, <span class="at">group_var =</span> <span class="st">"cut"</span>, <span class="at">mean_var =</span> <span class="st">"carat"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-error">
<pre><code>Error in `group_by()`:
! Must group by variables found in `.data`.
✖ Column `group_var` is not found.</code></pre>
</div>
</div>
<p>What’s Going On?</p>
<p>The <code>tidyverse</code> uses something called <strong>tidy evaluation</strong>: this allows you to refer to a variable by typing it directly (e.g., no need to put it in quotes).</p>
<ul>
<li>
<code>group_by(group_var)</code> is expecting a variable that is actually called <code>group_var</code>, and <code>mean(mean_var)</code> is expecting a variable that is actually called <code>mean_var</code>.</li>
</ul>
<p>To fix this we need to <strong>embrace</strong> the variables inside the function with <code>{ var }</code>:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>group_means <span class="ot">&lt;-</span> <span class="cf">function</span>(df, group_var, mean_var) {</span>
<span id="cb41-2"><a href="#cb41-2"></a>    df <span class="sc">|&gt;</span></span>
<span id="cb41-3"><a href="#cb41-3"></a>        <span class="fu">group_by</span>({{ group_var }}) <span class="sc">|&gt;</span></span>
<span id="cb41-4"><a href="#cb41-4"></a>        <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>({{ mean_var }}))</span>
<span id="cb41-5"><a href="#cb41-5"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The <code>{ var }</code> tells R to look at what the variable specified by the input <code>var</code> rather than look for a variable called <code>var</code>.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="fu">group_means</span>(diamonds, <span class="at">group_var =</span> cut, <span class="at">mean_var =</span> carat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  cut        mean
  &lt;ord&gt;     &lt;dbl&gt;
1 Fair      1.05 
2 Good      0.849
3 Very Good 0.806
4 Premium   0.892
5 Ideal     0.703</code></pre>
</div>
</div>
<p>Let’s group by both <code>cut</code> and <code>color</code>:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="fu">group_means</span>(diamonds, <span class="at">group_var =</span> <span class="fu">c</span>(cut, color), <span class="at">mean_var =</span> carat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-error">
<pre><code>Error in `group_by()`:
ℹ In argument: `c(cut, color)`.
Caused by error:
! `c(cut, color)` must be size 53940 or 1, not 107880.</code></pre>
</div>
</div>
<p>Oh No! What Now?!</p>
<p>When <code>c(cut, color)</code> is put inside <code>{ c(cut, color) }</code> within the function, R is actually running the code inside <code><a href="https://rdrr.io/r/base/Paren.html">{ }</a></code>.</p>
<ul>
<li>This combines the columns for those 2 variables into one long vector. What we really meant by <code>c(cut, color)</code> is “group by both cut and color”.</li>
</ul>
<p>To fix this, we need the <code>pick()</code> function to get R to see <code>{ group_var }</code> as a vector of separate variables (like the way <code>select()</code> works).</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>group_means <span class="ot">&lt;-</span> <span class="cf">function</span>(df, group_var, mean_var) {</span>
<span id="cb46-2"><a href="#cb46-2"></a>    df <span class="sc">|&gt;</span></span>
<span id="cb46-3"><a href="#cb46-3"></a>        <span class="fu">group_by</span>(<span class="fu">pick</span>({{ group_var }})) <span class="sc">|&gt;</span></span>
<span id="cb46-4"><a href="#cb46-4"></a>        <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>({{ mean_var }}))</span>
<span id="cb46-5"><a href="#cb46-5"></a>}</span>
<span id="cb46-6"><a href="#cb46-6"></a></span>
<span id="cb46-7"><a href="#cb46-7"></a><span class="fu">group_means</span>(diamonds, carat, price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 273 × 2
   carat  mean
   &lt;dbl&gt; &lt;dbl&gt;
 1  0.2   365.
 2  0.21  380.
 3  0.22  391.
 4  0.23  486.
 5  0.24  505.
 6  0.25  551.
 7  0.26  551.
 8  0.27  575.
 9  0.28  580.
10  0.29  601.
# ℹ 263 more rows</code></pre>
</div>
</div>
<ol start="6" type="1">
<li>
<strong>Prop function</strong> Create a new version of <code><a href="https://dplyr.tidyverse.org/reference/count.html">dplyr::count()</a></code> that also shows proportions instead of just sample sizes. The function should be able to handle counting by multiple variables. Test your function with two different sets of arguments using the <code>diamonds</code> dataset.</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>prop_function <span class="ot">&lt;-</span> <span class="cf">function</span>(df, variables){</span>
<span id="cb48-2"><a href="#cb48-2"></a>  df <span class="sc">|&gt;</span> </span>
<span id="cb48-3"><a href="#cb48-3"></a>    <span class="fu">group_by</span>(<span class="fu">pick</span>({{variables}})) <span class="sc">|&gt;</span> </span>
<span id="cb48-4"><a href="#cb48-4"></a>    <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb48-5"><a href="#cb48-5"></a>    <span class="fu">mutate</span>(<span class="at">prop =</span> count <span class="sc">/</span> <span class="fu">nrow</span>(df))</span>
<span id="cb48-6"><a href="#cb48-6"></a>}</span>
<span id="cb48-7"><a href="#cb48-7"></a></span>
<span id="cb48-8"><a href="#cb48-8"></a><span class="fu">prop_function</span>(diamonds, <span class="fu">c</span>(cut))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  cut       count   prop
  &lt;ord&gt;     &lt;int&gt;  &lt;dbl&gt;
1 Fair       1610 0.0298
2 Good       4906 0.0910
3 Very Good 12082 0.224 
4 Premium   13791 0.256 
5 Ideal     21551 0.400 </code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="fu">prop_function</span>(diamonds, <span class="fu">c</span>(cut, carat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,098 × 4
# Groups:   cut [5]
   cut   carat count      prop
   &lt;ord&gt; &lt;dbl&gt; &lt;int&gt;     &lt;dbl&gt;
 1 Fair   0.22     1 0.0000185
 2 Fair   0.23     1 0.0000185
 3 Fair   0.25     3 0.0000556
 4 Fair   0.27     1 0.0000185
 5 Fair   0.29     2 0.0000371
 6 Fair   0.3     20 0.000371 
 7 Fair   0.31     9 0.000167 
 8 Fair   0.32     3 0.0000556
 9 Fair   0.33     2 0.0000371
10 Fair   0.34     5 0.0000927
# ℹ 1,088 more rows</code></pre>
</div>
</div>
<ol start="7" type="1">
<li>
<strong>Scatterplot + Smooth function</strong> Create a function that creates a scatterplot from a user-supplied dataset with user-supplied x and y variables. The plot should also show a curvy smoothing line in blue, and a linear smoothing line in red. Test your function using the <code>diamonds</code> dataset.</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>scatter_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(df, x, y){</span>
<span id="cb52-2"><a href="#cb52-2"></a>  <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span>{{x}}, <span class="at">y =</span> {{y}})) <span class="sc">+</span></span>
<span id="cb52-3"><a href="#cb52-3"></a>    <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb52-4"><a href="#cb52-4"></a>    <span class="fu">geom_smooth</span>()<span class="sc">+</span></span>
<span id="cb52-5"><a href="#cb52-5"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">color =</span> <span class="st">'red'</span>)</span>
<span id="cb52-6"><a href="#cb52-6"></a>}</span>
<span id="cb52-7"><a href="#cb52-7"></a></span>
<span id="cb52-8"><a href="#cb52-8"></a><span class="fu">scatter_plot</span>(diamonds, carat, price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="09-functions-notes_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="done" class="level2"><h2 class="anchored" data-anchor-id="done">Done!</h2>
<ul>
<li>Check the ICA Instructions for how to (a) push your code to GitHub and (b) update your portfolio website</li>
</ul>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation column-body"><div class="nav-page nav-page-previous">
      <a href="../../src/ica/08-missing-data-notes.html" class="pagination-link" aria-label="8 Missing Data">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">8 Missing Data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../src/ica/10-base-r-notes.html" class="pagination-link" aria-label="10 Base R">
        <span class="nav-page-text"><span class="chapter-title">10 Base R</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb53" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb53-1"><a href="#cb53-1"></a><span class="co">---</span></span>
<span id="cb53-2"><a href="#cb53-2"></a><span class="an">title:</span><span class="co"> "9 Functions"</span></span>
<span id="cb53-3"><a href="#cb53-3"></a><span class="co">---</span></span>
<span id="cb53-4"><a href="#cb53-4"></a></span>
<span id="cb53-5"><a href="#cb53-5"></a></span>
<span id="cb53-6"><a href="#cb53-6"></a><span class="in">```{r doc_setup_09, echo=FALSE, message=FALSE}</span></span>
<span id="cb53-7"><a href="#cb53-7"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb53-8"><a href="#cb53-8"></a><span class="in">```</span></span>
<span id="cb53-9"><a href="#cb53-9"></a></span>
<span id="cb53-10"><a href="#cb53-10"></a><span class="fu">## 🧩 Learning Goals</span></span>
<span id="cb53-11"><a href="#cb53-11"></a></span>
<span id="cb53-12"><a href="#cb53-12"></a>By the end of this lesson, you should be able to:</span>
<span id="cb53-13"><a href="#cb53-13"></a></span>
<span id="cb53-14"><a href="#cb53-14"></a><span class="ss">- </span>Recognize when it would be useful to write a function</span>
<span id="cb53-15"><a href="#cb53-15"></a><span class="ss">- </span>Identify the core components of a function definition and explain their role (the <span class="in">`function()`</span> directive, arguments, argument defaults, function body, return value)</span>
<span id="cb53-16"><a href="#cb53-16"></a><span class="ss">- </span>Identify the scoping of a function in accessing objects in R</span>
<span id="cb53-17"><a href="#cb53-17"></a><span class="ss">- </span>Describe the difference between argument matching by position and by name</span>
<span id="cb53-18"><a href="#cb53-18"></a><span class="ss">- </span>Write <span class="in">`if`</span>-<span class="in">`else`</span>, <span class="in">`if`</span>-<span class="in">`else if`</span>-<span class="in">`else`</span> statements to conditionally execute code</span>
<span id="cb53-19"><a href="#cb53-19"></a><span class="ss">- </span>Write your own function to carry out a repeated task</span>
<span id="cb53-20"><a href="#cb53-20"></a><span class="ss">- </span>Provide feedback on functions written by others</span>
<span id="cb53-21"><a href="#cb53-21"></a></span>
<span id="cb53-22"><a href="#cb53-22"></a></span>
<span id="cb53-23"><a href="#cb53-23"></a></span>
<span id="cb53-24"><a href="#cb53-24"></a><span class="fu">## Functions and Control Structures </span></span>
<span id="cb53-25"><a href="#cb53-25"></a></span>
<span id="cb53-26"><a href="#cb53-26"></a><span class="fu">### Why functions? </span></span>
<span id="cb53-27"><a href="#cb53-27"></a></span>
<span id="cb53-28"><a href="#cb53-28"></a>Getting really good at writing useful and reusable functions is one of the best ways to increase your expertise in data science. It requires a lot of practice.</span>
<span id="cb53-29"><a href="#cb53-29"></a></span>
<span id="cb53-30"><a href="#cb53-30"></a></span>
<span id="cb53-31"><a href="#cb53-31"></a>If you've copied and pasted code **3 or more times**, it's time to write a function. Try to avoid repeating yourself.</span>
<span id="cb53-32"><a href="#cb53-32"></a></span>
<span id="cb53-33"><a href="#cb53-33"></a>:::{.incremental}</span>
<span id="cb53-34"><a href="#cb53-34"></a><span class="ss">1. </span>**Reducing errors:** Copy + paste + modify is prone to errors (e.g., forgetting to change a variable name)</span>
<span id="cb53-35"><a href="#cb53-35"></a><span class="ss">2. </span>**Efficiency:** If you need to update code, you only need to do it one place. This allows reuse of code within and across projects.</span>
<span id="cb53-36"><a href="#cb53-36"></a><span class="ss">3. </span>**Readability:** Encapsulating code within a function with a descriptive name makes code more readable.</span>
<span id="cb53-37"><a href="#cb53-37"></a>:::</span>
<span id="cb53-38"><a href="#cb53-38"></a></span>
<span id="cb53-39"><a href="#cb53-39"></a><span class="fu">### Core parts of a function </span></span>
<span id="cb53-40"><a href="#cb53-40"></a></span>
<span id="cb53-41"><a href="#cb53-41"></a>When you define a function, what does it look like?</span>
<span id="cb53-42"><a href="#cb53-42"></a></span>
<span id="cb53-43"><a href="#cb53-43"></a><span class="in">```{r eval = FALSE}</span></span>
<span id="cb53-44"><a href="#cb53-44"></a><span class="co"># Defining a function</span></span>
<span id="cb53-45"><a href="#cb53-45"></a>function_name <span class="ot">&lt;-</span> <span class="cf">function</span>(input_name_1, <span class="at">input_name_2 =</span> default_value_2){</span>
<span id="cb53-46"><a href="#cb53-46"></a></span>
<span id="cb53-47"><a href="#cb53-47"></a>  <span class="co"># function body - code that does something</span></span>
<span id="cb53-48"><a href="#cb53-48"></a></span>
<span id="cb53-49"><a href="#cb53-49"></a>  <span class="fu">return</span>(output)</span>
<span id="cb53-50"><a href="#cb53-50"></a>}</span>
<span id="cb53-51"><a href="#cb53-51"></a></span>
<span id="cb53-52"><a href="#cb53-52"></a><span class="co"># Calling a function (all valid ways)</span></span>
<span id="cb53-53"><a href="#cb53-53"></a><span class="fu">function_name</span>(<span class="at">input_name_1 =</span> <span class="dv">2</span>, <span class="at">input_name_2 =</span> <span class="dv">4</span>)</span>
<span id="cb53-54"><a href="#cb53-54"></a><span class="fu">function_name</span>(<span class="dv">2</span>, <span class="dv">4</span>)</span>
<span id="cb53-55"><a href="#cb53-55"></a><span class="fu">function_name</span>(<span class="at">input_name_2 =</span> <span class="dv">4</span>, <span class="at">input_name_1 =</span> <span class="dv">2</span>)</span>
<span id="cb53-56"><a href="#cb53-56"></a><span class="fu">function_name</span>(<span class="dv">2</span>)</span>
<span id="cb53-57"><a href="#cb53-57"></a></span>
<span id="cb53-58"><a href="#cb53-58"></a><span class="in">```</span></span>
<span id="cb53-59"><a href="#cb53-59"></a></span>
<span id="cb53-60"><a href="#cb53-60"></a></span>
<span id="cb53-61"><a href="#cb53-61"></a>The core parts of defining a function include:</span>
<span id="cb53-62"><a href="#cb53-62"></a></span>
<span id="cb53-63"><a href="#cb53-63"></a><span class="ss">- </span>**`function()` directive**</span>
<span id="cb53-64"><a href="#cb53-64"></a><span class="ss">    - </span>This is what allows tells R to create a function.</span>
<span id="cb53-65"><a href="#cb53-65"></a><span class="ss">- </span>**Arguments/Inputs**: the <span class="in">`input_name_1`</span> and <span class="in">`input_name_2`</span> -- these are names of the function inputs</span>
<span id="cb53-66"><a href="#cb53-66"></a><span class="ss">    - </span><span class="in">`default_value_2`</span> is a default value that is used if no input values are provided when the function is called</span>
<span id="cb53-67"><a href="#cb53-67"></a><span class="ss">- </span>**Function body**</span>
<span id="cb53-68"><a href="#cb53-68"></a><span class="ss">    - </span>The code inside the curly braces <span class="in">`{ }`</span> is where all the work happens. This code uses the function arguments to perform computations.</span>
<span id="cb53-69"><a href="#cb53-69"></a><span class="ss">- </span>**Return value**</span>
<span id="cb53-70"><a href="#cb53-70"></a><span class="ss">    - </span>We can explicitly return an object by putting it inside <span class="in">`return()`</span>.</span>
<span id="cb53-71"><a href="#cb53-71"></a></span>
<span id="cb53-72"><a href="#cb53-72"></a>    </span>
<span id="cb53-73"><a href="#cb53-73"></a></span>
<span id="cb53-74"><a href="#cb53-74"></a>Here are three examples that can help us learn a few properties of functions:</span>
<span id="cb53-75"><a href="#cb53-75"></a></span>
<span id="cb53-78"><a href="#cb53-78"></a><span class="in">```{r}</span></span>
<span id="cb53-79"><a href="#cb53-79"></a>average <span class="ot">&lt;-</span> <span class="cf">function</span>(x, remove_nas) {</span>
<span id="cb53-80"><a href="#cb53-80"></a>    <span class="fu">return</span>(<span class="fu">sum</span>(x, <span class="at">na.rm =</span> remove_nas)<span class="sc">/</span><span class="fu">length</span>(x))</span>
<span id="cb53-81"><a href="#cb53-81"></a>}</span>
<span id="cb53-82"><a href="#cb53-82"></a>average2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">remove_nas =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb53-83"><a href="#cb53-83"></a>    <span class="fu">return</span>(<span class="fu">sum</span>(x, <span class="at">na.rm =</span> remove_nas)<span class="sc">/</span><span class="fu">length</span>(x))</span>
<span id="cb53-84"><a href="#cb53-84"></a>}</span>
<span id="cb53-85"><a href="#cb53-85"></a></span>
<span id="cb53-86"><a href="#cb53-86"></a>average3 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, remove_nas) {</span>
<span id="cb53-87"><a href="#cb53-87"></a>    <span class="fu">sum</span>(x, <span class="at">na.rm =</span> remove_nas)<span class="sc">/</span><span class="fu">length</span>(x)</span>
<span id="cb53-88"><a href="#cb53-88"></a>}</span>
<span id="cb53-89"><a href="#cb53-89"></a><span class="in">```</span></span>
<span id="cb53-90"><a href="#cb53-90"></a></span>
<span id="cb53-91"><a href="#cb53-91"></a>Note:</span>
<span id="cb53-92"><a href="#cb53-92"></a></span>
<span id="cb53-93"><a href="#cb53-93"></a><span class="ss">- </span>In <span class="in">`average2`</span>, the <span class="in">`remove_nas`</span> argument has a **default** value of <span class="in">`TRUE`</span>.</span>
<span id="cb53-94"><a href="#cb53-94"></a></span>
<span id="cb53-95"><a href="#cb53-95"></a>When a function has default values for arguments, they don't have to be provided when you call the function if you want to use the default value. See below:</span>
<span id="cb53-96"><a href="#cb53-96"></a></span>
<span id="cb53-97"><a href="#cb53-97"></a><span class="in">```{r error = TRUE}</span></span>
<span id="cb53-98"><a href="#cb53-98"></a><span class="co"># Does throw an error</span></span>
<span id="cb53-99"><a href="#cb53-99"></a><span class="fu">average</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="cn">NA</span>))</span>
<span id="cb53-100"><a href="#cb53-100"></a><span class="fu">average</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="cn">NA</span>), <span class="at">remove_nas =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-101"><a href="#cb53-101"></a></span>
<span id="cb53-102"><a href="#cb53-102"></a><span class="co"># Doesn't throw an error</span></span>
<span id="cb53-103"><a href="#cb53-103"></a><span class="fu">average2</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="cn">NA</span>))</span>
<span id="cb53-104"><a href="#cb53-104"></a><span class="fu">average2</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="cn">NA</span>), <span class="at">remove_nas =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-105"><a href="#cb53-105"></a><span class="in">```</span></span>
<span id="cb53-106"><a href="#cb53-106"></a></span>
<span id="cb53-107"><a href="#cb53-107"></a></span>
<span id="cb53-108"><a href="#cb53-108"></a><span class="ss">- </span>If we don't provide a <span class="in">`return()`</span>, the last value that gets evaluated in the **function body** and isn't stored as an object is what the function returns. (This is generally the last line without an assignment operator <span class="in">`&lt;-`</span>.)</span>
<span id="cb53-109"><a href="#cb53-109"></a><span class="ss">    - </span><span class="in">`average3()`</span> is one example, but this can easily lead to errors.</span>
<span id="cb53-110"><a href="#cb53-110"></a><span class="ss">    - </span>We should explicitly return an object by putting it inside <span class="in">`return()`</span>.</span>
<span id="cb53-111"><a href="#cb53-111"></a></span>
<span id="cb53-112"><a href="#cb53-112"></a></span>
<span id="cb53-113"><a href="#cb53-113"></a></span>
<span id="cb53-114"><a href="#cb53-114"></a></span>
<span id="cb53-115"><a href="#cb53-115"></a><span class="fu">## Scope </span></span>
<span id="cb53-116"><a href="#cb53-116"></a></span>
<span id="cb53-117"><a href="#cb53-117"></a>In programming, **scope** refers to the area of a program where a named object is recognized and can be used. </span>
<span id="cb53-118"><a href="#cb53-118"></a></span>
<span id="cb53-119"><a href="#cb53-119"></a><span class="ss">- </span>R uses **lexical scoping**, which means that the scope of a variable is determined by where it is created in the code. </span>
<span id="cb53-120"><a href="#cb53-120"></a></span>
<span id="cb53-121"><a href="#cb53-121"></a></span>
<span id="cb53-122"><a href="#cb53-122"></a>Lexical scoping in R:</span>
<span id="cb53-123"><a href="#cb53-123"></a></span>
<span id="cb53-124"><a href="#cb53-124"></a><span class="ss">- </span>When code refers to an object (e.g. data set, function, vector, etc.), R looks for the object in the current, **local environment**. </span>
<span id="cb53-125"><a href="#cb53-125"></a><span class="ss">- </span>If it doesn't find it, it continues to search by looking in the parent environment, and so on. The top-level environment is the **global environment**, the location where all interactive (i.e. outside of a function) computation and storage takes place. </span>
<span id="cb53-126"><a href="#cb53-126"></a><span class="ss">    - </span>If you save an object in R, outside a function local environment, it is stored in the global environment. </span>
<span id="cb53-127"><a href="#cb53-127"></a><span class="ss">- </span>If R can't find it in the global environment, it will look for it in loaded packages.</span>
<span id="cb53-128"><a href="#cb53-128"></a></span>
<span id="cb53-129"><a href="#cb53-129"></a></span>
<span id="cb53-130"><a href="#cb53-130"></a>When writing and using functions, the local environment is within the function itself. </span>
<span id="cb53-131"><a href="#cb53-131"></a></span>
<span id="cb53-132"><a href="#cb53-132"></a><span class="ss">- </span>If you define an object in the function, it won't be accessible outside that function (unless you pass it as the output). See below:</span>
<span id="cb53-133"><a href="#cb53-133"></a></span>
<span id="cb53-134"><a href="#cb53-134"></a><span class="in">```{r error=TRUE}</span></span>
<span id="cb53-135"><a href="#cb53-135"></a>average_new <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">remove_nas =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb53-136"><a href="#cb53-136"></a>    <span class="fu">sum</span>(x, <span class="at">na.rm =</span> remove_nas)<span class="sc">/</span><span class="fu">length</span>(x)</span>
<span id="cb53-137"><a href="#cb53-137"></a>  fun_new_thing_within_function <span class="ot">&lt;-</span> <span class="st">"Fun times!"</span></span>
<span id="cb53-138"><a href="#cb53-138"></a>}</span>
<span id="cb53-139"><a href="#cb53-139"></a><span class="fu">average_new</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb53-140"><a href="#cb53-140"></a>fun_new_thing_within_function</span>
<span id="cb53-141"><a href="#cb53-141"></a><span class="in">```</span></span>
<span id="cb53-142"><a href="#cb53-142"></a></span>
<span id="cb53-143"><a href="#cb53-143"></a></span>
<span id="cb53-144"><a href="#cb53-144"></a></span>
<span id="cb53-145"><a href="#cb53-145"></a>Scoping is important to consider if you try to refer to objects that aren't passed as arguments. </span>
<span id="cb53-146"><a href="#cb53-146"></a></span>
<span id="cb53-147"><a href="#cb53-147"></a><span class="ss">- </span>This can be dangerous because if you re-use names of variables, it is easy to accidentally refer to a variable that is not the one you intended. See below:</span>
<span id="cb53-148"><a href="#cb53-148"></a></span>
<span id="cb53-149"><a href="#cb53-149"></a><span class="in">```{r error=TRUE}</span></span>
<span id="cb53-150"><a href="#cb53-150"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb53-151"><a href="#cb53-151"></a></span>
<span id="cb53-152"><a href="#cb53-152"></a>average_new2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">remove_nas =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb53-153"><a href="#cb53-153"></a>    <span class="fu">sum</span>(x, <span class="at">na.rm =</span> remove_nas)<span class="sc">/</span><span class="fu">length</span>(x) <span class="sc">+</span> v</span>
<span id="cb53-154"><a href="#cb53-154"></a>}</span>
<span id="cb53-155"><a href="#cb53-155"></a></span>
<span id="cb53-156"><a href="#cb53-156"></a></span>
<span id="cb53-157"><a href="#cb53-157"></a><span class="fu">average_new2</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb53-158"><a href="#cb53-158"></a></span>
<span id="cb53-159"><a href="#cb53-159"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>)</span>
<span id="cb53-160"><a href="#cb53-160"></a><span class="fu">average_new2</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb53-161"><a href="#cb53-161"></a><span class="in">```</span></span>
<span id="cb53-162"><a href="#cb53-162"></a></span>
<span id="cb53-163"><a href="#cb53-163"></a></span>
<span id="cb53-164"><a href="#cb53-164"></a>Anything created/saved/updated within a function that you want accessible outside that function needs to be passed to <span class="in">`return()`</span>. See below:</span>
<span id="cb53-165"><a href="#cb53-165"></a></span>
<span id="cb53-166"><a href="#cb53-166"></a><span class="in">```{r error=TRUE}</span></span>
<span id="cb53-167"><a href="#cb53-167"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb53-168"><a href="#cb53-168"></a></span>
<span id="cb53-169"><a href="#cb53-169"></a>average_new3 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">remove_nas =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb53-170"><a href="#cb53-170"></a>  v <span class="ot">&lt;-</span> v <span class="sc">+</span> <span class="dv">10</span> <span class="co"># this is not changing v outside the function... </span></span>
<span id="cb53-171"><a href="#cb53-171"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(x, <span class="at">na.rm =</span> remove_nas)<span class="sc">/</span><span class="fu">length</span>(x) )</span>
<span id="cb53-172"><a href="#cb53-172"></a>}</span>
<span id="cb53-173"><a href="#cb53-173"></a></span>
<span id="cb53-174"><a href="#cb53-174"></a><span class="fu">average_new3</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb53-175"><a href="#cb53-175"></a>v</span>
<span id="cb53-176"><a href="#cb53-176"></a></span>
<span id="cb53-177"><a href="#cb53-177"></a><span class="in">```</span></span>
<span id="cb53-178"><a href="#cb53-178"></a></span>
<span id="cb53-179"><a href="#cb53-179"></a></span>
<span id="cb53-180"><a href="#cb53-180"></a>For more about lexical scoping in R, see <span class="co">[</span><span class="ot">R Programming for Data Science</span><span class="co">](https://bookdown.org/rdpeng/rprogdatascience/scoping-rules-of-r.html)</span></span>
<span id="cb53-181"><a href="#cb53-181"></a></span>
<span id="cb53-182"><a href="#cb53-182"></a></span>
<span id="cb53-183"><a href="#cb53-183"></a><span class="fu">## Writing Functions </span></span>
<span id="cb53-184"><a href="#cb53-184"></a></span>
<span id="cb53-185"><a href="#cb53-185"></a></span>
<span id="cb53-186"><a href="#cb53-186"></a>Tips for writing functions:</span>
<span id="cb53-187"><a href="#cb53-187"></a></span>
<span id="cb53-188"><a href="#cb53-188"></a><span class="ss">- </span>Write the code for the body of the function (the task that you are wanting to repeat)</span>
<span id="cb53-189"><a href="#cb53-189"></a><span class="ss">- </span>Identify the parts of the function that could/would change (these are the inputs)</span>
<span id="cb53-190"><a href="#cb53-190"></a><span class="ss">    - </span>Update the body of the function to be in terms of the inputs</span>
<span id="cb53-191"><a href="#cb53-191"></a><span class="ss">    - </span>Avoid manually typing anything that is specific to one input; use code to get that (such as unique values of a variable) </span>
<span id="cb53-192"><a href="#cb53-192"></a><span class="ss">- </span>Identify the output you want to return</span>
<span id="cb53-193"><a href="#cb53-193"></a></span>
<span id="cb53-194"><a href="#cb53-194"></a></span>
<span id="cb53-195"><a href="#cb53-195"></a>**Pair programming exercises:** There are 2 exercises for each section below. </span>
<span id="cb53-196"><a href="#cb53-196"></a></span>
<span id="cb53-197"><a href="#cb53-197"></a><span class="ss">- </span>Read through the introduction of the concept and then work on the exercises together.  </span>
<span id="cb53-198"><a href="#cb53-198"></a><span class="ss">- </span>You'll swap driver and navigator roles between exercises. </span>
<span id="cb53-199"><a href="#cb53-199"></a><span class="ss">- </span>Remember: The driver writes the code. The navigator oversees and provides guidance. </span>
<span id="cb53-200"><a href="#cb53-200"></a><span class="ss">- </span>For the first exercise, the person whose birthday is coming up sooner will be the driver first. Swap role for the second exercise and continue in this manner for all exercises.</span>
<span id="cb53-201"><a href="#cb53-201"></a></span>
<span id="cb53-202"><a href="#cb53-202"></a></span>
<span id="cb53-203"><a href="#cb53-203"></a><span class="ss">1. </span>**Rescaling function** Write a function that rescales a numeric vector to be between 0 and 1. Here are some test cases with the expected output. Test out your function on the following inputs:</span>
<span id="cb53-204"><a href="#cb53-204"></a></span>
<span id="cb53-205"><a href="#cb53-205"></a><span class="ss">- </span><span class="in">`x = 2:4`</span>. Expected output: <span class="in">`0.0 0.5 1.0`</span></span>
<span id="cb53-206"><a href="#cb53-206"></a><span class="ss">- </span><span class="in">`x = c(-1, 0, 5)`</span>. Expected output: <span class="in">`0.0000000 0.1666667 1.0000000`</span></span>
<span id="cb53-207"><a href="#cb53-207"></a><span class="ss">- </span><span class="in">`x = -3:-1`</span>. Expected output: <span class="in">`0.0 0.5 1.0`</span></span>
<span id="cb53-208"><a href="#cb53-208"></a></span>
<span id="cb53-211"><a href="#cb53-211"></a><span class="in">```{r}</span></span>
<span id="cb53-212"><a href="#cb53-212"></a>rescale <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb53-213"><a href="#cb53-213"></a>  r <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-214"><a href="#cb53-214"></a>  (x<span class="sc">-</span>r[<span class="dv">1</span>])<span class="sc">/</span>(r[<span class="dv">2</span>]<span class="sc">-</span>r[<span class="dv">1</span>])</span>
<span id="cb53-215"><a href="#cb53-215"></a>}</span>
<span id="cb53-216"><a href="#cb53-216"></a></span>
<span id="cb53-217"><a href="#cb53-217"></a><span class="fu">rescale</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb53-218"><a href="#cb53-218"></a><span class="fu">rescale</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">5</span>))</span>
<span id="cb53-219"><a href="#cb53-219"></a><span class="fu">rescale</span>(<span class="sc">-</span><span class="dv">3</span><span class="sc">:-</span><span class="dv">1</span>)</span>
<span id="cb53-220"><a href="#cb53-220"></a><span class="in">```</span></span>
<span id="cb53-221"><a href="#cb53-221"></a></span>
<span id="cb53-222"><a href="#cb53-222"></a><span class="ss">2. </span>**Phone digits** Write a function that formats a 10-digit phone number nicely as <span class="in">`(###) ###-####`</span>. Your function should work on the following test cases: <span class="in">`c("651-330-8661", "6516966000", "800 867 5309")`</span>. It may help to refer to the <span class="in">`stringr`</span> cheatsheet.</span>
<span id="cb53-223"><a href="#cb53-223"></a></span>
<span id="cb53-226"><a href="#cb53-226"></a><span class="in">```{r}</span></span>
<span id="cb53-227"><a href="#cb53-227"></a>phone_digits <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb53-228"><a href="#cb53-228"></a>  only_num <span class="ot">&lt;-</span> <span class="fu">str_remove_all</span>(x,<span class="st">"[^</span><span class="sc">\\</span><span class="st">d]"</span>)</span>
<span id="cb53-229"><a href="#cb53-229"></a>  <span class="fu">str_c</span>(<span class="st">"("</span>, <span class="fu">str_sub</span>(only_num,<span class="dv">1</span>,<span class="dv">3</span>), <span class="st">") "</span>, <span class="fu">str_sub</span>(only_num,<span class="dv">4</span>,<span class="dv">6</span>), <span class="st">"-"</span>,<span class="fu">str_sub</span>(only_num,<span class="dv">7</span>,<span class="sc">-</span><span class="dv">1</span>) )</span>
<span id="cb53-230"><a href="#cb53-230"></a>  </span>
<span id="cb53-231"><a href="#cb53-231"></a>}</span>
<span id="cb53-232"><a href="#cb53-232"></a></span>
<span id="cb53-233"><a href="#cb53-233"></a><span class="fu">phone_digits</span>(<span class="fu">c</span>(<span class="st">"651-330-8661"</span>, <span class="st">"6516966000"</span>, <span class="st">"800 867 5309"</span>))</span>
<span id="cb53-234"><a href="#cb53-234"></a></span>
<span id="cb53-235"><a href="#cb53-235"></a><span class="in">```</span></span>
<span id="cb53-236"><a href="#cb53-236"></a></span>
<span id="cb53-237"><a href="#cb53-237"></a></span>
<span id="cb53-238"><a href="#cb53-238"></a><span class="fu">## Calling a Function </span></span>
<span id="cb53-239"><a href="#cb53-239"></a></span>
<span id="cb53-240"><a href="#cb53-240"></a>When you supply arguments to a function, they can be matched **by position** and/or **by name**.</span>
<span id="cb53-241"><a href="#cb53-241"></a></span>
<span id="cb53-242"><a href="#cb53-242"></a></span>
<span id="cb53-243"><a href="#cb53-243"></a>When you call a function without <span class="in">`argument = value`</span> inside the parentheses, you are using **positional matching**.</span>
<span id="cb53-244"><a href="#cb53-244"></a></span>
<span id="cb53-245"><a href="#cb53-245"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb53-246"><a href="#cb53-246"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> price)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb53-247"><a href="#cb53-247"></a><span class="in">```</span></span>
<span id="cb53-248"><a href="#cb53-248"></a></span>
<span id="cb53-249"><a href="#cb53-249"></a></span>
<span id="cb53-250"><a href="#cb53-250"></a>The above works because the first argument of <span class="in">`ggplot`</span> is <span class="in">`data`</span> and the second is <span class="in">`mapping`</span>. (Pull up the documentation on <span class="in">`ggplot`</span> with <span class="in">`?ggplot`</span> in the Console.) So the following doesn't work:</span>
<span id="cb53-251"><a href="#cb53-251"></a></span>
<span id="cb53-252"><a href="#cb53-252"></a><span class="in">```{r error=TRUE}</span></span>
<span id="cb53-253"><a href="#cb53-253"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> price), diamonds) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb53-254"><a href="#cb53-254"></a><span class="in">```</span></span>
<span id="cb53-255"><a href="#cb53-255"></a></span>
<span id="cb53-256"><a href="#cb53-256"></a></span>
<span id="cb53-257"><a href="#cb53-257"></a>But if we named the arguments (**name matching**), we would be fine:</span>
<span id="cb53-258"><a href="#cb53-258"></a></span>
<span id="cb53-259"><a href="#cb53-259"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb53-260"><a href="#cb53-260"></a><span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> price), <span class="at">data =</span> diamonds) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb53-261"><a href="#cb53-261"></a><span class="in">```</span></span>
<span id="cb53-262"><a href="#cb53-262"></a></span>
<span id="cb53-263"><a href="#cb53-263"></a></span>
<span id="cb53-264"><a href="#cb53-264"></a>Somewhat confusingly, we can name some arguments and not others. Below, <span class="in">`mapping`</span> is named, but <span class="in">`data`</span> isn't. This works because when an argument is matched by name, it is "removed" from the argument list, and the remaining unnamed arguments are matched in the order that they are listed in the function definition. **Just because this is possible doesn't mean it's a good idea--don't do this!**</span>
<span id="cb53-265"><a href="#cb53-265"></a></span>
<span id="cb53-266"><a href="#cb53-266"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb53-267"><a href="#cb53-267"></a><span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> price), diamonds) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb53-268"><a href="#cb53-268"></a><span class="in">```</span></span>
<span id="cb53-269"><a href="#cb53-269"></a></span>
<span id="cb53-270"><a href="#cb53-270"></a></span>
<span id="cb53-271"><a href="#cb53-271"></a>::: {.callout-tip title="Argument matching"}</span>
<span id="cb53-272"><a href="#cb53-272"></a>In general, it is safest to match arguments by name and position for your peace of mind. For functions that you are very familiar with (and know the argument order), it's ok to just use positional matching.</span>
<span id="cb53-273"><a href="#cb53-273"></a>:::</span>
<span id="cb53-274"><a href="#cb53-274"></a></span>
<span id="cb53-275"><a href="#cb53-275"></a></span>
<span id="cb53-276"><a href="#cb53-276"></a><span class="ss">3. </span>**Error Messages** Diagnose the error message in the example below:</span>
<span id="cb53-277"><a href="#cb53-277"></a></span>
<span id="cb53-278"><a href="#cb53-278"></a><span class="in">```</span></span>
<span id="cb53-279"><a href="#cb53-279"></a><span class="in">ggplot() |&gt;</span></span>
<span id="cb53-280"><a href="#cb53-280"></a><span class="in">    geom_sf(census_data, aes(fill = population))</span></span>
<span id="cb53-281"><a href="#cb53-281"></a><span class="in">    </span></span>
<span id="cb53-282"><a href="#cb53-282"></a><span class="in">Error in `layer_sf()`:</span></span>
<span id="cb53-283"><a href="#cb53-283"></a><span class="in">! `mapping` must be created by `aes()`</span></span>
<span id="cb53-284"><a href="#cb53-284"></a><span class="in">```</span></span>
<span id="cb53-285"><a href="#cb53-285"></a></span>
<span id="cb53-286"><a href="#cb53-286"></a><span class="fu">## The `if-else if-else` Control Structure </span></span>
<span id="cb53-287"><a href="#cb53-287"></a></span>
<span id="cb53-288"><a href="#cb53-288"></a>Often in functions, you will want to execute code chunks conditionally. In a programming language, **control structures** are parts of the language that allow you to control what code is executed. By far the most common is the `<span class="in">`if-else if-else`</span> structure.</span>
<span id="cb53-289"><a href="#cb53-289"></a></span>
<span id="cb53-290"><a href="#cb53-290"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb53-291"><a href="#cb53-291"></a><span class="cf">if</span> (logical_condition) {</span>
<span id="cb53-292"><a href="#cb53-292"></a>    <span class="co"># some code</span></span>
<span id="cb53-293"><a href="#cb53-293"></a>} <span class="cf">else</span> <span class="cf">if</span> (other_logical_condition) {</span>
<span id="cb53-294"><a href="#cb53-294"></a>    <span class="co"># some code</span></span>
<span id="cb53-295"><a href="#cb53-295"></a>} <span class="cf">else</span> {</span>
<span id="cb53-296"><a href="#cb53-296"></a>    <span class="co"># some code</span></span>
<span id="cb53-297"><a href="#cb53-297"></a>}</span>
<span id="cb53-298"><a href="#cb53-298"></a></span>
<span id="cb53-299"><a href="#cb53-299"></a>middle <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb53-300"><a href="#cb53-300"></a>    mean_x <span class="ot">&lt;-</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-301"><a href="#cb53-301"></a>    median_x <span class="ot">&lt;-</span> <span class="fu">median</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-302"><a href="#cb53-302"></a>    seems_skewed <span class="ot">&lt;-</span> (mean_x <span class="sc">&gt;</span> <span class="fl">1.5</span><span class="sc">*</span>median_x) <span class="sc">|</span> (mean_x <span class="sc">&lt;</span> (<span class="dv">1</span><span class="sc">/</span><span class="fl">1.5</span>)<span class="sc">*</span>median_x)</span>
<span id="cb53-303"><a href="#cb53-303"></a>    <span class="cf">if</span> (seems_skewed) {</span>
<span id="cb53-304"><a href="#cb53-304"></a>        median_x</span>
<span id="cb53-305"><a href="#cb53-305"></a>    } <span class="cf">else</span> {</span>
<span id="cb53-306"><a href="#cb53-306"></a>        mean_x</span>
<span id="cb53-307"><a href="#cb53-307"></a>    }</span>
<span id="cb53-308"><a href="#cb53-308"></a>}</span>
<span id="cb53-309"><a href="#cb53-309"></a><span class="in">```</span></span>
<span id="cb53-310"><a href="#cb53-310"></a></span>
<span id="cb53-311"><a href="#cb53-311"></a>::: {.callout-tip title="To vectorize or not to vectorize"}</span>
<span id="cb53-312"><a href="#cb53-312"></a>The <span class="in">`if () else {}`</span> code is not **vectorized**; the logical condition in <span class="in">`if()`</span> cannot be a logical vector of length longer than 1. If you want a vectorized version of conditional execution of code use <span class="in">`if_else()`</span> or <span class="in">`case_when()`</span>; these can be used in <span class="in">`mutate()`</span>. </span>
<span id="cb53-313"><a href="#cb53-313"></a>:::</span>
<span id="cb53-314"><a href="#cb53-314"></a></span>
<span id="cb53-315"><a href="#cb53-315"></a><span class="ss">4. </span>**Convert Temp** Write a function for converting temperatures that takes as input a numeric value and a unit (either "C" for Celsius or "F" for Fahrenheit). The function should convert the temperature from one unit to the other based on the following formulas:</span>
<span id="cb53-316"><a href="#cb53-316"></a></span>
<span id="cb53-317"><a href="#cb53-317"></a><span class="ss">- </span>To convert Celsius to Fahrenheit: <span class="in">`(Celsius * 9/5) + 32`</span></span>
<span id="cb53-318"><a href="#cb53-318"></a><span class="ss">- </span>To convert Fahrenheit to Celsius: <span class="in">`(Fahrenheit - 32) * 5/9`</span></span>
<span id="cb53-319"><a href="#cb53-319"></a></span>
<span id="cb53-322"><a href="#cb53-322"></a><span class="in">```{r}</span></span>
<span id="cb53-323"><a href="#cb53-323"></a><span class="in">```</span></span>
<span id="cb53-324"><a href="#cb53-324"></a></span>
<span id="cb53-325"><a href="#cb53-325"></a></span>
<span id="cb53-326"><a href="#cb53-326"></a><span class="ss">5. </span>**Domain Name** Write a function that extracts the domain name of a supplied email address. The function should return the domain name (e.g., "gmail.com"). If the input is not a valid email address, return "Invalid Email". (A valid email ends in "dot something".)</span>
<span id="cb53-327"><a href="#cb53-327"></a></span>
<span id="cb53-330"><a href="#cb53-330"></a><span class="in">```{r}</span></span>
<span id="cb53-331"><a href="#cb53-331"></a><span class="in">```</span></span>
<span id="cb53-332"><a href="#cb53-332"></a></span>
<span id="cb53-333"><a href="#cb53-333"></a></span>
<span id="cb53-334"><a href="#cb53-334"></a><span class="fu">## Writing Functions with `tidyverse` Verbs </span></span>
<span id="cb53-335"><a href="#cb53-335"></a></span>
<span id="cb53-336"><a href="#cb53-336"></a>Perhaps we are using <span class="in">`group_by()`</span> and <span class="in">`summarize()`</span> a lot to compute group means. We might write this function:</span>
<span id="cb53-337"><a href="#cb53-337"></a></span>
<span id="cb53-340"><a href="#cb53-340"></a><span class="in">```{r}</span></span>
<span id="cb53-341"><a href="#cb53-341"></a>group_means <span class="ot">&lt;-</span> <span class="cf">function</span>(df, group_var, mean_var) {</span>
<span id="cb53-342"><a href="#cb53-342"></a>    df <span class="sc">|&gt;</span></span>
<span id="cb53-343"><a href="#cb53-343"></a>        <span class="fu">group_by</span>(group_var) <span class="sc">|&gt;</span></span>
<span id="cb53-344"><a href="#cb53-344"></a>        <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(mean_var))</span>
<span id="cb53-345"><a href="#cb53-345"></a>}</span>
<span id="cb53-346"><a href="#cb53-346"></a><span class="in">```</span></span>
<span id="cb53-347"><a href="#cb53-347"></a></span>
<span id="cb53-348"><a href="#cb53-348"></a>Let's use it on the <span class="in">`diamonds`</span> dataset to compute the mean size (<span class="in">`carat`</span>) by diamond <span class="in">`cut`</span>:</span>
<span id="cb53-349"><a href="#cb53-349"></a></span>
<span id="cb53-350"><a href="#cb53-350"></a><span class="in">```{r error=TRUE}</span></span>
<span id="cb53-351"><a href="#cb53-351"></a><span class="fu">group_means</span>(diamonds, <span class="at">group_var =</span> cut, <span class="at">mean_var =</span> carat)</span>
<span id="cb53-352"><a href="#cb53-352"></a><span class="in">```</span></span>
<span id="cb53-353"><a href="#cb53-353"></a></span>
<span id="cb53-354"><a href="#cb53-354"></a></span>
<span id="cb53-355"><a href="#cb53-355"></a>What if the problem is that the variable names need to be in quotes?</span>
<span id="cb53-356"><a href="#cb53-356"></a></span>
<span id="cb53-357"><a href="#cb53-357"></a><span class="in">```{r error=TRUE}</span></span>
<span id="cb53-358"><a href="#cb53-358"></a><span class="fu">group_means</span>(diamonds, <span class="at">group_var =</span> <span class="st">"cut"</span>, <span class="at">mean_var =</span> <span class="st">"carat"</span>)</span>
<span id="cb53-359"><a href="#cb53-359"></a><span class="in">```</span></span>
<span id="cb53-360"><a href="#cb53-360"></a></span>
<span id="cb53-361"><a href="#cb53-361"></a></span>
<span id="cb53-362"><a href="#cb53-362"></a></span>
<span id="cb53-363"><a href="#cb53-363"></a>What's Going On?</span>
<span id="cb53-364"><a href="#cb53-364"></a></span>
<span id="cb53-365"><a href="#cb53-365"></a>The <span class="in">`tidyverse`</span> uses something called **tidy evaluation**: this allows you to refer to a variable by typing it directly (e.g., no need to put it in quotes). </span>
<span id="cb53-366"><a href="#cb53-366"></a></span>
<span id="cb53-367"><a href="#cb53-367"></a><span class="ss">- </span><span class="in">`group_by(group_var)`</span> is expecting a variable that is actually called <span class="in">`group_var`</span>, and <span class="in">`mean(mean_var)`</span> is expecting a variable that is actually called <span class="in">`mean_var`</span>.</span>
<span id="cb53-368"><a href="#cb53-368"></a></span>
<span id="cb53-369"><a href="#cb53-369"></a></span>
<span id="cb53-370"><a href="#cb53-370"></a></span>
<span id="cb53-371"><a href="#cb53-371"></a></span>
<span id="cb53-372"><a href="#cb53-372"></a>To fix this we need to **embrace** the variables inside the function with <span class="in">`{ var }`</span>:</span>
<span id="cb53-373"><a href="#cb53-373"></a></span>
<span id="cb53-376"><a href="#cb53-376"></a><span class="in">```{r}</span></span>
<span id="cb53-377"><a href="#cb53-377"></a>group_means <span class="ot">&lt;-</span> <span class="cf">function</span>(df, group_var, mean_var) {</span>
<span id="cb53-378"><a href="#cb53-378"></a>    df <span class="sc">|&gt;</span></span>
<span id="cb53-379"><a href="#cb53-379"></a>        <span class="fu">group_by</span>({{ group_var }}) <span class="sc">|&gt;</span></span>
<span id="cb53-380"><a href="#cb53-380"></a>        <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>({{ mean_var }}))</span>
<span id="cb53-381"><a href="#cb53-381"></a>}</span>
<span id="cb53-382"><a href="#cb53-382"></a><span class="in">```</span></span>
<span id="cb53-383"><a href="#cb53-383"></a></span>
<span id="cb53-384"><a href="#cb53-384"></a>The <span class="in">`{ var }`</span> tells R to look at what the variable specified by the input  <span class="in">`var`</span> rather than look for a variable called <span class="in">`var`</span>.</span>
<span id="cb53-385"><a href="#cb53-385"></a></span>
<span id="cb53-388"><a href="#cb53-388"></a><span class="in">```{r}</span></span>
<span id="cb53-389"><a href="#cb53-389"></a><span class="fu">group_means</span>(diamonds, <span class="at">group_var =</span> cut, <span class="at">mean_var =</span> carat)</span>
<span id="cb53-390"><a href="#cb53-390"></a><span class="in">```</span></span>
<span id="cb53-391"><a href="#cb53-391"></a></span>
<span id="cb53-392"><a href="#cb53-392"></a></span>
<span id="cb53-393"><a href="#cb53-393"></a>Let's group by both <span class="in">`cut`</span> and <span class="in">`color`</span>:</span>
<span id="cb53-394"><a href="#cb53-394"></a></span>
<span id="cb53-395"><a href="#cb53-395"></a><span class="in">```{r error=TRUE}</span></span>
<span id="cb53-396"><a href="#cb53-396"></a><span class="fu">group_means</span>(diamonds, <span class="at">group_var =</span> <span class="fu">c</span>(cut, color), <span class="at">mean_var =</span> carat)</span>
<span id="cb53-397"><a href="#cb53-397"></a><span class="in">```</span></span>
<span id="cb53-398"><a href="#cb53-398"></a></span>
<span id="cb53-399"><a href="#cb53-399"></a></span>
<span id="cb53-400"><a href="#cb53-400"></a></span>
<span id="cb53-401"><a href="#cb53-401"></a>Oh No! What Now?! </span>
<span id="cb53-402"><a href="#cb53-402"></a></span>
<span id="cb53-403"><a href="#cb53-403"></a>When <span class="in">`c(cut, color)`</span> is put inside <span class="in">`{ c(cut, color) }`</span> within the function, R is actually running the code inside <span class="in">`{ }`</span>. </span>
<span id="cb53-404"><a href="#cb53-404"></a></span>
<span id="cb53-405"><a href="#cb53-405"></a><span class="ss">- </span>This combines the columns for those 2 variables into one long vector. What we really meant by <span class="in">`c(cut, color)`</span> is "group by both cut and color".</span>
<span id="cb53-406"><a href="#cb53-406"></a></span>
<span id="cb53-407"><a href="#cb53-407"></a></span>
<span id="cb53-408"><a href="#cb53-408"></a></span>
<span id="cb53-409"><a href="#cb53-409"></a>To fix this, we need the <span class="in">`pick()`</span> function to get R to see <span class="in">`{ group_var }`</span> as a vector of separate variables (like the way <span class="in">`select()`</span> works).</span>
<span id="cb53-410"><a href="#cb53-410"></a></span>
<span id="cb53-413"><a href="#cb53-413"></a><span class="in">```{r}</span></span>
<span id="cb53-414"><a href="#cb53-414"></a>group_means <span class="ot">&lt;-</span> <span class="cf">function</span>(df, group_var, mean_var) {</span>
<span id="cb53-415"><a href="#cb53-415"></a>    df <span class="sc">|&gt;</span></span>
<span id="cb53-416"><a href="#cb53-416"></a>        <span class="fu">group_by</span>(<span class="fu">pick</span>({{ group_var }})) <span class="sc">|&gt;</span></span>
<span id="cb53-417"><a href="#cb53-417"></a>        <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>({{ mean_var }}))</span>
<span id="cb53-418"><a href="#cb53-418"></a>}</span>
<span id="cb53-419"><a href="#cb53-419"></a></span>
<span id="cb53-420"><a href="#cb53-420"></a><span class="fu">group_means</span>(diamonds, carat, price)</span>
<span id="cb53-421"><a href="#cb53-421"></a><span class="in">```</span></span>
<span id="cb53-422"><a href="#cb53-422"></a></span>
<span id="cb53-423"><a href="#cb53-423"></a></span>
<span id="cb53-424"><a href="#cb53-424"></a><span class="ss">6. </span>**Prop function** Create a new version of <span class="in">`dplyr::count()`</span> that also shows proportions instead of just sample sizes. The function should be able to handle counting by multiple variables. Test your function with two different sets of arguments using the <span class="in">`diamonds`</span> dataset.</span>
<span id="cb53-425"><a href="#cb53-425"></a></span>
<span id="cb53-428"><a href="#cb53-428"></a><span class="in">```{r}</span></span>
<span id="cb53-429"><a href="#cb53-429"></a>prop_function <span class="ot">&lt;-</span> <span class="cf">function</span>(df, variables){</span>
<span id="cb53-430"><a href="#cb53-430"></a>  df <span class="sc">|&gt;</span> </span>
<span id="cb53-431"><a href="#cb53-431"></a>    <span class="fu">group_by</span>(<span class="fu">pick</span>({{variables}})) <span class="sc">|&gt;</span> </span>
<span id="cb53-432"><a href="#cb53-432"></a>    <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb53-433"><a href="#cb53-433"></a>    <span class="fu">mutate</span>(<span class="at">prop =</span> count <span class="sc">/</span> <span class="fu">nrow</span>(df))</span>
<span id="cb53-434"><a href="#cb53-434"></a>}</span>
<span id="cb53-435"><a href="#cb53-435"></a></span>
<span id="cb53-436"><a href="#cb53-436"></a><span class="fu">prop_function</span>(diamonds, <span class="fu">c</span>(cut))</span>
<span id="cb53-437"><a href="#cb53-437"></a><span class="fu">prop_function</span>(diamonds, <span class="fu">c</span>(cut, carat))</span>
<span id="cb53-438"><a href="#cb53-438"></a><span class="in">```</span></span>
<span id="cb53-439"><a href="#cb53-439"></a></span>
<span id="cb53-440"><a href="#cb53-440"></a><span class="ss">7. </span>**Scatterplot + Smooth function** Create a function that creates a scatterplot from a user-supplied dataset with user-supplied x and y variables. The plot should also show a curvy smoothing line in blue, and a linear smoothing line in red. Test your function using the <span class="in">`diamonds`</span> dataset.</span>
<span id="cb53-441"><a href="#cb53-441"></a></span>
<span id="cb53-442"><a href="#cb53-442"></a></span>
<span id="cb53-445"><a href="#cb53-445"></a><span class="in">```{r}</span></span>
<span id="cb53-446"><a href="#cb53-446"></a>scatter_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(df, x, y){</span>
<span id="cb53-447"><a href="#cb53-447"></a>  <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span>{{x}}, <span class="at">y =</span> {{y}})) <span class="sc">+</span></span>
<span id="cb53-448"><a href="#cb53-448"></a>    <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb53-449"><a href="#cb53-449"></a>    <span class="fu">geom_smooth</span>()<span class="sc">+</span></span>
<span id="cb53-450"><a href="#cb53-450"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">color =</span> <span class="st">'red'</span>)</span>
<span id="cb53-451"><a href="#cb53-451"></a>}</span>
<span id="cb53-452"><a href="#cb53-452"></a></span>
<span id="cb53-453"><a href="#cb53-453"></a><span class="fu">scatter_plot</span>(diamonds, carat, price)</span>
<span id="cb53-454"><a href="#cb53-454"></a><span class="in">```</span></span>
<span id="cb53-455"><a href="#cb53-455"></a><span class="fu">## Done!</span></span>
<span id="cb53-456"><a href="#cb53-456"></a></span>
<span id="cb53-457"><a href="#cb53-457"></a><span class="ss">- </span>Check the ICA Instructions for how to (a) push your code to GitHub and (b) update your portfolio website</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">

<div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>