<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>6 Adv Data wrangling P1 – COMP/STAT212 Portfolio</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../src/ica/07-wrangling-2-notes.html" rel="next">
<link href="../../src/ica/04-adv-maps-1-notes.html" rel="prev">
<script src="../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-2fef5ea3f8957b3e4ecc936fc74692ca.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-b6165e882820e9cbe81d0573c00a9ad9.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-336fc07c9e36db0483797e7526239151.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/bootstrap/bootstrap-b6165e882820e9cbe81d0573c00a9ad9.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en"
  });
});
</script><style>html{ scroll-behavior: smooth; }</style>
<link rel="stylesheet" href="../../style/custom.css">
</head>
<body class="nav-sidebar docked quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../src/ica/cleaning.html">In-Class Activities</a></li><li class="breadcrumb-item"><a href="../../src/ica/06-wrangling-1-notes.html"><span class="chapter-title">6 Adv Data wrangling P1</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../assets/sidebar-logo.png" alt="Random negative space illustration" class="sidebar-logo py-0 d-lg-inline d-none"></a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Nico Thorn</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Prof Viz</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/pv/pv-01.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Professional Viz Sample</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">TidyTuesday</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/tt/hw01-tt.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Homework 01</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/tt/2025-07-08.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">TidyTuesday Sample 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/tt/2025-07-15.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">TidyTuesday Sample 2</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">In-Class Activities</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ica/cleaning.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Cleaning SFO Weather Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ica/03-adv-ggplot-notes.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">3 Advanced Data Viz</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ica/04-adv-maps-1-notes.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">4 Advanced Spatial Viz P1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ica/06-wrangling-1-notes.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">6 Adv Data wrangling P1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ica/07-wrangling-2-notes.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">7 Adv Data wrangling P2</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/appx/appx-sample1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix Sample 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/appx/appx-sample2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix Sample 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../mm/mm.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Mind Maps</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#learning-goals" id="toc-learning-goals" class="nav-link active" data-scroll-target="#learning-goals">🧩 Learning Goals</a></li>
  <li><a href="#helpful-cheatsheets" id="toc-helpful-cheatsheets" class="nav-link" data-scroll-target="#helpful-cheatsheets">Helpful Cheatsheets</a></li>
  <li><a href="#vectors" id="toc-vectors" class="nav-link" data-scroll-target="#vectors">Vectors</a></li>
  <li>
<a href="#logicals" id="toc-logicals" class="nav-link" data-scroll-target="#logicals">Logicals</a>
  <ul class="collapse">
<li><a href="#notes" id="toc-notes" class="nav-link" data-scroll-target="#notes">Notes</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">Exercises</a></li>
  </ul>
</li>
  <li>
<a href="#numerics" id="toc-numerics" class="nav-link" data-scroll-target="#numerics">Numerics</a>
  <ul class="collapse">
<li><a href="#notes-1" id="toc-notes-1" class="nav-link" data-scroll-target="#notes-1">Notes</a></li>
  <li><a href="#exercises-1" id="toc-exercises-1" class="nav-link" data-scroll-target="#exercises-1">Exercises</a></li>
  </ul>
</li>
  <li>
<a href="#dates" id="toc-dates" class="nav-link" data-scroll-target="#dates">Dates</a>
  <ul class="collapse">
<li><a href="#notes-2" id="toc-notes-2" class="nav-link" data-scroll-target="#notes-2">Notes</a></li>
  <li><a href="#exercises-2" id="toc-exercises-2" class="nav-link" data-scroll-target="#exercises-2">Exercises</a></li>
  </ul>
</li>
  <li>
<a href="#factors" id="toc-factors" class="nav-link" data-scroll-target="#factors">Factors</a>
  <ul class="collapse">
<li><a href="#notes-3" id="toc-notes-3" class="nav-link" data-scroll-target="#notes-3">Notes</a></li>
  <li><a href="#exercises-3" id="toc-exercises-3" class="nav-link" data-scroll-target="#exercises-3">Exercises</a></li>
  </ul>
</li>
  <li><a href="#done" id="toc-done" class="nav-link" data-scroll-target="#done">Done!</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../src/ica/cleaning.html">In-Class Activities</a></li><li class="breadcrumb-item"><a href="../../src/ica/06-wrangling-1-notes.html"><span class="chapter-title">6 Adv Data wrangling P1</span></a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-title">6 Adv Data wrangling P1</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header><section id="learning-goals" class="level2"><h2 class="anchored" data-anchor-id="learning-goals">🧩 Learning Goals</h2>
<p>By the end of this lesson, you should be able to:</p>
<ul>
<li>Determine the class of a given object and identify concerns to be wary of when manipulating an object of that class (numerics, logicals, factors, dates, strings, data.frames)</li>
<li>Explain what vector recycling is, when it can be a problem, and how to avoid those problems</li>
<li>Use a variety of functions to wrangle numerical and logical data</li>
<li>Extract date-time information using the <code>lubridate</code> package</li>
<li>Use the <code>forcats</code> package to wrangle factor data</li>
</ul></section><section id="helpful-cheatsheets" class="level2"><h2 class="anchored" data-anchor-id="helpful-cheatsheets">Helpful Cheatsheets</h2>
<p>RStudio (Posit) maintains a collection of wonderful <a href="https://rstudio.github.io/cheatsheets/html/data-transformation.html">cheatsheets</a>. The following will be helpful:</p>
<ul>
<li><a href="https://rstudio.github.io/cheatsheets/html/data-transformation.html">Data transformation with <code>dplyr</code></a></li>
<li><a href="https://rstudio.github.io/cheatsheets/html/lubridate.html">Dates and times with <code>lubridate</code></a></li>
<li><a href="https://rstudio.github.io/cheatsheets/html/factors.html">Factors with <code>forcats</code></a></li>
</ul>
<p><strong>Data Wrangling Verbs (from Stat/Comp 112)</strong></p>
<ul>
<li>
<code>mutate()</code>: creates/changes columns/elements in a data frame/tibble</li>
<li>
<code>select()</code>: keeps subset of columns/elements in a data frame/tibble</li>
<li>
<code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code>: keeps subsets of rows in a data frame/tibble</li>
<li>
<code>arrange()</code>: sorts rows in a data frame/tibble</li>
<li>
<code>group_by()</code>: internally groups rows in data frame/tibble by values in 1 or more columsn/elements</li>
<li>
<code>summarize()</code>: collapses/combines information across rows using functions such as <code>n()</code>, <code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code>, <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code>, <code><a href="https://rdrr.io/r/base/Extremes.html">min()</a></code>, <code><a href="https://rdrr.io/r/base/Extremes.html">max()</a></code>, <code><a href="https://rdrr.io/r/stats/median.html">median()</a></code>, <code><a href="https://rdrr.io/r/stats/sd.html">sd()</a></code>
</li>
<li>
<code>count()</code>: shortcut for <code>group_by() |&gt; summarize(n = n())</code>
</li>
<li>
<code>left_join()</code>: mutating join of two data frames/tibbles keeping all rows in left data frame</li>
<li>
<code>full_join()</code>: mutating join of two data frames/tibbles keeping all rows in both data frames</li>
<li>
<code>inner_join()</code>: mutating join of two data frames/tibbles keeping rows in left data frame that find match in right</li>
<li>
<code>semi_join()</code>: filtering join of two data frames/tibbles keeping rows in left data frame that find match in right</li>
<li>
<code>anti_join()</code>: filtering join of two data frames/tibbles keeping rows in left data frame that do not find match in right</li>
<li>
<code>pivot_wider()</code>: rearrange values from two columns to many(one column becomes the names of new variables, one column becomes the values of the new variables)</li>
<li>
<code>pivot_longer()</code>: rearrange values from many columns to two (the names of the columns go to one new variable, the values of the columns go to a second new variable)</li>
</ul></section><section id="vectors" class="level2"><h2 class="anchored" data-anchor-id="vectors">Vectors</h2>
<p>An <strong>atomic vector</strong> is a storage container in R where all elements in the container are of the same type. The types that are relevant to data science are:</p>
<ul>
<li>
<code>logical</code> (also known as boolean)</li>
<li>numbers
<ul>
<li><code>integer</code></li>
<li>
<code>numeric</code> floating point (also known as double)</li>
</ul>
</li>
<li>
<code>character</code> string</li>
<li>
<code>Date</code> and date-time (saved as <code>POSIXct</code>)</li>
<li><code>factor</code></li>
</ul>
<p>Function documentation will refer to vectors frequently.</p>
<p>See examples below:</p>
<ul>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">ggplot2::scale_x_continuous()</a></code>
<ul>
<li>
<code>breaks</code>: A <strong>numeric vector</strong> of positions</li>
<li>
<code>labels</code>: A <strong>character vector</strong> giving labels (must be same length as breaks)</li>
</ul>
</li>
<li>
<code><a href="https://rdrr.io/pkg/shiny/man/sliderInput.html">shiny::sliderInput()</a></code>
<ul>
<li>
<code>value</code>: The initial value of the slider […] A <strong>length one vector</strong> will create a regular slider; a <strong>length two vector</strong> will create a double-ended range slider.</li>
</ul>
</li>
</ul>
<p>When you need a vector, you can create one manually using</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/base/c.html">c()</a></code>: the combine function</li>
</ul>
<p>Or you can create one based on available data using</p>
<ul>
<li>
<code>dataset |&gt; mutate(newvar = variable &gt; 5) |&gt; pull(newvar)</code>: taking one column out of a dataset</li>
<li>
<code>dataset |&gt; pull(variable) |&gt; unique()</code>: taking one column out of a dataset and finding unique values</li>
</ul>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">c</span>(<span class="st">"Fair"</span>, <span class="st">"Good"</span>, <span class="st">"Very Good"</span>, <span class="st">"Premium"</span>, <span class="st">"Ideal"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Fair"      "Good"      "Very Good" "Premium"   "Ideal"    </code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>diamonds <span class="sc">|&gt;</span> <span class="fu">pull</span>(cut) <span class="sc">|&gt;</span> <span class="fu">unique</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] Ideal     Premium   Good      Very Good Fair     
Levels: Fair &lt; Good &lt; Very Good &lt; Premium &lt; Ideal</code></pre>
</div>
</div>
</section><section id="logicals" class="level2"><h2 class="anchored" data-anchor-id="logicals">Logicals</h2>
<section id="notes" class="level3"><h3 class="anchored" data-anchor-id="notes">Notes</h3>
<p>What does a logical vector look like?</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">NA</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE FALSE    NA</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">class</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "logical"</code></pre>
</div>
</div>
<p>You will often create logical vectors with comparison operators: <code>&gt;</code>, <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;=</code>, <code>==</code>, <code>!=</code>.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">9</span>, <span class="dv">12</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a>x <span class="sc">&lt;</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE FALSE FALSE FALSE</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>x <span class="sc">&lt;=</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE  TRUE FALSE FALSE</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>x <span class="sc">&gt;</span> <span class="dv">9</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE FALSE FALSE  TRUE</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>x <span class="sc">&gt;=</span> <span class="dv">9</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE FALSE  TRUE  TRUE</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>x <span class="sc">==</span> <span class="dv">12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE FALSE FALSE  TRUE</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>x <span class="sc">!=</span> <span class="dv">12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE  TRUE  TRUE FALSE</code></pre>
</div>
</div>
<p>When you want to check for set containment, the <code>%in%</code> operator is the correct way to do this (as opposed to <code>==</code>).</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">9</span>, <span class="dv">4</span>)</span>
<span id="cb21-2"><a href="#cb21-2"></a>x <span class="sc">==</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in x == c(1, 2, 4): longer object length is not a multiple of shorter
object length</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE  TRUE FALSE FALSE</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>x <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE  TRUE FALSE  TRUE</code></pre>
</div>
</div>
<p>The <code>Warning: longer object length is not a multiple of shorter object length</code> is a manifestation of <strong>vector recycling</strong>.</p>
<p>In R, if two vectors are being combined or compared, the shorter one will be repeated to match the length of the longer one–even if longer object length isn’t a multiple of the shorter object length. We can see the exact recycling that happens below:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">9</span>, <span class="dv">4</span>)</span>
<span id="cb26-2"><a href="#cb26-2"></a>x <span class="sc">==</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE  TRUE FALSE FALSE</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>x <span class="sc">==</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">1</span>) <span class="co"># This line demonstrates the recycling that happens on the previous line</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE  TRUE FALSE FALSE</code></pre>
</div>
</div>
<p>Logical vectors can also be created with functions. <code><a href="https://rdrr.io/r/base/NA.html">is.na()</a></code> is one useful example:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">9</span>, <span class="cn">NA</span>)</span>
<span id="cb30-2"><a href="#cb30-2"></a>x <span class="sc">==</span> <span class="cn">NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] NA NA NA NA</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="fu">is.na</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE FALSE FALSE  TRUE</code></pre>
</div>
</div>
<p>We can negate a logical object with <code>!</code>. We can combine logical objects with <code>&amp;</code> (and) and <code>|</code> (or).</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">9</span>)</span>
<span id="cb34-2"><a href="#cb34-2"></a>x <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> x <span class="sc">&lt;</span> <span class="dv">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE  TRUE  TRUE FALSE</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="sc">!</span>(x <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> x <span class="sc">&lt;</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE FALSE FALSE  TRUE</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>x <span class="sc">&lt;</span> <span class="dv">2</span> <span class="sc">|</span> x <span class="sc">&gt;</span> <span class="dv">8</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE FALSE FALSE  TRUE</code></pre>
</div>
</div>
<p>We can summarize logical vectors with:</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/base/any.html">any()</a></code>: Are ANY of the values <code>TRUE</code>?</li>
<li>
<code><a href="https://rdrr.io/r/base/all.html">all()</a></code>: Are ALL of the values <code>TRUE</code>?</li>
<li>
<code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code>: How many of the values are <code>TRUE</code>?</li>
<li>
<code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code>: What fraction of the values are <code>TRUE</code>?</li>
</ul>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">9</span>)</span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="fu">any</span>(x <span class="sc">==</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="fu">all</span>(x <span class="sc">&lt;</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="fu">sum</span>(x <span class="sc">==</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="fu">mean</span>(x <span class="sc">==</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.25</code></pre>
</div>
</div>
<p><code>if_else()</code> and <code>case_when()</code> are functions that allow you to return values depending on the value of a logical vector. You’ll explore the documentation for these in the following exercises.</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Note: <code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code> (from base R) and <code>if_else()</code> (from tidyverse) are different functions. We prefer <code>if_else()</code> for many reasons (examples below).</p>
<ul>
<li>Noisy to make sure you catch issues/bugs</li>
<li>Can explicitly handle missing values</li>
<li>Keeps dates as dates</li>
</ul>
<details><summary>
Examples
</summary><div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">9</span>, <span class="cn">NA</span>)</span>
<span id="cb48-2"><a href="#cb48-2"></a></span>
<span id="cb48-3"><a href="#cb48-3"></a><span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">'positive'</span>, <span class="st">'negative'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "negative" "negative" "positive" "positive" NA        </code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="fu">if_else</span>(x <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">'positive'</span>, <span class="st">'negative'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "negative" "negative" "positive" "positive" NA        </code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="st">'negative'</span>) <span class="co"># Bad: doesn't complain with combo of data types</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "negative" "negative" "1"        "1"        NA        </code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="fu">if_else</span>(x <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="st">'negative'</span>) <span class="co"># Good:noisy to make sure you catch issues</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-error">
<pre><code>Error in `if_else()`:
! Can't combine `true` &lt;double&gt; and `false` &lt;character&gt;.</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="fu">if_else</span>(x <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">'positive'</span>, <span class="st">'negative'</span>, <span class="at">missing =</span> <span class="st">'missing'</span>) <span class="co"># Good: can explicitly handle NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "negative" "negative" "positive" "positive" "missing" </code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>fun_dates <span class="ot">&lt;-</span> <span class="fu">mdy</span>(<span class="st">'1-1-2025'</span>) <span class="sc">+</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">365</span></span>
<span id="cb58-2"><a href="#cb58-2"></a><span class="fu">ifelse</span>(fun_dates <span class="sc">&lt;</span> <span class="fu">today</span>(), fun_dates <span class="sc">+</span> <span class="fu">years</span>(), fun_dates) <span class="co"># Bad: converts dates to integers</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  [1] 20454 20455 20456 20457 20458 20459 20460 20461 20462 20463 20464 20465
 [13] 20466 20467 20468 20469 20470 20471 20472 20473 20474 20475 20476 20477
 [25] 20478 20479 20480 20481 20482 20483 20484 20485 20486 20487 20488 20489
 [37] 20490 20491 20492 20493 20494 20495 20496 20497 20498 20499 20500 20501
 [49] 20502 20503 20504 20505 20506 20507 20508 20509 20510 20511 20512 20513
 [61] 20514 20515 20516 20517 20518 20519 20520 20521 20522 20523 20524 20525
 [73] 20526 20527 20528 20529 20530 20531 20532 20533 20534 20535 20536 20537
 [85] 20538 20539 20540 20541 20542 20543 20544 20545 20546 20547 20548 20549
 [97] 20550 20551 20552 20553 20554 20555 20556 20557 20558 20559 20560 20561
[109] 20562 20563 20564 20565 20566 20567 20568 20569 20570 20571 20572 20573
[121] 20574 20575 20576 20577 20578 20579 20580 20581 20582 20583 20584 20585
[133] 20586 20587 20588 20589 20590 20591 20592 20593 20594 20595 20596 20597
[145] 20598 20599 20600 20601 20602 20603 20604 20605 20606 20607 20608 20609
[157] 20610 20611 20612 20613 20614 20615 20616 20617 20618 20619 20620 20621
[169] 20622 20623 20624 20625 20626 20627 20628 20629 20630 20631 20632 20633
[181] 20634 20635 20636 20637 20638 20639 20640 20641 20642 20643 20644 20645
[193] 20646 20647 20648 20649 20650 20651 20652 20653 20654 20655 20656 20657
[205] 20658 20659 20660 20661 20662 20663 20664 20665 20666 20667 20668 20669
[217] 20670 20671 20672 20673 20674 20675 20676 20677 20678 20679 20680 20681
[229] 20682 20683 20684 20685 20686 20687 20688 20689 20690 20691 20692 20693
[241] 20694 20695 20696 20697 20698 20699 20700 20701 20702 20703 20704 20705
[253] 20706 20707 20708 20709 20710 20711 20712 20713 20714 20715 20716 20717
[265] 20718 20719 20720 20721 20722 20723 20724 20725 20726 20362 20363 20364
[277] 20365 20366 20367 20368 20369 20370 20371 20372 20373 20374 20375 20376
[289] 20377 20378 20379 20380 20381 20382 20383 20384 20385 20386 20387 20388
[301] 20389 20390 20391 20392 20393 20394 20395 20396 20397 20398 20399 20400
[313] 20401 20402 20403 20404 20405 20406 20407 20408 20409 20410 20411 20412
[325] 20413 20414 20415 20416 20417 20418 20419 20420 20421 20422 20423 20424
[337] 20425 20426 20427 20428 20429 20430 20431 20432 20433 20434 20435 20436
[349] 20437 20438 20439 20440 20441 20442 20443 20444 20445 20446 20447 20448
[361] 20449 20450 20451 20452 20453 20454</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="fu">if_else</span>(fun_dates <span class="sc">&lt;</span> <span class="fu">today</span>(), fun_dates <span class="sc">+</span> <span class="fu">years</span>(), fun_dates) <span class="co"># Good: keeps dates as dates</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  [1] "2026-01-01" "2026-01-02" "2026-01-03" "2026-01-04" "2026-01-05"
  [6] "2026-01-06" "2026-01-07" "2026-01-08" "2026-01-09" "2026-01-10"
 [11] "2026-01-11" "2026-01-12" "2026-01-13" "2026-01-14" "2026-01-15"
 [16] "2026-01-16" "2026-01-17" "2026-01-18" "2026-01-19" "2026-01-20"
 [21] "2026-01-21" "2026-01-22" "2026-01-23" "2026-01-24" "2026-01-25"
 [26] "2026-01-26" "2026-01-27" "2026-01-28" "2026-01-29" "2026-01-30"
 [31] "2026-01-31" "2026-02-01" "2026-02-02" "2026-02-03" "2026-02-04"
 [36] "2026-02-05" "2026-02-06" "2026-02-07" "2026-02-08" "2026-02-09"
 [41] "2026-02-10" "2026-02-11" "2026-02-12" "2026-02-13" "2026-02-14"
 [46] "2026-02-15" "2026-02-16" "2026-02-17" "2026-02-18" "2026-02-19"
 [51] "2026-02-20" "2026-02-21" "2026-02-22" "2026-02-23" "2026-02-24"
 [56] "2026-02-25" "2026-02-26" "2026-02-27" "2026-02-28" "2026-03-01"
 [61] "2026-03-02" "2026-03-03" "2026-03-04" "2026-03-05" "2026-03-06"
 [66] "2026-03-07" "2026-03-08" "2026-03-09" "2026-03-10" "2026-03-11"
 [71] "2026-03-12" "2026-03-13" "2026-03-14" "2026-03-15" "2026-03-16"
 [76] "2026-03-17" "2026-03-18" "2026-03-19" "2026-03-20" "2026-03-21"
 [81] "2026-03-22" "2026-03-23" "2026-03-24" "2026-03-25" "2026-03-26"
 [86] "2026-03-27" "2026-03-28" "2026-03-29" "2026-03-30" "2026-03-31"
 [91] "2026-04-01" "2026-04-02" "2026-04-03" "2026-04-04" "2026-04-05"
 [96] "2026-04-06" "2026-04-07" "2026-04-08" "2026-04-09" "2026-04-10"
[101] "2026-04-11" "2026-04-12" "2026-04-13" "2026-04-14" "2026-04-15"
[106] "2026-04-16" "2026-04-17" "2026-04-18" "2026-04-19" "2026-04-20"
[111] "2026-04-21" "2026-04-22" "2026-04-23" "2026-04-24" "2026-04-25"
[116] "2026-04-26" "2026-04-27" "2026-04-28" "2026-04-29" "2026-04-30"
[121] "2026-05-01" "2026-05-02" "2026-05-03" "2026-05-04" "2026-05-05"
[126] "2026-05-06" "2026-05-07" "2026-05-08" "2026-05-09" "2026-05-10"
[131] "2026-05-11" "2026-05-12" "2026-05-13" "2026-05-14" "2026-05-15"
[136] "2026-05-16" "2026-05-17" "2026-05-18" "2026-05-19" "2026-05-20"
[141] "2026-05-21" "2026-05-22" "2026-05-23" "2026-05-24" "2026-05-25"
[146] "2026-05-26" "2026-05-27" "2026-05-28" "2026-05-29" "2026-05-30"
[151] "2026-05-31" "2026-06-01" "2026-06-02" "2026-06-03" "2026-06-04"
[156] "2026-06-05" "2026-06-06" "2026-06-07" "2026-06-08" "2026-06-09"
[161] "2026-06-10" "2026-06-11" "2026-06-12" "2026-06-13" "2026-06-14"
[166] "2026-06-15" "2026-06-16" "2026-06-17" "2026-06-18" "2026-06-19"
[171] "2026-06-20" "2026-06-21" "2026-06-22" "2026-06-23" "2026-06-24"
[176] "2026-06-25" "2026-06-26" "2026-06-27" "2026-06-28" "2026-06-29"
[181] "2026-06-30" "2026-07-01" "2026-07-02" "2026-07-03" "2026-07-04"
[186] "2026-07-05" "2026-07-06" "2026-07-07" "2026-07-08" "2026-07-09"
[191] "2026-07-10" "2026-07-11" "2026-07-12" "2026-07-13" "2026-07-14"
[196] "2026-07-15" "2026-07-16" "2026-07-17" "2026-07-18" "2026-07-19"
[201] "2026-07-20" "2026-07-21" "2026-07-22" "2026-07-23" "2026-07-24"
[206] "2026-07-25" "2026-07-26" "2026-07-27" "2026-07-28" "2026-07-29"
[211] "2026-07-30" "2026-07-31" "2026-08-01" "2026-08-02" "2026-08-03"
[216] "2026-08-04" "2026-08-05" "2026-08-06" "2026-08-07" "2026-08-08"
[221] "2026-08-09" "2026-08-10" "2026-08-11" "2026-08-12" "2026-08-13"
[226] "2026-08-14" "2026-08-15" "2026-08-16" "2026-08-17" "2026-08-18"
[231] "2026-08-19" "2026-08-20" "2026-08-21" "2026-08-22" "2026-08-23"
[236] "2026-08-24" "2026-08-25" "2026-08-26" "2026-08-27" "2026-08-28"
[241] "2026-08-29" "2026-08-30" "2026-08-31" "2026-09-01" "2026-09-02"
[246] "2026-09-03" "2026-09-04" "2026-09-05" "2026-09-06" "2026-09-07"
[251] "2026-09-08" "2026-09-09" "2026-09-10" "2026-09-11" "2026-09-12"
[256] "2026-09-13" "2026-09-14" "2026-09-15" "2026-09-16" "2026-09-17"
[261] "2026-09-18" "2026-09-19" "2026-09-20" "2026-09-21" "2026-09-22"
[266] "2026-09-23" "2026-09-24" "2026-09-25" "2026-09-26" "2026-09-27"
[271] "2026-09-28" "2026-09-29" "2026-09-30" "2025-10-01" "2025-10-02"
[276] "2025-10-03" "2025-10-04" "2025-10-05" "2025-10-06" "2025-10-07"
[281] "2025-10-08" "2025-10-09" "2025-10-10" "2025-10-11" "2025-10-12"
[286] "2025-10-13" "2025-10-14" "2025-10-15" "2025-10-16" "2025-10-17"
[291] "2025-10-18" "2025-10-19" "2025-10-20" "2025-10-21" "2025-10-22"
[296] "2025-10-23" "2025-10-24" "2025-10-25" "2025-10-26" "2025-10-27"
[301] "2025-10-28" "2025-10-29" "2025-10-30" "2025-10-31" "2025-11-01"
[306] "2025-11-02" "2025-11-03" "2025-11-04" "2025-11-05" "2025-11-06"
[311] "2025-11-07" "2025-11-08" "2025-11-09" "2025-11-10" "2025-11-11"
[316] "2025-11-12" "2025-11-13" "2025-11-14" "2025-11-15" "2025-11-16"
[321] "2025-11-17" "2025-11-18" "2025-11-19" "2025-11-20" "2025-11-21"
[326] "2025-11-22" "2025-11-23" "2025-11-24" "2025-11-25" "2025-11-26"
[331] "2025-11-27" "2025-11-28" "2025-11-29" "2025-11-30" "2025-12-01"
[336] "2025-12-02" "2025-12-03" "2025-12-04" "2025-12-05" "2025-12-06"
[341] "2025-12-07" "2025-12-08" "2025-12-09" "2025-12-10" "2025-12-11"
[346] "2025-12-12" "2025-12-13" "2025-12-14" "2025-12-15" "2025-12-16"
[351] "2025-12-17" "2025-12-18" "2025-12-19" "2025-12-20" "2025-12-21"
[356] "2025-12-22" "2025-12-23" "2025-12-24" "2025-12-25" "2025-12-26"
[361] "2025-12-27" "2025-12-28" "2025-12-29" "2025-12-30" "2025-12-31"
[366] "2026-01-01"</code></pre>
</div>
</div>
</details>
</div>
</div>
</div>
</section><section id="exercises" class="level3"><h3 class="anchored" data-anchor-id="exercises">Exercises</h3>
<p>Load the diamonds dataset, and filter to the first 1000 diamonds.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="fu">data</span>(diamonds)</span>
<span id="cb62-2"><a href="#cb62-2"></a>diamonds <span class="ot">&lt;-</span> diamonds <span class="sc">|&gt;</span> </span>
<span id="cb62-3"><a href="#cb62-3"></a>    <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Using <code>tidyverse</code> functions, complete the following:</p>
<ol type="1">
<li>Subset to diamonds that are less than 400 dollars or more than 10000 dollars.</li>
<li>Subset to diamonds that are between 500 and 600 dollars (inclusive).</li>
<li>How many diamonds are of either Fair, Premium, or Ideal cut (a total count)? What fraction of diamonds are of Fair, Premium, or Ideal cut?
<ul>
<li>First, do this a wrong way with <code>==</code>. Predict the warning message that you will receive.</li>
<li>Second, do this the correct way with an appropriate logical operator.</li>
</ul>
</li>
<li>Are there any diamonds of Fair cut that are more than $3000? Are all diamonds of Ideal cut more than $2000?</li>
<li>Create two new categorized versions of <code>price</code> by looking up the documentation for <code>if_else()</code> and <code>case_when()</code>:
<ul>
<li>
<code>price_cat1</code>: “low” if price is less than 500 and “high” otherwise</li>
<li>
<code>price_cat2</code>: “low” if price is less than 500, “medium” if price is between 500 and 1000 dollars inclusive, and “high” otherwise.</li>
</ul>
</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="co">#1</span></span>
<span id="cb63-2"><a href="#cb63-2"></a></span>
<span id="cb63-3"><a href="#cb63-3"></a>diamonds <span class="sc">|&gt;</span> </span>
<span id="cb63-4"><a href="#cb63-4"></a>  <span class="fu">filter</span>(price <span class="sc">&lt;</span> <span class="dv">400</span> <span class="sc">|</span> price <span class="sc">&gt;</span> <span class="dv">10000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30 × 10
   carat cut       color clarity depth table price     x     y     z
   &lt;dbl&gt; &lt;ord&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  0.23 Ideal     E     SI2      61.5    55   326  3.95  3.98  2.43
 2  0.21 Premium   E     SI1      59.8    61   326  3.89  3.84  2.31
 3  0.23 Good      E     VS1      56.9    65   327  4.05  4.07  2.31
 4  0.29 Premium   I     VS2      62.4    58   334  4.2   4.23  2.63
 5  0.31 Good      J     SI2      63.3    58   335  4.34  4.35  2.75
 6  0.24 Very Good J     VVS2     62.8    57   336  3.94  3.96  2.48
 7  0.24 Very Good I     VVS1     62.3    57   336  3.95  3.98  2.47
 8  0.26 Very Good H     SI1      61.9    55   337  4.07  4.11  2.53
 9  0.22 Fair      E     VS2      65.1    61   337  3.87  3.78  2.49
10  0.23 Very Good H     VS1      59.4    61   338  4     4.05  2.39
# ℹ 20 more rows</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="co">#2</span></span>
<span id="cb65-2"><a href="#cb65-2"></a></span>
<span id="cb65-3"><a href="#cb65-3"></a>diamonds <span class="sc">|&gt;</span> </span>
<span id="cb65-4"><a href="#cb65-4"></a>  <span class="fu">filter</span>(price <span class="sc">&gt;=</span> <span class="dv">500</span> <span class="sc">&amp;</span> price <span class="sc">&lt;=</span> <span class="dv">600</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 90 × 10
   carat cut       color clarity depth table price     x     y     z
   &lt;dbl&gt; &lt;ord&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  0.35 Ideal     I     VS1      60.9  57     552  4.54  4.59  2.78
 2  0.3  Premium   D     SI1      62.6  59     552  4.23  4.27  2.66
 3  0.3  Ideal     D     SI1      62.5  57     552  4.29  4.32  2.69
 4  0.3  Ideal     D     SI1      62.1  56     552  4.3   4.33  2.68
 5  0.42 Premium   I     SI2      61.5  59     552  4.78  4.84  2.96
 6  0.28 Ideal     G     VVS2     61.4  56     553  4.19  4.22  2.58
 7  0.32 Ideal     I     VVS1     62    55.3   553  4.39  4.42  2.73
 8  0.31 Very Good G     SI1      63.3  57     553  4.33  4.3   2.73
 9  0.31 Premium   G     SI1      61.8  58     553  4.35  4.32  2.68
10  0.24 Premium   E     VVS1     60.7  58     553  4.01  4.03  2.44
# ℹ 80 more rows</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="co">#3</span></span>
<span id="cb67-2"><a href="#cb67-2"></a></span>
<span id="cb67-3"><a href="#cb67-3"></a>diamonds <span class="sc">|&gt;</span> </span>
<span id="cb67-4"><a href="#cb67-4"></a>  <span class="fu">mutate</span>(<span class="at">is_fpi =</span> cut <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Fair"</span>, <span class="st">"Premium"</span>, <span class="st">"Ideal"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb67-5"><a href="#cb67-5"></a>  <span class="fu">summarize</span>(<span class="fu">sum</span>(is_fpi <span class="sc">==</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  `sum(is_fpi == TRUE)`
                  &lt;int&gt;
1                   685</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a>diamonds <span class="sc">|&gt;</span> </span>
<span id="cb69-2"><a href="#cb69-2"></a>  <span class="fu">mutate</span>(<span class="at">is_fpi =</span> cut <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Fair"</span>, <span class="st">"Premium"</span>, <span class="st">"Ideal"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb69-3"><a href="#cb69-3"></a>  <span class="fu">summarize</span>(<span class="fu">mean</span>(is_fpi <span class="sc">==</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  `mean(is_fpi == TRUE)`
                   &lt;dbl&gt;
1                  0.685</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="co">#4</span></span>
<span id="cb71-2"><a href="#cb71-2"></a></span>
<span id="cb71-3"><a href="#cb71-3"></a>diamonds <span class="sc">|&gt;</span> </span>
<span id="cb71-4"><a href="#cb71-4"></a>  <span class="fu">filter</span>(cut <span class="sc">==</span> <span class="st">"Fair"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb71-5"><a href="#cb71-5"></a>  <span class="fu">summarize</span>(<span class="fu">any</span>(price <span class="sc">&gt;</span> <span class="dv">3000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  `any(price &gt; 3000)`
  &lt;lgl&gt;              
1 FALSE              </code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a>diamonds <span class="sc">|&gt;</span> </span>
<span id="cb73-2"><a href="#cb73-2"></a>  <span class="fu">filter</span>(cut <span class="sc">==</span> <span class="st">"Ideal"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb73-3"><a href="#cb73-3"></a>  <span class="fu">summarize</span>(<span class="fu">all</span>(price <span class="sc">&gt;</span><span class="dv">2000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  `all(price &gt; 2000)`
  &lt;lgl&gt;              
1 FALSE              </code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="co">#5</span></span>
<span id="cb75-2"><a href="#cb75-2"></a></span>
<span id="cb75-3"><a href="#cb75-3"></a>diamonds <span class="sc">|&gt;</span> </span>
<span id="cb75-4"><a href="#cb75-4"></a>  <span class="fu">mutate</span>(<span class="at">price_cat1 =</span> <span class="fu">if_else</span>(price <span class="sc">&lt;</span> <span class="dv">500</span>, <span class="st">"low"</span>, <span class="st">"high"</span>), </span>
<span id="cb75-5"><a href="#cb75-5"></a>         <span class="at">price_cat2 =</span> <span class="fu">case_when</span>(price <span class="sc">&lt;</span> <span class="dv">500</span> <span class="sc">~</span> <span class="st">"low"</span>,</span>
<span id="cb75-6"><a href="#cb75-6"></a>                                price <span class="sc">&gt;=</span> <span class="dv">500</span> <span class="sc">&amp;</span> price <span class="sc">&lt;=</span> <span class="dv">1000</span> <span class="sc">~</span> <span class="st">"med"</span>,</span>
<span id="cb75-7"><a href="#cb75-7"></a>                                price <span class="sc">&gt;</span> <span class="dv">1000</span> <span class="sc">~</span> <span class="st">"high"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,000 × 12
   carat cut       color clarity depth table price     x     y     z price_cat1
   &lt;dbl&gt; &lt;ord&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;     
 1  0.23 Ideal     E     SI2      61.5    55   326  3.95  3.98  2.43 low       
 2  0.21 Premium   E     SI1      59.8    61   326  3.89  3.84  2.31 low       
 3  0.23 Good      E     VS1      56.9    65   327  4.05  4.07  2.31 low       
 4  0.29 Premium   I     VS2      62.4    58   334  4.2   4.23  2.63 low       
 5  0.31 Good      J     SI2      63.3    58   335  4.34  4.35  2.75 low       
 6  0.24 Very Good J     VVS2     62.8    57   336  3.94  3.96  2.48 low       
 7  0.24 Very Good I     VVS1     62.3    57   336  3.95  3.98  2.47 low       
 8  0.26 Very Good H     SI1      61.9    55   337  4.07  4.11  2.53 low       
 9  0.22 Fair      E     VS2      65.1    61   337  3.87  3.78  2.49 low       
10  0.23 Very Good H     VS1      59.4    61   338  4     4.05  2.39 low       
# ℹ 990 more rows
# ℹ 1 more variable: price_cat2 &lt;chr&gt;</code></pre>
</div>
</div>
</section></section><section id="numerics" class="level2"><h2 class="anchored" data-anchor-id="numerics">Numerics</h2>
<section id="notes-1" class="level3"><h3 class="anchored" data-anchor-id="notes-1">Notes</h3>
<p>Numerical data can be of class <code>integer</code> or <code>numeric</code> (representing real numbers).</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb77-2"><a href="#cb77-2"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="fu">class</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "integer"</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="fl">+1e-9</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb81-2"><a href="#cb81-2"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a><span class="fu">class</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "numeric"</code></pre>
</div>
</div>
<p>The <a href="https://r4ds.hadley.nz/numbers">Numbers</a> chapter in R4DS covers the following functions that are all useful for wrangling numeric data:</p>
<ul>
<li>
<code>n()</code>, <code>n_distinct()</code>: Counting and counting the number of unique values</li>
<li>
<code>sum(is.na())</code>: Counting the number of missing values</li>
<li>
<code><a href="https://rdrr.io/r/base/Extremes.html">min()</a></code>, <code><a href="https://rdrr.io/r/base/Extremes.html">max()</a></code>
</li>
<li>
<code><a href="https://rdrr.io/r/base/Extremes.html">pmin()</a></code>, <code><a href="https://rdrr.io/r/base/Extremes.html">pmax()</a></code>: Get the min and max across several vectors</li>
<li>Integer division: <code>%/%</code>. Remainder: <code>%%</code>
<ul>
<li>
<code>121 %/% 100 = 1</code> and <code>121 %% 100 = 21</code>
</li>
</ul>
</li>
<li>
<code><a href="https://rdrr.io/r/base/Round.html">round()</a></code>, <code><a href="https://rdrr.io/r/base/Round.html">floor()</a></code>, <code><a href="https://rdrr.io/r/base/Round.html">ceiling()</a></code>: Rounding functions (to a specified number of decimal places, to the largest integer below a number, to the smallest integer above a number)</li>
<li>
<code><a href="https://rdrr.io/r/base/cut.html">cut()</a></code>: Cut a numerical vector into categories</li>
<li>
<code><a href="https://rdrr.io/r/base/cumsum.html">cumsum()</a></code>, <code>cummean()</code>, <code><a href="https://rdrr.io/r/base/cumsum.html">cummin()</a></code>, <code><a href="https://rdrr.io/r/base/cumsum.html">cummax()</a></code>: Cumulative functions</li>
<li>
<code><a href="https://rdrr.io/r/base/rank.html">rank()</a></code>: Provide the ranks of the numbers in a vector</li>
<li>
<code>lead(), lag()</code>: shift a vector by padding with NAs</li>
<li>Numerical summaries: <code>mean</code>, <code>median</code>, <code>min</code>, <code>max</code>, <code>quantile</code>, <code>sd</code>, <code>IQR</code>
<ul>
<li>Note that all numerical summary functions have an <code>na.rm</code> argument that should be set to <code>TRUE</code> if you have missing data.</li>
</ul>
</li>
</ul></section><section id="exercises-1" class="level3"><h3 class="anchored" data-anchor-id="exercises-1">Exercises</h3>
<p>Exercises will be on HW4.</p>
<p>The best way to add these functions and operators to your vocabulary is to need to recall them. Refer to the list of functions above as you try the exercises.</p>
<p>You will need to reference function documentation to look at arguments and look in the Examples section.</p>
</section></section><section id="dates" class="level2"><h2 class="anchored" data-anchor-id="dates">Dates</h2>
<section id="notes-2" class="level3"><h3 class="anchored" data-anchor-id="notes-2">Notes</h3>
<p>The <code>lubridate</code> package contains useful functions for working with dates and times. The <code>lubridate</code> <a href="https://lubridate.tidyverse.org/reference/index.html">function reference</a> is a useful resource for finding the functions you need. We’ll take a brief tour of this reference page.</p>
<p>We’ll use the <code>lakers</code> dataset in the <code>lubridate</code> package to illustrate some examples.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a>lakers <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(lakers)</span>
<span id="cb85-2"><a href="#cb85-2"></a><span class="fu">head</span>(lakers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 13
     date opponent game_type time  period etype team  player result points type 
    &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;  &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;int&gt; &lt;chr&gt;
1  2.01e7 POR      home      12:00      1 jump… OFF   ""     ""          0 ""   
2  2.01e7 POR      home      11:39      1 shot  LAL   "Pau … "miss…      0 "hoo…
3  2.01e7 POR      home      11:37      1 rebo… LAL   "Vlad… ""          0 "off"
4  2.01e7 POR      home      11:25      1 shot  LAL   "Dere… "miss…      0 "lay…
5  2.01e7 POR      home      11:23      1 rebo… LAL   "Pau … ""          0 "off"
6  2.01e7 POR      home      11:22      1 shot  LAL   "Pau … "made"      2 "hoo…
# ℹ 2 more variables: x &lt;int&gt;, y &lt;int&gt;</code></pre>
</div>
</div>
<p>Below we use date-time <a href="https://lubridate.tidyverse.org/reference/index.html#date-time-parsing">parsing functions</a> to represent the <code>date</code> and <code>time</code> variables with date-time classes:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a>lakers <span class="ot">&lt;-</span> lakers <span class="sc">|&gt;</span></span>
<span id="cb87-2"><a href="#cb87-2"></a>    <span class="fu">mutate</span>(</span>
<span id="cb87-3"><a href="#cb87-3"></a>        <span class="at">date =</span> <span class="fu">ymd</span>(date),</span>
<span id="cb87-4"><a href="#cb87-4"></a>        <span class="at">time =</span> <span class="fu">ms</span>(time)</span>
<span id="cb87-5"><a href="#cb87-5"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Below we use <a href="https://lubridate.tidyverse.org/reference/index.html#setting-getting-and-rounding">extraction functions</a> to get components of the date-time objects:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a>lakers_clean <span class="ot">&lt;-</span> lakers <span class="sc">|&gt;</span></span>
<span id="cb88-2"><a href="#cb88-2"></a>    <span class="fu">mutate</span>(</span>
<span id="cb88-3"><a href="#cb88-3"></a>        <span class="at">year =</span> <span class="fu">year</span>(date),</span>
<span id="cb88-4"><a href="#cb88-4"></a>        <span class="at">month =</span> <span class="fu">month</span>(date),</span>
<span id="cb88-5"><a href="#cb88-5"></a>        <span class="at">day =</span> <span class="fu">day</span>(date),</span>
<span id="cb88-6"><a href="#cb88-6"></a>        <span class="at">day_of_week =</span> <span class="fu">wday</span>(date, <span class="at">label =</span> <span class="cn">TRUE</span>),</span>
<span id="cb88-7"><a href="#cb88-7"></a>        <span class="at">minute =</span> <span class="fu">minute</span>(time),</span>
<span id="cb88-8"><a href="#cb88-8"></a>        <span class="at">second =</span> <span class="fu">second</span>(time)</span>
<span id="cb88-9"><a href="#cb88-9"></a>    )</span>
<span id="cb88-10"><a href="#cb88-10"></a>lakers_clean <span class="sc">|&gt;</span> <span class="fu">select</span>(year<span class="sc">:</span>second)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 34,624 × 6
    year month   day day_of_week minute second
   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;ord&gt;        &lt;dbl&gt;  &lt;dbl&gt;
 1  2008    10    28 Tue             12      0
 2  2008    10    28 Tue             11     39
 3  2008    10    28 Tue             11     37
 4  2008    10    28 Tue             11     25
 5  2008    10    28 Tue             11     23
 6  2008    10    28 Tue             11     22
 7  2008    10    28 Tue             11     22
 8  2008    10    28 Tue             11     22
 9  2008    10    28 Tue             11      0
10  2008    10    28 Tue             10     53
# ℹ 34,614 more rows</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a>lakers_clean <span class="ot">&lt;-</span> lakers_clean <span class="sc">|&gt;</span></span>
<span id="cb90-2"><a href="#cb90-2"></a>    <span class="fu">group_by</span>(date, opponent, period) <span class="sc">|&gt;</span></span>
<span id="cb90-3"><a href="#cb90-3"></a>    <span class="fu">arrange</span>(date, opponent, period, <span class="fu">desc</span>(time)) <span class="sc">|&gt;</span></span>
<span id="cb90-4"><a href="#cb90-4"></a>    <span class="fu">mutate</span>(</span>
<span id="cb90-5"><a href="#cb90-5"></a>        <span class="at">diff_btw_plays_sec =</span> <span class="fu">as.numeric</span>(time <span class="sc">-</span> <span class="fu">lag</span>(time, <span class="dv">1</span>))</span>
<span id="cb90-6"><a href="#cb90-6"></a>    )</span>
<span id="cb90-7"><a href="#cb90-7"></a>lakers_clean <span class="sc">|&gt;</span> <span class="fu">select</span>(date, opponent, time, period, diff_btw_plays_sec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 34,624 × 5
# Groups:   date, opponent, period [314]
   date       opponent time     period diff_btw_plays_sec
   &lt;date&gt;     &lt;chr&gt;    &lt;Period&gt;  &lt;int&gt;              &lt;dbl&gt;
 1 2008-10-28 POR      12M 0S        1                 NA
 2 2008-10-28 POR      11M 39S       1                -21
 3 2008-10-28 POR      11M 37S       1                 -2
 4 2008-10-28 POR      11M 25S       1                -12
 5 2008-10-28 POR      11M 23S       1                 -2
 6 2008-10-28 POR      11M 22S       1                 -1
 7 2008-10-28 POR      11M 22S       1                  0
 8 2008-10-28 POR      11M 22S       1                  0
 9 2008-10-28 POR      11M 0S        1                -22
10 2008-10-28 POR      10M 53S       1                 -7
# ℹ 34,614 more rows</code></pre>
</div>
</div>
</section><section id="exercises-2" class="level3"><h3 class="anchored" data-anchor-id="exercises-2">Exercises</h3>
<p>Exercises will be on HW4.</p>
</section></section><section id="factors" class="level2"><h2 class="anchored" data-anchor-id="factors">Factors</h2>
<section id="notes-3" class="level3"><h3 class="anchored" data-anchor-id="notes-3">Notes</h3>
<p><strong>Creating factors</strong></p>
<p>In R, factors are made up of two components: the <strong>actual values</strong> of the data and the possible <strong>levels</strong> within the factor. Creating a factor requires supplying both pieces of information.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a>months <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Mar"</span>, <span class="st">"Dec"</span>, <span class="st">"Jan"</span>,  <span class="st">"Apr"</span>, <span class="st">"Jul"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>However, if we were to sort this vector, R would sort this vector alphabetically.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a><span class="co"># alphabetical sort</span></span>
<span id="cb93-2"><a href="#cb93-2"></a><span class="fu">sort</span>(months)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "Apr" "Dec" "Jan" "Jul" "Mar"</code></pre>
</div>
</div>
<p>We can fix this sorting by creating a factor version of <code>months</code>. The <code>levels</code> argument is a character vector that specifies the unique values that the factor can take. The order of the values in <code>levels</code> defines the sorting of the factor.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a>months_fct <span class="ot">&lt;-</span> <span class="fu">factor</span>(months, <span class="at">levels =</span> month.abb) <span class="co"># month.abb is a built-in variable</span></span>
<span id="cb95-2"><a href="#cb95-2"></a>months_fct</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] Mar Dec Jan Apr Jul
Levels: Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb97"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a><span class="fu">sort</span>(months_fct)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] Jan Mar Apr Jul Dec
Levels: Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec</code></pre>
</div>
</div>
<p>What if we try to create a factor with values that aren’t in the levels? (e.g., a typo in a month name)</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb99"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a>months2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Jna"</span>, <span class="st">"Mar"</span>)</span>
<span id="cb99-2"><a href="#cb99-2"></a><span class="fu">factor</span>(months2, <span class="at">levels =</span> month.abb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] &lt;NA&gt; Mar 
Levels: Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec</code></pre>
</div>
</div>
<p>Because the <code>NA</code> is introduced silently (without any error or warnings), this can be dangerous. It might be better to use the <code>fct()</code> function in the <code>forcats</code> package instead:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb101"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a><span class="fu">fct</span>(months2, <span class="at">levels =</span> month.abb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-error">
<pre><code>Error in `fct()`:
! All values of `x` must appear in `levels` or `na`
ℹ Missing level: "Jna"</code></pre>
</div>
</div>
<p><strong>Reordering factors</strong></p>
<p>We’ll use a subset of the General Social Survey (GSS) dataset available in the <code>forcats</code> pacakges.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb103"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a><span class="fu">data</span>(gss_cat)</span>
<span id="cb103-2"><a href="#cb103-2"></a><span class="fu">head</span>(gss_cat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
   year marital         age race  rincome        partyid     relig denom tvhours
  &lt;int&gt; &lt;fct&gt;         &lt;int&gt; &lt;fct&gt; &lt;fct&gt;          &lt;fct&gt;       &lt;fct&gt; &lt;fct&gt;   &lt;int&gt;
1  2000 Never married    26 White $8000 to 9999  Ind,near r… Prot… Sout…      12
2  2000 Divorced         48 White $8000 to 9999  Not str re… Prot… Bapt…      NA
3  2000 Widowed          67 White Not applicable Independent Prot… No d…       2
4  2000 Never married    39 White Not applicable Ind,near r… Orth… Not …       4
5  2000 Divorced         25 White Not applicable Not str de… None  Not …       1
6  2000 Married          25 White $20000 - 24999 Strong dem… Prot… Sout…      NA</code></pre>
</div>
</div>
<p>Reordering the levels of a factor can be useful in plotting when categories would benefit from being sorted in a particular way:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb105"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a>relig_summary <span class="ot">&lt;-</span> gss_cat <span class="sc">|&gt;</span></span>
<span id="cb105-2"><a href="#cb105-2"></a>    <span class="fu">group_by</span>(relig) <span class="sc">|&gt;</span></span>
<span id="cb105-3"><a href="#cb105-3"></a>    <span class="fu">summarize</span>(</span>
<span id="cb105-4"><a href="#cb105-4"></a>        <span class="at">tvhours =</span> <span class="fu">mean</span>(tvhours, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb105-5"><a href="#cb105-5"></a>        <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb105-6"><a href="#cb105-6"></a>    )</span>
<span id="cb105-7"><a href="#cb105-7"></a></span>
<span id="cb105-8"><a href="#cb105-8"></a><span class="fu">ggplot</span>(relig_summary, <span class="fu">aes</span>(<span class="at">x =</span> tvhours, <span class="at">y =</span> relig)) <span class="sc">+</span> </span>
<span id="cb105-9"><a href="#cb105-9"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb105-10"><a href="#cb105-10"></a>    <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="06-wrangling-1-notes_files/figure-html/reorder_factors_motivation-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can use <code>fct_reorder()</code> in <code>forcats</code>.</p>
<ul>
<li>The first argument is the factor that you want to reorder the levels of</li>
<li>The second argument determines how the factor is sorted (analogous to what you put inside <code>arrange()</code> when sorting the rows of a data frame.)</li>
</ul>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb106"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a><span class="fu">ggplot</span>(relig_summary, <span class="fu">aes</span>(<span class="at">x =</span> tvhours, <span class="at">y =</span> <span class="fu">fct_reorder</span>(relig, tvhours))) <span class="sc">+</span></span>
<span id="cb106-2"><a href="#cb106-2"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb106-3"><a href="#cb106-3"></a>    <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="06-wrangling-1-notes_files/figure-html/fct_reorder-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>For bar plots, we can use <code>fct_infreq()</code> to reorder levels from most to least common. This can be combined with <code>fct_rev()</code> to reverse the order (least to most common):</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb107"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a>gss_cat <span class="sc">|&gt;</span></span>
<span id="cb107-2"><a href="#cb107-2"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> marital)) <span class="sc">+</span></span>
<span id="cb107-3"><a href="#cb107-3"></a>    <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb107-4"><a href="#cb107-4"></a>    <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="06-wrangling-1-notes_files/figure-html/fct_infreq_rev-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb108"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1"></a>gss_cat <span class="sc">|&gt;</span></span>
<span id="cb108-2"><a href="#cb108-2"></a>    <span class="fu">mutate</span>(<span class="at">marital =</span> marital <span class="sc">|&gt;</span> <span class="fu">fct_infreq</span>() <span class="sc">|&gt;</span> <span class="fu">fct_rev</span>()) <span class="sc">|&gt;</span></span>
<span id="cb108-3"><a href="#cb108-3"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> marital)) <span class="sc">+</span></span>
<span id="cb108-4"><a href="#cb108-4"></a>    <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb108-5"><a href="#cb108-5"></a>    <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="06-wrangling-1-notes_files/figure-html/fct_infreq_rev-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Modifying factor levels</strong></p>
<p>We talked about reordering the levels of a factor–what about changing the values of the levels themselves?</p>
<p>For example, the names of the political parties in the GSS could use elaboration (“str” isn’t a great label for “strong”) and clean up:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb109"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a>gss_cat <span class="sc">|&gt;</span> <span class="fu">count</span>(partyid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   partyid                n
   &lt;fct&gt;              &lt;int&gt;
 1 No answer            154
 2 Don't know             1
 3 Other party          393
 4 Strong republican   2314
 5 Not str republican  3032
 6 Ind,near rep        1791
 7 Independent         4119
 8 Ind,near dem        2499
 9 Not str democrat    3690
10 Strong democrat     3490</code></pre>
</div>
</div>
<p>We can use <code>fct_recode()</code> on <code>partyid</code> with the new level names going on the left and the old levels on the right. Any levels that aren’t mentioned explicitly (i.e., “Don’t know” and “Other party”) will be left as is:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb111"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a>gss_cat <span class="sc">|&gt;</span></span>
<span id="cb111-2"><a href="#cb111-2"></a>    <span class="fu">mutate</span>(</span>
<span id="cb111-3"><a href="#cb111-3"></a>        <span class="at">partyid =</span> <span class="fu">fct_recode</span>(partyid,</span>
<span id="cb111-4"><a href="#cb111-4"></a>            <span class="st">"Republican, strong"</span>    <span class="ot">=</span> <span class="st">"Strong republican"</span>,</span>
<span id="cb111-5"><a href="#cb111-5"></a>            <span class="st">"Republican, weak"</span>      <span class="ot">=</span> <span class="st">"Not str republican"</span>,</span>
<span id="cb111-6"><a href="#cb111-6"></a>            <span class="st">"Independent, near rep"</span> <span class="ot">=</span> <span class="st">"Ind,near rep"</span>,</span>
<span id="cb111-7"><a href="#cb111-7"></a>            <span class="st">"Independent, near dem"</span> <span class="ot">=</span> <span class="st">"Ind,near dem"</span>,</span>
<span id="cb111-8"><a href="#cb111-8"></a>            <span class="st">"Democrat, weak"</span>        <span class="ot">=</span> <span class="st">"Not str democrat"</span>,</span>
<span id="cb111-9"><a href="#cb111-9"></a>            <span class="st">"Democrat, strong"</span>      <span class="ot">=</span> <span class="st">"Strong democrat"</span></span>
<span id="cb111-10"><a href="#cb111-10"></a>        )</span>
<span id="cb111-11"><a href="#cb111-11"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb111-12"><a href="#cb111-12"></a>    <span class="fu">count</span>(partyid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   partyid                   n
   &lt;fct&gt;                 &lt;int&gt;
 1 No answer               154
 2 Don't know                1
 3 Other party             393
 4 Republican, strong     2314
 5 Republican, weak       3032
 6 Independent, near rep  1791
 7 Independent            4119
 8 Independent, near dem  2499
 9 Democrat, weak         3690
10 Democrat, strong       3490</code></pre>
</div>
</div>
<p>To combine groups, we can assign multiple old levels to the same new level (“Other” maps to “No answer”, “Don’t know”, and “Other party”):</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb113"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1"></a>gss_cat <span class="sc">|&gt;</span></span>
<span id="cb113-2"><a href="#cb113-2"></a>    <span class="fu">mutate</span>(</span>
<span id="cb113-3"><a href="#cb113-3"></a>        <span class="at">partyid =</span> <span class="fu">fct_recode</span>(partyid,</span>
<span id="cb113-4"><a href="#cb113-4"></a>            <span class="st">"Republican, strong"</span>    <span class="ot">=</span> <span class="st">"Strong republican"</span>,</span>
<span id="cb113-5"><a href="#cb113-5"></a>            <span class="st">"Republican, weak"</span>      <span class="ot">=</span> <span class="st">"Not str republican"</span>,</span>
<span id="cb113-6"><a href="#cb113-6"></a>            <span class="st">"Independent, near rep"</span> <span class="ot">=</span> <span class="st">"Ind,near rep"</span>,</span>
<span id="cb113-7"><a href="#cb113-7"></a>            <span class="st">"Independent, near dem"</span> <span class="ot">=</span> <span class="st">"Ind,near dem"</span>,</span>
<span id="cb113-8"><a href="#cb113-8"></a>            <span class="st">"Democrat, weak"</span>        <span class="ot">=</span> <span class="st">"Not str democrat"</span>,</span>
<span id="cb113-9"><a href="#cb113-9"></a>            <span class="st">"Democrat, strong"</span>      <span class="ot">=</span> <span class="st">"Strong democrat"</span>,</span>
<span id="cb113-10"><a href="#cb113-10"></a>            <span class="st">"Other"</span>                 <span class="ot">=</span> <span class="st">"No answer"</span>,</span>
<span id="cb113-11"><a href="#cb113-11"></a>            <span class="st">"Other"</span>                 <span class="ot">=</span> <span class="st">"Don't know"</span>,</span>
<span id="cb113-12"><a href="#cb113-12"></a>            <span class="st">"Other"</span>                 <span class="ot">=</span> <span class="st">"Other party"</span></span>
<span id="cb113-13"><a href="#cb113-13"></a>        )</span>
<span id="cb113-14"><a href="#cb113-14"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 21,483 × 9
    year marital         age race  rincome        partyid    relig denom tvhours
   &lt;int&gt; &lt;fct&gt;         &lt;int&gt; &lt;fct&gt; &lt;fct&gt;          &lt;fct&gt;      &lt;fct&gt; &lt;fct&gt;   &lt;int&gt;
 1  2000 Never married    26 White $8000 to 9999  Independe… Prot… Sout…      12
 2  2000 Divorced         48 White $8000 to 9999  Republica… Prot… Bapt…      NA
 3  2000 Widowed          67 White Not applicable Independe… Prot… No d…       2
 4  2000 Never married    39 White Not applicable Independe… Orth… Not …       4
 5  2000 Divorced         25 White Not applicable Democrat,… None  Not …       1
 6  2000 Married          25 White $20000 - 24999 Democrat,… Prot… Sout…      NA
 7  2000 Never married    36 White $25000 or more Republica… Chri… Not …       3
 8  2000 Divorced         44 White $7000 to 7999  Independe… Prot… Luth…      NA
 9  2000 Married          44 White $25000 or more Democrat,… Prot… Other       0
10  2000 Married          47 White $25000 or more Republica… Prot… Sout…       3
# ℹ 21,473 more rows</code></pre>
</div>
</div>
<p>We can use <code>fct_collapse()</code> to collapse many levels:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb115"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a>gss_cat <span class="sc">|&gt;</span></span>
<span id="cb115-2"><a href="#cb115-2"></a>    <span class="fu">mutate</span>(</span>
<span id="cb115-3"><a href="#cb115-3"></a>        <span class="at">partyid =</span> <span class="fu">fct_collapse</span>(partyid,</span>
<span id="cb115-4"><a href="#cb115-4"></a>            <span class="st">"Other"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"No answer"</span>, <span class="st">"Don't know"</span>, <span class="st">"Other party"</span>),</span>
<span id="cb115-5"><a href="#cb115-5"></a>            <span class="st">"Republican"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Strong republican"</span>, <span class="st">"Not str republican"</span>),</span>
<span id="cb115-6"><a href="#cb115-6"></a>            <span class="st">"Independent"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Ind,near rep"</span>, <span class="st">"Independent"</span>, <span class="st">"Ind,near dem"</span>),</span>
<span id="cb115-7"><a href="#cb115-7"></a>            <span class="st">"Democrat"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Not str democrat"</span>, <span class="st">"Strong democrat"</span>)</span>
<span id="cb115-8"><a href="#cb115-8"></a>        )</span>
<span id="cb115-9"><a href="#cb115-9"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb115-10"><a href="#cb115-10"></a>    <span class="fu">count</span>(partyid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  partyid         n
  &lt;fct&gt;       &lt;int&gt;
1 Other         548
2 Republican   5346
3 Independent  8409
4 Democrat     7180</code></pre>
</div>
</div>
</section><section id="exercises-3" class="level3"><h3 class="anchored" data-anchor-id="exercises-3">Exercises</h3>
<ol type="1">
<li>Create a factor version of the following data with the levels in a sensible order.</li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb117"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1"></a>ratings <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"High"</span>, <span class="st">"Medium"</span>, <span class="st">"Low"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>More exercises will be on HW4.</p>
</section></section><section id="done" class="level2"><h2 class="anchored" data-anchor-id="done">Done!</h2>
<ul>
<li>Check the ICA Instructions for how to (a) push your code to GitHub and (b) update your portfolio website</li>
</ul>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation column-body"><div class="nav-page nav-page-previous">
      <a href="../../src/ica/04-adv-maps-1-notes.html" class="pagination-link" aria-label="4 Advanced Spatial Viz P1">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">4 Advanced Spatial Viz P1</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../src/ica/07-wrangling-2-notes.html" class="pagination-link" aria-label="7 Adv Data wrangling P2">
        <span class="nav-page-text"><span class="chapter-title">7 Adv Data wrangling P2</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb118" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb118-1"><a href="#cb118-1"></a><span class="co">---</span></span>
<span id="cb118-2"><a href="#cb118-2"></a><span class="an">title:</span><span class="co"> "6 Adv Data wrangling P1"</span></span>
<span id="cb118-3"><a href="#cb118-3"></a><span class="co">---</span></span>
<span id="cb118-4"><a href="#cb118-4"></a></span>
<span id="cb118-5"><a href="#cb118-5"></a></span>
<span id="cb118-6"><a href="#cb118-6"></a><span class="fu">## 🧩 Learning Goals</span></span>
<span id="cb118-7"><a href="#cb118-7"></a></span>
<span id="cb118-8"><a href="#cb118-8"></a>By the end of this lesson, you should be able to:</span>
<span id="cb118-9"><a href="#cb118-9"></a></span>
<span id="cb118-10"><a href="#cb118-10"></a><span class="ss">- </span>Determine the class of a given object and identify concerns to be wary of when manipulating an object of that class (numerics, logicals, factors, dates, strings, data.frames)</span>
<span id="cb118-11"><a href="#cb118-11"></a><span class="ss">- </span>Explain what vector recycling is, when it can be a problem, and how to avoid those problems</span>
<span id="cb118-12"><a href="#cb118-12"></a><span class="ss">- </span>Use a variety of functions to wrangle numerical and logical data</span>
<span id="cb118-13"><a href="#cb118-13"></a><span class="ss">- </span>Extract date-time information using the <span class="in">`lubridate`</span> package</span>
<span id="cb118-14"><a href="#cb118-14"></a><span class="ss">- </span>Use the <span class="in">`forcats`</span> package to wrangle factor data</span>
<span id="cb118-15"><a href="#cb118-15"></a></span>
<span id="cb118-16"><a href="#cb118-16"></a></span>
<span id="cb118-17"><a href="#cb118-17"></a></span>
<span id="cb118-18"><a href="#cb118-18"></a><span class="fu">## Helpful Cheatsheets </span></span>
<span id="cb118-19"><a href="#cb118-19"></a></span>
<span id="cb118-20"><a href="#cb118-20"></a>RStudio (Posit) maintains a collection of wonderful <span class="co">[</span><span class="ot">cheatsheets</span><span class="co">](https://rstudio.github.io/cheatsheets/html/data-transformation.html)</span>. The following will be helpful:</span>
<span id="cb118-21"><a href="#cb118-21"></a></span>
<span id="cb118-22"><a href="#cb118-22"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Data transformation with `dplyr`</span><span class="co">](https://rstudio.github.io/cheatsheets/html/data-transformation.html)</span></span>
<span id="cb118-23"><a href="#cb118-23"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Dates and times with `lubridate`</span><span class="co">](https://rstudio.github.io/cheatsheets/html/lubridate.html)</span></span>
<span id="cb118-24"><a href="#cb118-24"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Factors with `forcats`</span><span class="co">](https://rstudio.github.io/cheatsheets/html/factors.html)</span></span>
<span id="cb118-25"><a href="#cb118-25"></a></span>
<span id="cb118-26"><a href="#cb118-26"></a>**Data Wrangling Verbs (from Stat/Comp 112)**</span>
<span id="cb118-27"><a href="#cb118-27"></a></span>
<span id="cb118-28"><a href="#cb118-28"></a><span class="ss">- </span><span class="in">`mutate()`</span>: creates/changes columns/elements in a data frame/tibble</span>
<span id="cb118-29"><a href="#cb118-29"></a><span class="ss">- </span><span class="in">`select()`</span>: keeps subset of columns/elements in a data frame/tibble</span>
<span id="cb118-30"><a href="#cb118-30"></a><span class="ss">- </span><span class="in">`filter()`</span>: keeps subsets of rows in a data frame/tibble</span>
<span id="cb118-31"><a href="#cb118-31"></a><span class="ss">- </span><span class="in">`arrange()`</span>: sorts rows in a data frame/tibble</span>
<span id="cb118-32"><a href="#cb118-32"></a><span class="ss">- </span><span class="in">`group_by()`</span>: internally groups rows in data frame/tibble by values in 1 or more columsn/elements</span>
<span id="cb118-33"><a href="#cb118-33"></a><span class="ss">- </span><span class="in">`summarize()`</span>: collapses/combines information across rows using functions such as <span class="in">`n()`</span>, <span class="in">`sum()`</span>, <span class="in">`mean()`</span>, <span class="in">`min()`</span>, <span class="in">`max()`</span>, <span class="in">`median()`</span>, <span class="in">`sd()`</span></span>
<span id="cb118-34"><a href="#cb118-34"></a><span class="ss">- </span><span class="in">`count()`</span>: shortcut for <span class="in">`group_by() |&gt; summarize(n = n())`</span></span>
<span id="cb118-35"><a href="#cb118-35"></a><span class="ss">- </span><span class="in">`left_join()`</span>: mutating join of two data frames/tibbles keeping all rows in left data frame</span>
<span id="cb118-36"><a href="#cb118-36"></a><span class="ss">- </span><span class="in">`full_join()`</span>: mutating join of two data frames/tibbles keeping all rows in both data frames</span>
<span id="cb118-37"><a href="#cb118-37"></a><span class="ss">- </span><span class="in">`inner_join()`</span>: mutating join of two data frames/tibbles keeping rows in left data frame that find match in right</span>
<span id="cb118-38"><a href="#cb118-38"></a><span class="ss">- </span><span class="in">`semi_join()`</span>: filtering join of two data frames/tibbles keeping rows in left data frame that find match in right</span>
<span id="cb118-39"><a href="#cb118-39"></a><span class="ss">- </span><span class="in">`anti_join()`</span>: filtering join of two data frames/tibbles keeping rows in left data frame that do not find match in right</span>
<span id="cb118-40"><a href="#cb118-40"></a><span class="ss">- </span><span class="in">`pivot_wider()`</span>: rearrange values from two columns to many(one column becomes the names of new variables, one column becomes the values of the new variables)</span>
<span id="cb118-41"><a href="#cb118-41"></a><span class="ss">- </span><span class="in">`pivot_longer()`</span>: rearrange values from many columns to two (the names of the columns go to one new variable, the values of the columns go to a second new variable)</span>
<span id="cb118-42"><a href="#cb118-42"></a></span>
<span id="cb118-43"><a href="#cb118-43"></a></span>
<span id="cb118-44"><a href="#cb118-44"></a><span class="in">```{r doc_setup}</span></span>
<span id="cb118-45"><a href="#cb118-45"></a><span class="co">#| include: false</span></span>
<span id="cb118-46"><a href="#cb118-46"></a></span>
<span id="cb118-47"><a href="#cb118-47"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb118-48"><a href="#cb118-48"></a><span class="in">```</span></span>
<span id="cb118-49"><a href="#cb118-49"></a></span>
<span id="cb118-50"><a href="#cb118-50"></a></span>
<span id="cb118-51"><a href="#cb118-51"></a><span class="fu">## Vectors </span></span>
<span id="cb118-52"><a href="#cb118-52"></a></span>
<span id="cb118-53"><a href="#cb118-53"></a>An **atomic vector** is a storage container in R where all elements in the container are of the same type. The types that are relevant to data science are:</span>
<span id="cb118-54"><a href="#cb118-54"></a></span>
<span id="cb118-55"><a href="#cb118-55"></a><span class="ss">- </span><span class="in">`logical`</span> (also known as boolean)</span>
<span id="cb118-56"><a href="#cb118-56"></a><span class="ss">- </span>numbers</span>
<span id="cb118-57"><a href="#cb118-57"></a><span class="ss">  - </span><span class="in">`integer`</span></span>
<span id="cb118-58"><a href="#cb118-58"></a><span class="ss">  - </span><span class="in">`numeric`</span> floating point (also known as double)</span>
<span id="cb118-59"><a href="#cb118-59"></a><span class="ss">- </span><span class="in">`character`</span> string </span>
<span id="cb118-60"><a href="#cb118-60"></a><span class="ss">- </span><span class="in">`Date`</span> and date-time (saved as <span class="in">`POSIXct`</span>)</span>
<span id="cb118-61"><a href="#cb118-61"></a><span class="ss">- </span><span class="in">`factor`</span></span>
<span id="cb118-62"><a href="#cb118-62"></a></span>
<span id="cb118-63"><a href="#cb118-63"></a></span>
<span id="cb118-64"><a href="#cb118-64"></a>Function documentation will refer to vectors frequently. </span>
<span id="cb118-65"><a href="#cb118-65"></a></span>
<span id="cb118-66"><a href="#cb118-66"></a>See examples below:</span>
<span id="cb118-67"><a href="#cb118-67"></a></span>
<span id="cb118-68"><a href="#cb118-68"></a><span class="ss">- </span><span class="in">`ggplot2::scale_x_continuous()`</span></span>
<span id="cb118-69"><a href="#cb118-69"></a><span class="ss">    - </span><span class="in">`breaks`</span>: A **numeric vector** of positions</span>
<span id="cb118-70"><a href="#cb118-70"></a><span class="ss">    - </span><span class="in">`labels`</span>: A **character vector** giving labels (must be same length as breaks)</span>
<span id="cb118-71"><a href="#cb118-71"></a><span class="ss">- </span><span class="in">`shiny::sliderInput()`</span></span>
<span id="cb118-72"><a href="#cb118-72"></a><span class="ss">    - </span><span class="in">`value`</span>: The initial value of the slider <span class="co">[</span><span class="ot">...</span><span class="co">]</span> A **length one vector** will create a regular slider; a **length two vector** will create a double-ended range slider.</span>
<span id="cb118-73"><a href="#cb118-73"></a></span>
<span id="cb118-74"><a href="#cb118-74"></a></span>
<span id="cb118-75"><a href="#cb118-75"></a></span>
<span id="cb118-76"><a href="#cb118-76"></a>When you need a vector, you can create one manually using</span>
<span id="cb118-77"><a href="#cb118-77"></a></span>
<span id="cb118-78"><a href="#cb118-78"></a><span class="ss">- </span><span class="in">`c()`</span>: the combine function</span>
<span id="cb118-79"><a href="#cb118-79"></a></span>
<span id="cb118-80"><a href="#cb118-80"></a>Or you can create one based on available data using</span>
<span id="cb118-81"><a href="#cb118-81"></a></span>
<span id="cb118-82"><a href="#cb118-82"></a><span class="ss">- </span><span class="in">`dataset |&gt; mutate(newvar = variable &gt; 5) |&gt; pull(newvar)`</span>: taking one column out of a dataset</span>
<span id="cb118-83"><a href="#cb118-83"></a><span class="ss">- </span><span class="in">`dataset |&gt; pull(variable) |&gt; unique()`</span>: taking one column out of a dataset and finding unique values</span>
<span id="cb118-84"><a href="#cb118-84"></a></span>
<span id="cb118-85"><a href="#cb118-85"></a><span class="in">```{r create_vec_examples}</span></span>
<span id="cb118-86"><a href="#cb118-86"></a><span class="fu">c</span>(<span class="st">"Fair"</span>, <span class="st">"Good"</span>, <span class="st">"Very Good"</span>, <span class="st">"Premium"</span>, <span class="st">"Ideal"</span>)</span>
<span id="cb118-87"><a href="#cb118-87"></a></span>
<span id="cb118-88"><a href="#cb118-88"></a>diamonds <span class="sc">|&gt;</span> <span class="fu">pull</span>(cut) <span class="sc">|&gt;</span> <span class="fu">unique</span>()</span>
<span id="cb118-89"><a href="#cb118-89"></a><span class="in">```</span></span>
<span id="cb118-90"><a href="#cb118-90"></a></span>
<span id="cb118-91"><a href="#cb118-91"></a></span>
<span id="cb118-92"><a href="#cb118-92"></a></span>
<span id="cb118-93"><a href="#cb118-93"></a><span class="fu">## Logicals </span></span>
<span id="cb118-94"><a href="#cb118-94"></a></span>
<span id="cb118-95"><a href="#cb118-95"></a></span>
<span id="cb118-96"><a href="#cb118-96"></a><span class="fu">### Notes </span></span>
<span id="cb118-97"><a href="#cb118-97"></a></span>
<span id="cb118-98"><a href="#cb118-98"></a>What does a logical vector look like?</span>
<span id="cb118-99"><a href="#cb118-99"></a></span>
<span id="cb118-100"><a href="#cb118-100"></a><span class="in">```{r logicals}</span></span>
<span id="cb118-101"><a href="#cb118-101"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">NA</span>)</span>
<span id="cb118-102"><a href="#cb118-102"></a>x</span>
<span id="cb118-103"><a href="#cb118-103"></a><span class="fu">class</span>(x)</span>
<span id="cb118-104"><a href="#cb118-104"></a><span class="in">```</span></span>
<span id="cb118-105"><a href="#cb118-105"></a></span>
<span id="cb118-106"><a href="#cb118-106"></a></span>
<span id="cb118-107"><a href="#cb118-107"></a>You will often create logical vectors with comparison operators: <span class="in">`&gt;`</span>, <span class="in">`&lt;`</span>, <span class="in">`&lt;=`</span>, <span class="in">`&gt;=`</span>, <span class="in">`==`</span>, <span class="in">`!=`</span>.</span>
<span id="cb118-108"><a href="#cb118-108"></a></span>
<span id="cb118-109"><a href="#cb118-109"></a><span class="in">```{r comparison_operators}</span></span>
<span id="cb118-110"><a href="#cb118-110"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">9</span>, <span class="dv">12</span>)</span>
<span id="cb118-111"><a href="#cb118-111"></a>x <span class="sc">&lt;</span> <span class="dv">2</span></span>
<span id="cb118-112"><a href="#cb118-112"></a>x <span class="sc">&lt;=</span> <span class="dv">2</span></span>
<span id="cb118-113"><a href="#cb118-113"></a>x <span class="sc">&gt;</span> <span class="dv">9</span></span>
<span id="cb118-114"><a href="#cb118-114"></a>x <span class="sc">&gt;=</span> <span class="dv">9</span></span>
<span id="cb118-115"><a href="#cb118-115"></a>x <span class="sc">==</span> <span class="dv">12</span></span>
<span id="cb118-116"><a href="#cb118-116"></a>x <span class="sc">!=</span> <span class="dv">12</span></span>
<span id="cb118-117"><a href="#cb118-117"></a><span class="in">```</span></span>
<span id="cb118-118"><a href="#cb118-118"></a></span>
<span id="cb118-119"><a href="#cb118-119"></a></span>
<span id="cb118-120"><a href="#cb118-120"></a>When you want to check for set containment, the <span class="in">`%in%`</span> operator is the correct way to do this (as opposed to <span class="in">`==`</span>).</span>
<span id="cb118-121"><a href="#cb118-121"></a></span>
<span id="cb118-122"><a href="#cb118-122"></a><span class="in">```{r in_operator}</span></span>
<span id="cb118-123"><a href="#cb118-123"></a><span class="co">#| warning: true</span></span>
<span id="cb118-124"><a href="#cb118-124"></a></span>
<span id="cb118-125"><a href="#cb118-125"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">9</span>, <span class="dv">4</span>)</span>
<span id="cb118-126"><a href="#cb118-126"></a>x <span class="sc">==</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>)</span>
<span id="cb118-127"><a href="#cb118-127"></a>x <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>)</span>
<span id="cb118-128"><a href="#cb118-128"></a><span class="in">```</span></span>
<span id="cb118-129"><a href="#cb118-129"></a></span>
<span id="cb118-130"><a href="#cb118-130"></a></span>
<span id="cb118-131"><a href="#cb118-131"></a>The <span class="in">`Warning: longer object length is not a multiple of shorter object length`</span> is a manifestation of **vector recycling**. </span>
<span id="cb118-132"><a href="#cb118-132"></a></span>
<span id="cb118-133"><a href="#cb118-133"></a>In R, if two vectors are being combined or compared, the shorter one will be repeated to match the length of the longer one--even if longer object length isn't a multiple of the shorter object length. We can see the exact recycling that happens below:</span>
<span id="cb118-134"><a href="#cb118-134"></a></span>
<span id="cb118-135"><a href="#cb118-135"></a><span class="in">```{r recycling}</span></span>
<span id="cb118-136"><a href="#cb118-136"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">9</span>, <span class="dv">4</span>)</span>
<span id="cb118-137"><a href="#cb118-137"></a>x <span class="sc">==</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>)</span>
<span id="cb118-138"><a href="#cb118-138"></a>x <span class="sc">==</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">1</span>) <span class="co"># This line demonstrates the recycling that happens on the previous line</span></span>
<span id="cb118-139"><a href="#cb118-139"></a><span class="in">```</span></span>
<span id="cb118-140"><a href="#cb118-140"></a></span>
<span id="cb118-141"><a href="#cb118-141"></a></span>
<span id="cb118-142"><a href="#cb118-142"></a>Logical vectors can also be created with functions. <span class="in">`is.na()`</span> is one useful example:</span>
<span id="cb118-143"><a href="#cb118-143"></a></span>
<span id="cb118-144"><a href="#cb118-144"></a><span class="in">```{r is_na}</span></span>
<span id="cb118-145"><a href="#cb118-145"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">9</span>, <span class="cn">NA</span>)</span>
<span id="cb118-146"><a href="#cb118-146"></a>x <span class="sc">==</span> <span class="cn">NA</span></span>
<span id="cb118-147"><a href="#cb118-147"></a><span class="fu">is.na</span>(x)</span>
<span id="cb118-148"><a href="#cb118-148"></a><span class="in">```</span></span>
<span id="cb118-149"><a href="#cb118-149"></a></span>
<span id="cb118-150"><a href="#cb118-150"></a></span>
<span id="cb118-151"><a href="#cb118-151"></a>We can negate a logical object with <span class="in">`!`</span>. We can combine logical objects with <span class="in">`&amp;`</span> (and) and  <span class="in">`|`</span> (or).</span>
<span id="cb118-152"><a href="#cb118-152"></a></span>
<span id="cb118-153"><a href="#cb118-153"></a><span class="in">```{r negate_and_or}</span></span>
<span id="cb118-154"><a href="#cb118-154"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">9</span>)</span>
<span id="cb118-155"><a href="#cb118-155"></a>x <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> x <span class="sc">&lt;</span> <span class="dv">5</span></span>
<span id="cb118-156"><a href="#cb118-156"></a><span class="sc">!</span>(x <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> x <span class="sc">&lt;</span> <span class="dv">5</span>)</span>
<span id="cb118-157"><a href="#cb118-157"></a>x <span class="sc">&lt;</span> <span class="dv">2</span> <span class="sc">|</span> x <span class="sc">&gt;</span> <span class="dv">8</span></span>
<span id="cb118-158"><a href="#cb118-158"></a><span class="in">```</span></span>
<span id="cb118-159"><a href="#cb118-159"></a></span>
<span id="cb118-160"><a href="#cb118-160"></a></span>
<span id="cb118-161"><a href="#cb118-161"></a>We can summarize logical vectors with:</span>
<span id="cb118-162"><a href="#cb118-162"></a></span>
<span id="cb118-163"><a href="#cb118-163"></a><span class="ss">- </span><span class="in">`any()`</span>: Are ANY of the values <span class="in">`TRUE`</span>?</span>
<span id="cb118-164"><a href="#cb118-164"></a><span class="ss">- </span><span class="in">`all()`</span>: Are ALL of the values <span class="in">`TRUE`</span>?</span>
<span id="cb118-165"><a href="#cb118-165"></a><span class="ss">- </span><span class="in">`sum()`</span>: How many of the values are <span class="in">`TRUE`</span>?</span>
<span id="cb118-166"><a href="#cb118-166"></a><span class="ss">- </span><span class="in">`mean()`</span>: What fraction of the values are <span class="in">`TRUE`</span>?</span>
<span id="cb118-167"><a href="#cb118-167"></a></span>
<span id="cb118-168"><a href="#cb118-168"></a><span class="in">```{r summarize_logical}</span></span>
<span id="cb118-169"><a href="#cb118-169"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">9</span>)</span>
<span id="cb118-170"><a href="#cb118-170"></a><span class="fu">any</span>(x <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb118-171"><a href="#cb118-171"></a><span class="fu">all</span>(x <span class="sc">&lt;</span> <span class="dv">10</span>)</span>
<span id="cb118-172"><a href="#cb118-172"></a><span class="fu">sum</span>(x <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb118-173"><a href="#cb118-173"></a><span class="fu">mean</span>(x <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb118-174"><a href="#cb118-174"></a><span class="in">```</span></span>
<span id="cb118-175"><a href="#cb118-175"></a></span>
<span id="cb118-176"><a href="#cb118-176"></a><span class="in">`if_else()`</span> and <span class="in">`case_when()`</span> are functions that allow you to return values depending on the value of a logical vector. You'll explore the documentation for these in the following exercises.</span>
<span id="cb118-177"><a href="#cb118-177"></a></span>
<span id="cb118-178"><a href="#cb118-178"></a></span>
<span id="cb118-179"><a href="#cb118-179"></a>::: {.callout-tip appearance='simple' icon=false}</span>
<span id="cb118-180"><a href="#cb118-180"></a>Note: <span class="in">`ifelse()`</span> (from base R) and <span class="in">`if_else()`</span> (from tidyverse) are different functions. We prefer <span class="in">`if_else()`</span> for many reasons (examples below).</span>
<span id="cb118-181"><a href="#cb118-181"></a></span>
<span id="cb118-182"><a href="#cb118-182"></a><span class="ss">- </span>Noisy to make sure you catch issues/bugs</span>
<span id="cb118-183"><a href="#cb118-183"></a><span class="ss">- </span>Can explicitly handle missing values</span>
<span id="cb118-184"><a href="#cb118-184"></a><span class="ss">- </span>Keeps dates as dates</span>
<span id="cb118-185"><a href="#cb118-185"></a></span>
<span id="cb118-186"><a href="#cb118-186"></a><span class="dt">&lt;</span><span class="kw">details</span><span class="dt">&gt;</span></span>
<span id="cb118-187"><a href="#cb118-187"></a><span class="dt">&lt;</span><span class="kw">summary</span><span class="dt">&gt;</span>Examples<span class="dt">&lt;/</span><span class="kw">summary</span><span class="dt">&gt;</span></span>
<span id="cb118-190"><a href="#cb118-190"></a><span class="in">```{r}</span></span>
<span id="cb118-191"><a href="#cb118-191"></a><span class="co">#| error: true</span></span>
<span id="cb118-192"><a href="#cb118-192"></a></span>
<span id="cb118-193"><a href="#cb118-193"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">9</span>, <span class="cn">NA</span>)</span>
<span id="cb118-194"><a href="#cb118-194"></a></span>
<span id="cb118-195"><a href="#cb118-195"></a><span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">'positive'</span>, <span class="st">'negative'</span>)</span>
<span id="cb118-196"><a href="#cb118-196"></a><span class="fu">if_else</span>(x <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">'positive'</span>, <span class="st">'negative'</span>)</span>
<span id="cb118-197"><a href="#cb118-197"></a></span>
<span id="cb118-198"><a href="#cb118-198"></a></span>
<span id="cb118-199"><a href="#cb118-199"></a><span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="st">'negative'</span>) <span class="co"># Bad: doesn't complain with combo of data types</span></span>
<span id="cb118-200"><a href="#cb118-200"></a><span class="fu">if_else</span>(x <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="st">'negative'</span>) <span class="co"># Good:noisy to make sure you catch issues</span></span>
<span id="cb118-201"><a href="#cb118-201"></a></span>
<span id="cb118-202"><a href="#cb118-202"></a><span class="fu">if_else</span>(x <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">'positive'</span>, <span class="st">'negative'</span>, <span class="at">missing =</span> <span class="st">'missing'</span>) <span class="co"># Good: can explicitly handle NA</span></span>
<span id="cb118-203"><a href="#cb118-203"></a></span>
<span id="cb118-204"><a href="#cb118-204"></a>fun_dates <span class="ot">&lt;-</span> <span class="fu">mdy</span>(<span class="st">'1-1-2025'</span>) <span class="sc">+</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">365</span></span>
<span id="cb118-205"><a href="#cb118-205"></a><span class="fu">ifelse</span>(fun_dates <span class="sc">&lt;</span> <span class="fu">today</span>(), fun_dates <span class="sc">+</span> <span class="fu">years</span>(), fun_dates) <span class="co"># Bad: converts dates to integers</span></span>
<span id="cb118-206"><a href="#cb118-206"></a><span class="fu">if_else</span>(fun_dates <span class="sc">&lt;</span> <span class="fu">today</span>(), fun_dates <span class="sc">+</span> <span class="fu">years</span>(), fun_dates) <span class="co"># Good: keeps dates as dates</span></span>
<span id="cb118-207"><a href="#cb118-207"></a><span class="in">```</span></span>
<span id="cb118-208"><a href="#cb118-208"></a><span class="dt">&lt;/</span><span class="kw">details</span><span class="dt">&gt;</span></span>
<span id="cb118-209"><a href="#cb118-209"></a>:::</span>
<span id="cb118-210"><a href="#cb118-210"></a></span>
<span id="cb118-211"><a href="#cb118-211"></a><span class="fu">### Exercises </span></span>
<span id="cb118-212"><a href="#cb118-212"></a></span>
<span id="cb118-213"><a href="#cb118-213"></a>Load the diamonds dataset, and filter to the first 1000 diamonds.</span>
<span id="cb118-214"><a href="#cb118-214"></a></span>
<span id="cb118-215"><a href="#cb118-215"></a><span class="in">```{r diamonds_prep}</span></span>
<span id="cb118-216"><a href="#cb118-216"></a><span class="fu">data</span>(diamonds)</span>
<span id="cb118-217"><a href="#cb118-217"></a>diamonds <span class="ot">&lt;-</span> diamonds <span class="sc">|&gt;</span> </span>
<span id="cb118-218"><a href="#cb118-218"></a>    <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">1000</span>)</span>
<span id="cb118-219"><a href="#cb118-219"></a><span class="in">```</span></span>
<span id="cb118-220"><a href="#cb118-220"></a></span>
<span id="cb118-221"><a href="#cb118-221"></a>Using <span class="in">`tidyverse`</span> functions, complete the following:</span>
<span id="cb118-222"><a href="#cb118-222"></a></span>
<span id="cb118-223"><a href="#cb118-223"></a><span class="ss">1. </span>Subset to diamonds that are less than 400 dollars or more than 10000 dollars.</span>
<span id="cb118-224"><a href="#cb118-224"></a><span class="ss">2. </span>Subset to diamonds that are between 500 and 600 dollars (inclusive).</span>
<span id="cb118-225"><a href="#cb118-225"></a><span class="ss">3. </span>How many diamonds are of either Fair, Premium, or Ideal cut (a total count)? What fraction of diamonds are of Fair, Premium, or Ideal cut?</span>
<span id="cb118-226"><a href="#cb118-226"></a><span class="ss">    - </span>First, do this a wrong way with <span class="in">`==`</span>. Predict the warning message that you will receive.</span>
<span id="cb118-227"><a href="#cb118-227"></a><span class="ss">    - </span>Second, do this the correct way with an appropriate logical operator.</span>
<span id="cb118-228"><a href="#cb118-228"></a><span class="ss">4. </span>Are there any diamonds of Fair cut that are more than \$3000? Are all diamonds of Ideal cut more than \$2000?</span>
<span id="cb118-229"><a href="#cb118-229"></a><span class="ss">5. </span>Create two new categorized versions of <span class="in">`price`</span> by looking up the documentation for <span class="in">`if_else()`</span> and <span class="in">`case_when()`</span>:</span>
<span id="cb118-230"><a href="#cb118-230"></a><span class="ss">    - </span><span class="in">`price_cat1`</span>: "low" if price is less than 500 and "high" otherwise</span>
<span id="cb118-231"><a href="#cb118-231"></a><span class="ss">    - </span><span class="in">`price_cat2`</span>: "low" if price is less than 500, "medium" if price is between 500 and 1000 dollars inclusive, and "high" otherwise.</span>
<span id="cb118-232"><a href="#cb118-232"></a></span>
<span id="cb118-233"><a href="#cb118-233"></a></span>
<span id="cb118-234"><a href="#cb118-234"></a></span>
<span id="cb118-237"><a href="#cb118-237"></a><span class="in">```{r}</span></span>
<span id="cb118-238"><a href="#cb118-238"></a><span class="co">#1</span></span>
<span id="cb118-239"><a href="#cb118-239"></a></span>
<span id="cb118-240"><a href="#cb118-240"></a>diamonds <span class="sc">|&gt;</span> </span>
<span id="cb118-241"><a href="#cb118-241"></a>  <span class="fu">filter</span>(price <span class="sc">&lt;</span> <span class="dv">400</span> <span class="sc">|</span> price <span class="sc">&gt;</span> <span class="dv">10000</span>)</span>
<span id="cb118-242"><a href="#cb118-242"></a></span>
<span id="cb118-243"><a href="#cb118-243"></a><span class="co">#2</span></span>
<span id="cb118-244"><a href="#cb118-244"></a></span>
<span id="cb118-245"><a href="#cb118-245"></a>diamonds <span class="sc">|&gt;</span> </span>
<span id="cb118-246"><a href="#cb118-246"></a>  <span class="fu">filter</span>(price <span class="sc">&gt;=</span> <span class="dv">500</span> <span class="sc">&amp;</span> price <span class="sc">&lt;=</span> <span class="dv">600</span>)</span>
<span id="cb118-247"><a href="#cb118-247"></a></span>
<span id="cb118-248"><a href="#cb118-248"></a><span class="co">#3</span></span>
<span id="cb118-249"><a href="#cb118-249"></a></span>
<span id="cb118-250"><a href="#cb118-250"></a>diamonds <span class="sc">|&gt;</span> </span>
<span id="cb118-251"><a href="#cb118-251"></a>  <span class="fu">mutate</span>(<span class="at">is_fpi =</span> cut <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Fair"</span>, <span class="st">"Premium"</span>, <span class="st">"Ideal"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb118-252"><a href="#cb118-252"></a>  <span class="fu">summarize</span>(<span class="fu">sum</span>(is_fpi <span class="sc">==</span> <span class="cn">TRUE</span>))</span>
<span id="cb118-253"><a href="#cb118-253"></a></span>
<span id="cb118-254"><a href="#cb118-254"></a>diamonds <span class="sc">|&gt;</span> </span>
<span id="cb118-255"><a href="#cb118-255"></a>  <span class="fu">mutate</span>(<span class="at">is_fpi =</span> cut <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Fair"</span>, <span class="st">"Premium"</span>, <span class="st">"Ideal"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb118-256"><a href="#cb118-256"></a>  <span class="fu">summarize</span>(<span class="fu">mean</span>(is_fpi <span class="sc">==</span> <span class="cn">TRUE</span>))</span>
<span id="cb118-257"><a href="#cb118-257"></a> </span>
<span id="cb118-258"><a href="#cb118-258"></a><span class="co">#4</span></span>
<span id="cb118-259"><a href="#cb118-259"></a></span>
<span id="cb118-260"><a href="#cb118-260"></a>diamonds <span class="sc">|&gt;</span> </span>
<span id="cb118-261"><a href="#cb118-261"></a>  <span class="fu">filter</span>(cut <span class="sc">==</span> <span class="st">"Fair"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb118-262"><a href="#cb118-262"></a>  <span class="fu">summarize</span>(<span class="fu">any</span>(price <span class="sc">&gt;</span> <span class="dv">3000</span>))</span>
<span id="cb118-263"><a href="#cb118-263"></a></span>
<span id="cb118-264"><a href="#cb118-264"></a>diamonds <span class="sc">|&gt;</span> </span>
<span id="cb118-265"><a href="#cb118-265"></a>  <span class="fu">filter</span>(cut <span class="sc">==</span> <span class="st">"Ideal"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb118-266"><a href="#cb118-266"></a>  <span class="fu">summarize</span>(<span class="fu">all</span>(price <span class="sc">&gt;</span><span class="dv">2000</span>))</span>
<span id="cb118-267"><a href="#cb118-267"></a></span>
<span id="cb118-268"><a href="#cb118-268"></a><span class="co">#5</span></span>
<span id="cb118-269"><a href="#cb118-269"></a></span>
<span id="cb118-270"><a href="#cb118-270"></a>diamonds <span class="sc">|&gt;</span> </span>
<span id="cb118-271"><a href="#cb118-271"></a>  <span class="fu">mutate</span>(<span class="at">price_cat1 =</span> <span class="fu">if_else</span>(price <span class="sc">&lt;</span> <span class="dv">500</span>, <span class="st">"low"</span>, <span class="st">"high"</span>), </span>
<span id="cb118-272"><a href="#cb118-272"></a>         <span class="at">price_cat2 =</span> <span class="fu">case_when</span>(price <span class="sc">&lt;</span> <span class="dv">500</span> <span class="sc">~</span> <span class="st">"low"</span>,</span>
<span id="cb118-273"><a href="#cb118-273"></a>                                price <span class="sc">&gt;=</span> <span class="dv">500</span> <span class="sc">&amp;</span> price <span class="sc">&lt;=</span> <span class="dv">1000</span> <span class="sc">~</span> <span class="st">"med"</span>,</span>
<span id="cb118-274"><a href="#cb118-274"></a>                                price <span class="sc">&gt;</span> <span class="dv">1000</span> <span class="sc">~</span> <span class="st">"high"</span>))</span>
<span id="cb118-275"><a href="#cb118-275"></a></span>
<span id="cb118-276"><a href="#cb118-276"></a><span class="in">```</span></span>
<span id="cb118-277"><a href="#cb118-277"></a></span>
<span id="cb118-278"><a href="#cb118-278"></a></span>
<span id="cb118-279"><a href="#cb118-279"></a><span class="fu">## Numerics </span></span>
<span id="cb118-280"><a href="#cb118-280"></a></span>
<span id="cb118-281"><a href="#cb118-281"></a><span class="fu">### Notes </span></span>
<span id="cb118-282"><a href="#cb118-282"></a></span>
<span id="cb118-283"><a href="#cb118-283"></a>Numerical data can be of class <span class="in">`integer`</span> or <span class="in">`numeric`</span> (representing real numbers).</span>
<span id="cb118-284"><a href="#cb118-284"></a></span>
<span id="cb118-285"><a href="#cb118-285"></a><span class="in">```{r numerical_classes}</span></span>
<span id="cb118-286"><a href="#cb118-286"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb118-287"><a href="#cb118-287"></a>x</span>
<span id="cb118-288"><a href="#cb118-288"></a><span class="fu">class</span>(x)</span>
<span id="cb118-289"><a href="#cb118-289"></a></span>
<span id="cb118-290"><a href="#cb118-290"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="fl">+1e-9</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb118-291"><a href="#cb118-291"></a>x</span>
<span id="cb118-292"><a href="#cb118-292"></a><span class="fu">class</span>(x)</span>
<span id="cb118-293"><a href="#cb118-293"></a><span class="in">```</span></span>
<span id="cb118-294"><a href="#cb118-294"></a></span>
<span id="cb118-295"><a href="#cb118-295"></a></span>
<span id="cb118-296"><a href="#cb118-296"></a>The <span class="co">[</span><span class="ot">Numbers</span><span class="co">](https://r4ds.hadley.nz/numbers)</span> chapter in R4DS covers the following functions that are all useful for wrangling numeric data:</span>
<span id="cb118-297"><a href="#cb118-297"></a></span>
<span id="cb118-298"><a href="#cb118-298"></a><span class="ss">- </span><span class="in">`n()`</span>, <span class="in">`n_distinct()`</span>: Counting and counting the number of unique values</span>
<span id="cb118-299"><a href="#cb118-299"></a><span class="ss">- </span><span class="in">`sum(is.na())`</span>: Counting the number of missing values</span>
<span id="cb118-300"><a href="#cb118-300"></a><span class="ss">- </span><span class="in">`min()`</span>, <span class="in">`max()`</span></span>
<span id="cb118-301"><a href="#cb118-301"></a><span class="ss">- </span><span class="in">`pmin()`</span>, <span class="in">`pmax()`</span>: Get the min and max across several vectors</span>
<span id="cb118-302"><a href="#cb118-302"></a><span class="ss">- </span>Integer division: <span class="in">`%/%`</span>. Remainder: <span class="in">`%%`</span></span>
<span id="cb118-303"><a href="#cb118-303"></a><span class="ss">    - </span><span class="in">`121 %/% 100 = 1`</span> and <span class="in">`121 %% 100 = 21`</span></span>
<span id="cb118-304"><a href="#cb118-304"></a><span class="ss">- </span><span class="in">`round()`</span>, <span class="in">`floor()`</span>, <span class="in">`ceiling()`</span>: Rounding functions (to a specified number of decimal places, to the largest integer below a number, to the smallest integer above a number)</span>
<span id="cb118-305"><a href="#cb118-305"></a><span class="ss">- </span><span class="in">`cut()`</span>: Cut a numerical vector into categories</span>
<span id="cb118-306"><a href="#cb118-306"></a><span class="ss">- </span><span class="in">`cumsum()`</span>, <span class="in">`cummean()`</span>, <span class="in">`cummin()`</span>, <span class="in">`cummax()`</span>: Cumulative functions</span>
<span id="cb118-307"><a href="#cb118-307"></a><span class="ss">- </span><span class="in">`rank()`</span>: Provide the ranks of the numbers in a vector</span>
<span id="cb118-308"><a href="#cb118-308"></a><span class="ss">- </span><span class="in">`lead(), lag()`</span>: shift a vector by padding with NAs</span>
<span id="cb118-309"><a href="#cb118-309"></a><span class="ss">- </span>Numerical summaries: <span class="in">`mean`</span>, <span class="in">`median`</span>, <span class="in">`min`</span>, <span class="in">`max`</span>, <span class="in">`quantile`</span>, <span class="in">`sd`</span>, <span class="in">`IQR`</span></span>
<span id="cb118-310"><a href="#cb118-310"></a><span class="ss">    - </span>Note that all numerical summary functions have an <span class="in">`na.rm`</span> argument that should be set to <span class="in">`TRUE`</span> if you have missing data.</span>
<span id="cb118-311"><a href="#cb118-311"></a></span>
<span id="cb118-312"><a href="#cb118-312"></a></span>
<span id="cb118-313"><a href="#cb118-313"></a></span>
<span id="cb118-314"><a href="#cb118-314"></a></span>
<span id="cb118-315"><a href="#cb118-315"></a></span>
<span id="cb118-316"><a href="#cb118-316"></a><span class="fu">### Exercises </span></span>
<span id="cb118-317"><a href="#cb118-317"></a></span>
<span id="cb118-318"><a href="#cb118-318"></a>Exercises will be on HW4. </span>
<span id="cb118-319"><a href="#cb118-319"></a></span>
<span id="cb118-320"><a href="#cb118-320"></a>The best way to add these functions and operators to your vocabulary is to need to recall them. Refer to the list of functions above as you try the exercises. </span>
<span id="cb118-321"><a href="#cb118-321"></a></span>
<span id="cb118-322"><a href="#cb118-322"></a>You will need to reference function documentation to look at arguments and look in the Examples section.</span>
<span id="cb118-323"><a href="#cb118-323"></a></span>
<span id="cb118-324"><a href="#cb118-324"></a><span class="fu">## Dates  </span></span>
<span id="cb118-325"><a href="#cb118-325"></a></span>
<span id="cb118-326"><a href="#cb118-326"></a></span>
<span id="cb118-327"><a href="#cb118-327"></a><span class="fu">### Notes </span></span>
<span id="cb118-328"><a href="#cb118-328"></a></span>
<span id="cb118-329"><a href="#cb118-329"></a>The <span class="in">`lubridate`</span> package contains useful functions for working with dates and times. The <span class="in">`lubridate`</span> <span class="co">[</span><span class="ot">function reference</span><span class="co">](https://lubridate.tidyverse.org/reference/index.html)</span> is a useful resource for finding the functions you need. We'll take a brief tour of this reference page.</span>
<span id="cb118-330"><a href="#cb118-330"></a></span>
<span id="cb118-331"><a href="#cb118-331"></a></span>
<span id="cb118-332"><a href="#cb118-332"></a>We'll use the <span class="in">`lakers`</span> dataset in the <span class="in">`lubridate`</span> package to illustrate some examples.</span>
<span id="cb118-333"><a href="#cb118-333"></a></span>
<span id="cb118-334"><a href="#cb118-334"></a><span class="in">```{r load_lakers}</span></span>
<span id="cb118-335"><a href="#cb118-335"></a>lakers <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(lakers)</span>
<span id="cb118-336"><a href="#cb118-336"></a><span class="fu">head</span>(lakers)</span>
<span id="cb118-337"><a href="#cb118-337"></a><span class="in">```</span></span>
<span id="cb118-338"><a href="#cb118-338"></a></span>
<span id="cb118-339"><a href="#cb118-339"></a></span>
<span id="cb118-340"><a href="#cb118-340"></a>Below we use date-time <span class="co">[</span><span class="ot">parsing functions</span><span class="co">](https://lubridate.tidyverse.org/reference/index.html#date-time-parsing)</span> to represent the <span class="in">`date`</span> and <span class="in">`time`</span> variables with date-time classes:</span>
<span id="cb118-341"><a href="#cb118-341"></a></span>
<span id="cb118-342"><a href="#cb118-342"></a><span class="in">```{r parse_date_time}</span></span>
<span id="cb118-343"><a href="#cb118-343"></a>lakers <span class="ot">&lt;-</span> lakers <span class="sc">|&gt;</span></span>
<span id="cb118-344"><a href="#cb118-344"></a>    <span class="fu">mutate</span>(</span>
<span id="cb118-345"><a href="#cb118-345"></a>        <span class="at">date =</span> <span class="fu">ymd</span>(date),</span>
<span id="cb118-346"><a href="#cb118-346"></a>        <span class="at">time =</span> <span class="fu">ms</span>(time)</span>
<span id="cb118-347"><a href="#cb118-347"></a>    )</span>
<span id="cb118-348"><a href="#cb118-348"></a><span class="in">```</span></span>
<span id="cb118-349"><a href="#cb118-349"></a></span>
<span id="cb118-350"><a href="#cb118-350"></a></span>
<span id="cb118-351"><a href="#cb118-351"></a>Below we use <span class="co">[</span><span class="ot">extraction functions</span><span class="co">](https://lubridate.tidyverse.org/reference/index.html#setting-getting-and-rounding)</span> to get components of the date-time objects:</span>
<span id="cb118-352"><a href="#cb118-352"></a></span>
<span id="cb118-353"><a href="#cb118-353"></a><span class="in">```{r lakers_extract}</span></span>
<span id="cb118-354"><a href="#cb118-354"></a>lakers_clean <span class="ot">&lt;-</span> lakers <span class="sc">|&gt;</span></span>
<span id="cb118-355"><a href="#cb118-355"></a>    <span class="fu">mutate</span>(</span>
<span id="cb118-356"><a href="#cb118-356"></a>        <span class="at">year =</span> <span class="fu">year</span>(date),</span>
<span id="cb118-357"><a href="#cb118-357"></a>        <span class="at">month =</span> <span class="fu">month</span>(date),</span>
<span id="cb118-358"><a href="#cb118-358"></a>        <span class="at">day =</span> <span class="fu">day</span>(date),</span>
<span id="cb118-359"><a href="#cb118-359"></a>        <span class="at">day_of_week =</span> <span class="fu">wday</span>(date, <span class="at">label =</span> <span class="cn">TRUE</span>),</span>
<span id="cb118-360"><a href="#cb118-360"></a>        <span class="at">minute =</span> <span class="fu">minute</span>(time),</span>
<span id="cb118-361"><a href="#cb118-361"></a>        <span class="at">second =</span> <span class="fu">second</span>(time)</span>
<span id="cb118-362"><a href="#cb118-362"></a>    )</span>
<span id="cb118-363"><a href="#cb118-363"></a>lakers_clean <span class="sc">|&gt;</span> <span class="fu">select</span>(year<span class="sc">:</span>second)</span>
<span id="cb118-364"><a href="#cb118-364"></a></span>
<span id="cb118-365"><a href="#cb118-365"></a>lakers_clean <span class="ot">&lt;-</span> lakers_clean <span class="sc">|&gt;</span></span>
<span id="cb118-366"><a href="#cb118-366"></a>    <span class="fu">group_by</span>(date, opponent, period) <span class="sc">|&gt;</span></span>
<span id="cb118-367"><a href="#cb118-367"></a>    <span class="fu">arrange</span>(date, opponent, period, <span class="fu">desc</span>(time)) <span class="sc">|&gt;</span></span>
<span id="cb118-368"><a href="#cb118-368"></a>    <span class="fu">mutate</span>(</span>
<span id="cb118-369"><a href="#cb118-369"></a>        <span class="at">diff_btw_plays_sec =</span> <span class="fu">as.numeric</span>(time <span class="sc">-</span> <span class="fu">lag</span>(time, <span class="dv">1</span>))</span>
<span id="cb118-370"><a href="#cb118-370"></a>    )</span>
<span id="cb118-371"><a href="#cb118-371"></a>lakers_clean <span class="sc">|&gt;</span> <span class="fu">select</span>(date, opponent, time, period, diff_btw_plays_sec)</span>
<span id="cb118-372"><a href="#cb118-372"></a><span class="in">```</span></span>
<span id="cb118-373"><a href="#cb118-373"></a></span>
<span id="cb118-374"><a href="#cb118-374"></a><span class="fu">### Exercises  </span></span>
<span id="cb118-375"><a href="#cb118-375"></a></span>
<span id="cb118-376"><a href="#cb118-376"></a>Exercises will be on HW4. </span>
<span id="cb118-377"><a href="#cb118-377"></a></span>
<span id="cb118-378"><a href="#cb118-378"></a></span>
<span id="cb118-379"><a href="#cb118-379"></a><span class="fu">## Factors </span></span>
<span id="cb118-380"><a href="#cb118-380"></a></span>
<span id="cb118-381"><a href="#cb118-381"></a><span class="fu">### Notes </span></span>
<span id="cb118-382"><a href="#cb118-382"></a></span>
<span id="cb118-383"><a href="#cb118-383"></a>**Creating factors**</span>
<span id="cb118-384"><a href="#cb118-384"></a></span>
<span id="cb118-385"><a href="#cb118-385"></a>In R, factors are made up of two components: the **actual values** of the data and the possible **levels** within the factor. Creating a factor requires supplying both pieces of information.</span>
<span id="cb118-386"><a href="#cb118-386"></a></span>
<span id="cb118-387"><a href="#cb118-387"></a><span class="in">```{r months_char_vec}</span></span>
<span id="cb118-388"><a href="#cb118-388"></a>months <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Mar"</span>, <span class="st">"Dec"</span>, <span class="st">"Jan"</span>,  <span class="st">"Apr"</span>, <span class="st">"Jul"</span>)</span>
<span id="cb118-389"><a href="#cb118-389"></a><span class="in">```</span></span>
<span id="cb118-390"><a href="#cb118-390"></a></span>
<span id="cb118-391"><a href="#cb118-391"></a></span>
<span id="cb118-392"><a href="#cb118-392"></a>However, if we were to sort this vector, R would sort this vector alphabetically.</span>
<span id="cb118-393"><a href="#cb118-393"></a></span>
<span id="cb118-394"><a href="#cb118-394"></a><span class="in">```{r sort_months_abs}</span></span>
<span id="cb118-395"><a href="#cb118-395"></a><span class="co"># alphabetical sort</span></span>
<span id="cb118-396"><a href="#cb118-396"></a><span class="fu">sort</span>(months)</span>
<span id="cb118-397"><a href="#cb118-397"></a><span class="in">```</span></span>
<span id="cb118-398"><a href="#cb118-398"></a></span>
<span id="cb118-399"><a href="#cb118-399"></a></span>
<span id="cb118-400"><a href="#cb118-400"></a>We can fix this sorting by creating a factor version of <span class="in">`months`</span>. The <span class="in">`levels`</span> argument is a character vector that specifies the unique values that the factor can take. The order of the values in <span class="in">`levels`</span> defines the sorting of the factor.</span>
<span id="cb118-401"><a href="#cb118-401"></a></span>
<span id="cb118-402"><a href="#cb118-402"></a><span class="in">```{r create_months_fct}</span></span>
<span id="cb118-403"><a href="#cb118-403"></a>months_fct <span class="ot">&lt;-</span> <span class="fu">factor</span>(months, <span class="at">levels =</span> month.abb) <span class="co"># month.abb is a built-in variable</span></span>
<span id="cb118-404"><a href="#cb118-404"></a>months_fct</span>
<span id="cb118-405"><a href="#cb118-405"></a><span class="fu">sort</span>(months_fct)</span>
<span id="cb118-406"><a href="#cb118-406"></a><span class="in">```</span></span>
<span id="cb118-407"><a href="#cb118-407"></a></span>
<span id="cb118-408"><a href="#cb118-408"></a></span>
<span id="cb118-409"><a href="#cb118-409"></a>What if we try to create a factor with values that aren't in the levels? (e.g., a typo in a month name)</span>
<span id="cb118-410"><a href="#cb118-410"></a></span>
<span id="cb118-411"><a href="#cb118-411"></a><span class="in">```{r months_typo}</span></span>
<span id="cb118-412"><a href="#cb118-412"></a>months2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Jna"</span>, <span class="st">"Mar"</span>)</span>
<span id="cb118-413"><a href="#cb118-413"></a><span class="fu">factor</span>(months2, <span class="at">levels =</span> month.abb)</span>
<span id="cb118-414"><a href="#cb118-414"></a><span class="in">```</span></span>
<span id="cb118-415"><a href="#cb118-415"></a></span>
<span id="cb118-416"><a href="#cb118-416"></a></span>
<span id="cb118-417"><a href="#cb118-417"></a>Because the <span class="in">`NA`</span> is introduced silently (without any error or warnings), this can be dangerous. It might be better to use the <span class="in">`fct()`</span> function in the <span class="in">`forcats`</span> package instead:</span>
<span id="cb118-418"><a href="#cb118-418"></a></span>
<span id="cb118-419"><a href="#cb118-419"></a><span class="in">```{r fct_forcats}</span></span>
<span id="cb118-420"><a href="#cb118-420"></a><span class="co">#| error: true</span></span>
<span id="cb118-421"><a href="#cb118-421"></a></span>
<span id="cb118-422"><a href="#cb118-422"></a><span class="fu">fct</span>(months2, <span class="at">levels =</span> month.abb)</span>
<span id="cb118-423"><a href="#cb118-423"></a><span class="in">```</span></span>
<span id="cb118-424"><a href="#cb118-424"></a></span>
<span id="cb118-425"><a href="#cb118-425"></a></span>
<span id="cb118-426"><a href="#cb118-426"></a></span>
<span id="cb118-427"><a href="#cb118-427"></a>**Reordering factors**</span>
<span id="cb118-428"><a href="#cb118-428"></a></span>
<span id="cb118-429"><a href="#cb118-429"></a></span>
<span id="cb118-430"><a href="#cb118-430"></a>We'll use a subset of the General Social Survey (GSS) dataset available in the <span class="in">`forcats`</span> pacakges.</span>
<span id="cb118-431"><a href="#cb118-431"></a></span>
<span id="cb118-432"><a href="#cb118-432"></a><span class="in">```{r load_gss}</span></span>
<span id="cb118-433"><a href="#cb118-433"></a><span class="fu">data</span>(gss_cat)</span>
<span id="cb118-434"><a href="#cb118-434"></a><span class="fu">head</span>(gss_cat)</span>
<span id="cb118-435"><a href="#cb118-435"></a><span class="in">```</span></span>
<span id="cb118-436"><a href="#cb118-436"></a></span>
<span id="cb118-437"><a href="#cb118-437"></a></span>
<span id="cb118-438"><a href="#cb118-438"></a>Reordering the levels of a factor can be useful in plotting when categories would benefit from being sorted in a particular way:</span>
<span id="cb118-439"><a href="#cb118-439"></a></span>
<span id="cb118-440"><a href="#cb118-440"></a><span class="in">```{r reorder_factors_motivation}</span></span>
<span id="cb118-441"><a href="#cb118-441"></a>relig_summary <span class="ot">&lt;-</span> gss_cat <span class="sc">|&gt;</span></span>
<span id="cb118-442"><a href="#cb118-442"></a>    <span class="fu">group_by</span>(relig) <span class="sc">|&gt;</span></span>
<span id="cb118-443"><a href="#cb118-443"></a>    <span class="fu">summarize</span>(</span>
<span id="cb118-444"><a href="#cb118-444"></a>        <span class="at">tvhours =</span> <span class="fu">mean</span>(tvhours, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb118-445"><a href="#cb118-445"></a>        <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb118-446"><a href="#cb118-446"></a>    )</span>
<span id="cb118-447"><a href="#cb118-447"></a></span>
<span id="cb118-448"><a href="#cb118-448"></a><span class="fu">ggplot</span>(relig_summary, <span class="fu">aes</span>(<span class="at">x =</span> tvhours, <span class="at">y =</span> relig)) <span class="sc">+</span> </span>
<span id="cb118-449"><a href="#cb118-449"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb118-450"><a href="#cb118-450"></a>    <span class="fu">theme_classic</span>()</span>
<span id="cb118-451"><a href="#cb118-451"></a><span class="in">```</span></span>
<span id="cb118-452"><a href="#cb118-452"></a></span>
<span id="cb118-453"><a href="#cb118-453"></a></span>
<span id="cb118-454"><a href="#cb118-454"></a>We can use <span class="in">`fct_reorder()`</span> in <span class="in">`forcats`</span>.</span>
<span id="cb118-455"><a href="#cb118-455"></a></span>
<span id="cb118-456"><a href="#cb118-456"></a><span class="ss">- </span>The first argument is the factor that you want to reorder the levels of</span>
<span id="cb118-457"><a href="#cb118-457"></a><span class="ss">- </span>The second argument determines how the factor is sorted (analogous to what you put inside <span class="in">`arrange()`</span> when sorting the rows of a data frame.)</span>
<span id="cb118-458"><a href="#cb118-458"></a></span>
<span id="cb118-459"><a href="#cb118-459"></a><span class="in">```{r fct_reorder}</span></span>
<span id="cb118-460"><a href="#cb118-460"></a><span class="fu">ggplot</span>(relig_summary, <span class="fu">aes</span>(<span class="at">x =</span> tvhours, <span class="at">y =</span> <span class="fu">fct_reorder</span>(relig, tvhours))) <span class="sc">+</span></span>
<span id="cb118-461"><a href="#cb118-461"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb118-462"><a href="#cb118-462"></a>    <span class="fu">theme_classic</span>()</span>
<span id="cb118-463"><a href="#cb118-463"></a><span class="in">```</span></span>
<span id="cb118-464"><a href="#cb118-464"></a></span>
<span id="cb118-465"><a href="#cb118-465"></a></span>
<span id="cb118-466"><a href="#cb118-466"></a>For bar plots, we can use <span class="in">`fct_infreq()`</span> to reorder levels from most to least common. This can be combined with <span class="in">`fct_rev()`</span> to reverse the order (least to most common):</span>
<span id="cb118-467"><a href="#cb118-467"></a></span>
<span id="cb118-468"><a href="#cb118-468"></a><span class="in">```{r fct_infreq_rev}</span></span>
<span id="cb118-469"><a href="#cb118-469"></a>gss_cat <span class="sc">|&gt;</span></span>
<span id="cb118-470"><a href="#cb118-470"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> marital)) <span class="sc">+</span></span>
<span id="cb118-471"><a href="#cb118-471"></a>    <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb118-472"><a href="#cb118-472"></a>    <span class="fu">theme_classic</span>()</span>
<span id="cb118-473"><a href="#cb118-473"></a></span>
<span id="cb118-474"><a href="#cb118-474"></a>gss_cat <span class="sc">|&gt;</span></span>
<span id="cb118-475"><a href="#cb118-475"></a>    <span class="fu">mutate</span>(<span class="at">marital =</span> marital <span class="sc">|&gt;</span> <span class="fu">fct_infreq</span>() <span class="sc">|&gt;</span> <span class="fu">fct_rev</span>()) <span class="sc">|&gt;</span></span>
<span id="cb118-476"><a href="#cb118-476"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> marital)) <span class="sc">+</span></span>
<span id="cb118-477"><a href="#cb118-477"></a>    <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb118-478"><a href="#cb118-478"></a>    <span class="fu">theme_classic</span>()</span>
<span id="cb118-479"><a href="#cb118-479"></a><span class="in">```</span></span>
<span id="cb118-480"><a href="#cb118-480"></a></span>
<span id="cb118-481"><a href="#cb118-481"></a></span>
<span id="cb118-482"><a href="#cb118-482"></a>**Modifying factor levels**</span>
<span id="cb118-483"><a href="#cb118-483"></a></span>
<span id="cb118-484"><a href="#cb118-484"></a>We talked about reordering the levels of a factor--what about changing the values of the levels themselves?</span>
<span id="cb118-485"><a href="#cb118-485"></a></span>
<span id="cb118-486"><a href="#cb118-486"></a>For example, the names of the political parties in the GSS could use elaboration ("str" isn't a great label for "strong") and clean up:</span>
<span id="cb118-487"><a href="#cb118-487"></a></span>
<span id="cb118-488"><a href="#cb118-488"></a><span class="in">```{r gss_messy_party}</span></span>
<span id="cb118-489"><a href="#cb118-489"></a>gss_cat <span class="sc">|&gt;</span> <span class="fu">count</span>(partyid)</span>
<span id="cb118-490"><a href="#cb118-490"></a><span class="in">```</span></span>
<span id="cb118-491"><a href="#cb118-491"></a></span>
<span id="cb118-492"><a href="#cb118-492"></a></span>
<span id="cb118-493"><a href="#cb118-493"></a>We can use <span class="in">`fct_recode()`</span> on <span class="in">`partyid`</span> with the new level names going on the left and the old levels on the right. Any levels that aren't mentioned explicitly (i.e., "Don't know" and "Other party") will be left as is:</span>
<span id="cb118-494"><a href="#cb118-494"></a></span>
<span id="cb118-495"><a href="#cb118-495"></a><span class="in">```{r fct_recode}</span></span>
<span id="cb118-496"><a href="#cb118-496"></a>gss_cat <span class="sc">|&gt;</span></span>
<span id="cb118-497"><a href="#cb118-497"></a>    <span class="fu">mutate</span>(</span>
<span id="cb118-498"><a href="#cb118-498"></a>        <span class="at">partyid =</span> <span class="fu">fct_recode</span>(partyid,</span>
<span id="cb118-499"><a href="#cb118-499"></a>            <span class="st">"Republican, strong"</span>    <span class="ot">=</span> <span class="st">"Strong republican"</span>,</span>
<span id="cb118-500"><a href="#cb118-500"></a>            <span class="st">"Republican, weak"</span>      <span class="ot">=</span> <span class="st">"Not str republican"</span>,</span>
<span id="cb118-501"><a href="#cb118-501"></a>            <span class="st">"Independent, near rep"</span> <span class="ot">=</span> <span class="st">"Ind,near rep"</span>,</span>
<span id="cb118-502"><a href="#cb118-502"></a>            <span class="st">"Independent, near dem"</span> <span class="ot">=</span> <span class="st">"Ind,near dem"</span>,</span>
<span id="cb118-503"><a href="#cb118-503"></a>            <span class="st">"Democrat, weak"</span>        <span class="ot">=</span> <span class="st">"Not str democrat"</span>,</span>
<span id="cb118-504"><a href="#cb118-504"></a>            <span class="st">"Democrat, strong"</span>      <span class="ot">=</span> <span class="st">"Strong democrat"</span></span>
<span id="cb118-505"><a href="#cb118-505"></a>        )</span>
<span id="cb118-506"><a href="#cb118-506"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb118-507"><a href="#cb118-507"></a>    <span class="fu">count</span>(partyid)</span>
<span id="cb118-508"><a href="#cb118-508"></a><span class="in">```</span></span>
<span id="cb118-509"><a href="#cb118-509"></a></span>
<span id="cb118-510"><a href="#cb118-510"></a></span>
<span id="cb118-511"><a href="#cb118-511"></a>To combine groups, we can assign multiple old levels to the same new level ("Other" maps to "No answer", "Don't know", and "Other party"):</span>
<span id="cb118-512"><a href="#cb118-512"></a></span>
<span id="cb118-513"><a href="#cb118-513"></a><span class="in">```{r fct_recode2}</span></span>
<span id="cb118-514"><a href="#cb118-514"></a>gss_cat <span class="sc">|&gt;</span></span>
<span id="cb118-515"><a href="#cb118-515"></a>    <span class="fu">mutate</span>(</span>
<span id="cb118-516"><a href="#cb118-516"></a>        <span class="at">partyid =</span> <span class="fu">fct_recode</span>(partyid,</span>
<span id="cb118-517"><a href="#cb118-517"></a>            <span class="st">"Republican, strong"</span>    <span class="ot">=</span> <span class="st">"Strong republican"</span>,</span>
<span id="cb118-518"><a href="#cb118-518"></a>            <span class="st">"Republican, weak"</span>      <span class="ot">=</span> <span class="st">"Not str republican"</span>,</span>
<span id="cb118-519"><a href="#cb118-519"></a>            <span class="st">"Independent, near rep"</span> <span class="ot">=</span> <span class="st">"Ind,near rep"</span>,</span>
<span id="cb118-520"><a href="#cb118-520"></a>            <span class="st">"Independent, near dem"</span> <span class="ot">=</span> <span class="st">"Ind,near dem"</span>,</span>
<span id="cb118-521"><a href="#cb118-521"></a>            <span class="st">"Democrat, weak"</span>        <span class="ot">=</span> <span class="st">"Not str democrat"</span>,</span>
<span id="cb118-522"><a href="#cb118-522"></a>            <span class="st">"Democrat, strong"</span>      <span class="ot">=</span> <span class="st">"Strong democrat"</span>,</span>
<span id="cb118-523"><a href="#cb118-523"></a>            <span class="st">"Other"</span>                 <span class="ot">=</span> <span class="st">"No answer"</span>,</span>
<span id="cb118-524"><a href="#cb118-524"></a>            <span class="st">"Other"</span>                 <span class="ot">=</span> <span class="st">"Don't know"</span>,</span>
<span id="cb118-525"><a href="#cb118-525"></a>            <span class="st">"Other"</span>                 <span class="ot">=</span> <span class="st">"Other party"</span></span>
<span id="cb118-526"><a href="#cb118-526"></a>        )</span>
<span id="cb118-527"><a href="#cb118-527"></a>    )</span>
<span id="cb118-528"><a href="#cb118-528"></a><span class="in">```</span></span>
<span id="cb118-529"><a href="#cb118-529"></a></span>
<span id="cb118-530"><a href="#cb118-530"></a></span>
<span id="cb118-531"><a href="#cb118-531"></a>We can use <span class="in">`fct_collapse()`</span> to collapse many levels:</span>
<span id="cb118-532"><a href="#cb118-532"></a></span>
<span id="cb118-533"><a href="#cb118-533"></a><span class="in">```{r fct_collapse}</span></span>
<span id="cb118-534"><a href="#cb118-534"></a>gss_cat <span class="sc">|&gt;</span></span>
<span id="cb118-535"><a href="#cb118-535"></a>    <span class="fu">mutate</span>(</span>
<span id="cb118-536"><a href="#cb118-536"></a>        <span class="at">partyid =</span> <span class="fu">fct_collapse</span>(partyid,</span>
<span id="cb118-537"><a href="#cb118-537"></a>            <span class="st">"Other"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"No answer"</span>, <span class="st">"Don't know"</span>, <span class="st">"Other party"</span>),</span>
<span id="cb118-538"><a href="#cb118-538"></a>            <span class="st">"Republican"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Strong republican"</span>, <span class="st">"Not str republican"</span>),</span>
<span id="cb118-539"><a href="#cb118-539"></a>            <span class="st">"Independent"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Ind,near rep"</span>, <span class="st">"Independent"</span>, <span class="st">"Ind,near dem"</span>),</span>
<span id="cb118-540"><a href="#cb118-540"></a>            <span class="st">"Democrat"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Not str democrat"</span>, <span class="st">"Strong democrat"</span>)</span>
<span id="cb118-541"><a href="#cb118-541"></a>        )</span>
<span id="cb118-542"><a href="#cb118-542"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb118-543"><a href="#cb118-543"></a>    <span class="fu">count</span>(partyid)</span>
<span id="cb118-544"><a href="#cb118-544"></a><span class="in">```</span></span>
<span id="cb118-545"><a href="#cb118-545"></a></span>
<span id="cb118-546"><a href="#cb118-546"></a></span>
<span id="cb118-547"><a href="#cb118-547"></a></span>
<span id="cb118-548"><a href="#cb118-548"></a><span class="fu">### Exercises </span></span>
<span id="cb118-549"><a href="#cb118-549"></a></span>
<span id="cb118-550"><a href="#cb118-550"></a></span>
<span id="cb118-551"><a href="#cb118-551"></a><span class="ss">1. </span>Create a factor version of the following data with the levels in a sensible order.</span>
<span id="cb118-552"><a href="#cb118-552"></a></span>
<span id="cb118-555"><a href="#cb118-555"></a><span class="in">```{r}</span></span>
<span id="cb118-556"><a href="#cb118-556"></a>ratings <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"High"</span>, <span class="st">"Medium"</span>, <span class="st">"Low"</span>)</span>
<span id="cb118-557"><a href="#cb118-557"></a><span class="in">```</span></span>
<span id="cb118-558"><a href="#cb118-558"></a></span>
<span id="cb118-559"><a href="#cb118-559"></a></span>
<span id="cb118-560"><a href="#cb118-560"></a>More exercises will be on HW4. </span>
<span id="cb118-561"><a href="#cb118-561"></a></span>
<span id="cb118-562"><a href="#cb118-562"></a><span class="fu">## Done!</span></span>
<span id="cb118-563"><a href="#cb118-563"></a></span>
<span id="cb118-564"><a href="#cb118-564"></a><span class="ss">- </span>Check the ICA Instructions for how to (a) push your code to GitHub and (b) update your portfolio website</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">

<div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>